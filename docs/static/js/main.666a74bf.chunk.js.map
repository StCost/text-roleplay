{"version":3,"sources":["components/Menu.tsx","helpers/dice.tsx","helpers/utils.tsx","reducers/interfaces.ts","reducers/index.ts","helpers/store.tsx","reducers/actions.ts","components/Avatar.tsx","components/Image.tsx","components/Item.tsx","components/ItemById.tsx","containers/Chat/MessageBody.tsx","containers/Chat/Message.tsx","containers/Chat/index.tsx","components/Loader/LoadIcon.tsx","components/Loader/CheckIcon.tsx","components/Loader/index.tsx","containers/Settings/index.tsx","components/Logout.tsx","containers/Items/ItemCreator.tsx","containers/ItemsTable/ItemsList.tsx","containers/ItemsTable/index.tsx","components/AmountModal.tsx","containers/Items/index.tsx","components/ActiveUsersList.tsx","containers/Inventory/index.tsx","containers/Character/config.ts","containers/Character/index.tsx","configs/routes.tsx","components/Help.tsx","components/Login.tsx","components/Router.tsx","helpers/activity.ts","App.tsx","helpers/firebase.tsx","sagas/auth.ts","sagas/users.ts","sagas/messages.ts","sagas/items.ts","sagas/inventory.ts","sagas/index.ts","serviceWorker.ts","index.tsx"],"names":["connect","state","isLoggedIn","withRouter","props","Fragment","mode","window","innerWidth","selectedKeys","location","pathname","split","pop","menu","map","value","Item","key","path","disabled","link","href","target","rel","to","label","diceRegex","diceRegexG","getRandomInt","min","max","Math","floor","random","exportRolls","str","rolls","match","roll","_amount","_size","amount","parseInt","size","results","Array","fill","rollDice","maxResult","minResult","sum","reduce","a","b","splice","colorFromString","hash","i","length","charCodeAt","color","toString","substr","isOnline","time","localStorage","getItem","Date","getTime","doubleDigit","getDate","date","getMonth","getFullYear","join","getFullTime","getHours","getMinutes","getSeconds","isURL","test","processMessages","messages","filter","item","pos","self","findIndex","_i","sort","m","index","author","grouped","formatMessage","message","body","indexOf","isRP","mentioned","validateMessage","notify","error","some","getFailedItem","id","discriminator","type","name","weight","effect","image","description","price","capacity","armor","approved","failed","Number","MAX_VALUE","getItemName","showAmount","defaultUser","lastOnline","nickname","avatar","isAdmin","uid","inventory","defaultItem","defaultDeletedItemData","itemId","deleted","messagesChecked","messagesCleared","usersChecked","usersCleared","done","user","JSON","parse","setItem","initialState","userData","settings","loading","users","currentUser","items","usersActivity","deletingItemData","reducer","action","concat","forEach","Object","values","undefined","redirect","field","sagaMiddleware","createSagaMiddleware","store","createStore","reducers","composeWithDevTools","applyMiddleware","dispatch","createAction","payload","createAsyncAction","typeName","toLowerCase","replace","toUpperCase","actions","deleteItemProgress","updateLastOnline","logout","Avatar","style","rest","_avatar","src","backgroundColor","Image","visible","toggleModal","setState","this","onClick","alt","className","title","CloseOutlined","closable","footer","onCancel","width","maxWidth","Component","getStats","labels","wearable","weapon","getFooter","removeItem","all","DeleteOutlined","render","stats","shape","find","itemProps","getItemById","MessageBody","data","taken","characterChanges","changes","formatChange","change","base","total","Boolean","Panel","header","full","before","after","readOnly","trim","onConfirm","takeItem","okText","cancelText","UploadOutlined","searchParams","URL","params","videoId","get","regExMatch","lastMatch","getVideoId","listId","height","frameBorder","allow","allowFullScreen","_body","_rolls","word","rollIndex","summing","importRolls","Message","placement","Chat","sending","componentDidMount","getMessages","subscribe","componentWillUnmount","unsubscribe","componentDidUpdate","prevProps","getUser","onChangeMessage","event","onKeyDown","shiftKey","preventDefault","onSendMessage","currentTarget","selectionStart","sendMessage","getMoreMessages","firstMessage","onScroll","scrollTop","uploadFile","file","onPaste","e","clipboardData","files","onDrop","dataTransfer","getAsFile","spinning","TextArea","placeholder","autoSize","minRows","maxRows","onChange","SendOutlined","viewBox","focusable","data-icon","aria-hidden","d","Loader","LoadIcon","CheckIcon","Settings","rawOnChange","newSettings","setSettings","setUser","clearAvatar","getField","hasRight","display","icon","ClearOutlined","danger","margin","checked","defaultValue","bordered","keys","React","URLSearchParams","Logout","ItemCreator","types","clearImage","fields","Option","precision","step","onSubmit","newItem","getValue","console","itemValue","content","onClose","centered","ItemsList","controls","controlButtons","condition","overlay","trigger","InsertRowBelowOutlined","ItemsTable","defaultState","searchString","showApproved","showNotApproved","filters","getFilters","getButton","tabIndex","Group","flexDirection","getPageControls","getHeader","getContent","getTitle","_searchString","AmountModal","inputProps","useState","setAmount","onInnerChange","dots","amountModal","modalProps","enough","Modal","confirm","onOk","close","maskClosable","Items","creatingItem","editingItem","itemsToLoad","getItems","toggleCreatingItem","allowClear","FilterOutlined","cardControls","giveItem","itemType","toggleEditingItem","log","deleteModal","onCreateItem","getCreators","deleteItem","getDeletingModal","getMoreItems","lastItem","ActiveUsersList","getUsersActivity","activeUsers","validUsers","Inventory","passItem","getPassModal","getInventoryItems","inventoryItems","loadedItems","notLoadedItems","inventoryItem","push","shift","demonstrate","use","initialCharacteristic","initialCharacter","special","strength","perception","endurance","charisma","intelligence","agility","luck","skills","smallGuns","bigGuns","energyGuns","unarmed","meleeWeapons","medicine","sneak","lockpick","steal","traps","science","repair","speech","barter","survival","level","hpPerLevel","exp","carryWeight","wounds","maxHealthPoints","healthPoints","armorClass","healingRate","resistance","actionPoints","sequence","meleeDamage","criticalChance","skillPoints","spentSkillPoints","bio","formula","getBase","s","ag","st","pe","en","in","ch","_","sqrt","subStats","ceil","lk","getConfigByField","findField","Character","getSpecial","configSpecial","getSkills","configSkills","configStats","MAX_SAFE_INTEGER","getMainStats","configSubStats","slice","char","processChar","specialTotal","getChanges","beforeChar","afterChar","diff","entries","characteristic","afterValue","config","onSave","character","success","initialValues","onValuesChange","extra","minLength","routes","component","exact","defaultActiveKey","TabPane","tab","onFinish","login","rules","required","Password","htmlType","register","resetPassword","Login","blinking","listenForActivity","callback","eventName","document","addEventListener","listenForOnline","buildDate","App","info","notifySuccess","redirectSuccess","getRedirect","firebase","_firebase","initializeApp","firebaseConfig","auth","languageCode","database","onAuthStateChanged","loginSuccess","watchForActions","email","password","signInWithEmailAndPassword","stringify","loginFail","passwordConfirm","registerFail","createUserWithEmailAndPassword","registerSuccess","sendPasswordResetEmail","resetPasswordSuccess","resetPasswordFail","signOut","takeLatest","ref","child","set","setUserSuccess","requestedUsers","on","rawUser","val","getUserSuccess","once","rawActivity","getUsersActivitySuccess","changeMessage","newMessage","sendMessageSuccess","sendMessageFail","orderByKey","limitToLast","rawMessages","getMessagesSuccess","interval","setInterval","head","querySelector","innerText","hidden","clearInterval","blinkTitle","off","endAt","request","XMLHttpRequest","formData","FormData","append","open","setRequestHeader","onreadystatechange","status","readyState","res","responseText","send","changeMessageSuccess","itemData","setItemSuccess","limitToFirst","rawItems","getItemsSuccess","rawItem","startAt","checkMessages","checkUsers","randomWait","getWait","setTimeout","clearedUsers","clearedMessages","waitCounter","deleteItemSuccess","takeEvery","getInventoryItem","passItemSuccess","passItemFail","sameItem","removeItemSuccess","removeItemFail","giveItemFail","fullId","giveItemSuccess","takeItemSuccess","takeItemFail","watchAll","hostname","run","saga","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.666a74bf.chunk.js","sourcesContent":["import React from 'react';\nimport { Menu as AntdMenu } from 'antd';\nimport { Link, withRouter, RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport '../styles/menu.scss';\nimport menu from '../configs/menu.json';\nimport { IState } from '../reducers/interfaces';\n\ninterface IMenuProps extends RouteComponentProps {\n  isLoggedIn: boolean;\n}\n\ninterface IMenuConfig {\n  label: string;\n  path: string;\n  link?: boolean;\n}\n\nfunction Menu(props: IMenuProps) {\n  if (!props.isLoggedIn) {\n    return <React.Fragment/>;\n  }\n\n  const mode = window.innerWidth < 767\n    ? 'horizontal'\n    : 'inline';\n\n  return (\n    <AntdMenu\n      mode={mode}\n      selectedKeys={[props.location.pathname.split('/').pop() || '']}\n    >\n      {menu.map((value: IMenuConfig) => (\n        <AntdMenu.Item\n          key={value.path.split('/').pop()}\n          disabled={value.path === props.location.pathname}\n        >\n          {\n            value.link\n              ? (\n\n                <a\n                  href={value.path}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  Помощь\n                </a>\n              ) : (\n                <Link to={value.path}>\n                  {value.label}\n                </Link>\n              )\n          }\n        </AntdMenu.Item>\n      ))}\n    </AntdMenu>\n  );\n}\n\nexport default connect((state: IState) => ({ isLoggedIn: state.isLoggedIn }))(withRouter(Menu));\n","import React from 'react';\nimport { Tooltip } from 'antd';\n\nexport interface IRoll {\n  roll: string;\n  results: number[];\n  amount: number;\n  size: number;\n  maxResult: number;\n  minResult: number;\n  sum: number;\n}\n\nexport const diceRegex = /([1-9]|10)[dд]((10|12|20)|[468])/miu;\nexport const diceRegexG = /([1-9]|10)[dд]((10|12|20)|[468])/miug;\n\nexport const getRandomInt = (min: number, max: number) =>\n  Math.floor(Math.random() * ((max + 1) - min) + min);\n\nexport const hasDice = (str: string) =>\n  /\\d+[dд]\\d+/imu.test(str);\n\nexport const rollDice = (amount: number, size: number) => {\n  return new Array(amount).fill(amount + size).map(() => getRandomInt(1, size));\n};\n\nexport const exportRolls = (str: string) => {\n  const rolls = str.match(diceRegexG);\n  if (rolls) {\n    return rolls.map((roll: string): IRoll => {\n      const [_amount, _size] = roll.split(/[dд]/);\n      const amount = parseInt(_amount);\n      const size = parseInt(_size);\n      const results = rollDice(amount, size);\n\n      return ({\n        maxResult: size * amount,\n        minResult: amount,\n        sum: results.reduce((a, b) => a + b, 0),\n        roll,\n        results,\n        amount,\n        size,\n      })\n    }).splice(0, 10);\n  }\n  return [];\n};\n\nexport const importRolls = (body: string, _rolls: IRoll[]) => {\n  const rolls = [..._rolls]; // Avoid mutations\n  return body.split(' ').map((word: string, index: number) => {\n    const rollIndex = rolls.findIndex(({ roll }) => roll === word);\n    if (rollIndex > -1) {\n      const {\n        results,\n        maxResult,\n        minResult,\n        sum\n      } = rolls.splice(rollIndex, 1)[0];\n\n      const summing = results.length > 1\n        ? `${sum} = ${results.join(' + ')}`\n        : `${results.join(' + ')}`;\n\n      const className = (sum === maxResult && 'critHit') || (sum === minResult && 'critMiss') || '';\n\n      return (\n        <React.Fragment key={word + index}>\n          {' '}\n          <Tooltip title={summing}>\n            <b className={className}>\n              {word}({sum})\n            </b>\n          </Tooltip>\n        </React.Fragment>\n      )\n    }\n    return ` ${word}`;\n  });\n};\n","import { message as notify } from 'antd';\n\nimport { IItem, IMessage } from '../reducers/interfaces';\nimport { diceRegex, exportRolls, hasDice } from './dice';\n\nexport const camelize = (str: string) => {\n  return str\n    .toLowerCase()\n    .replace(/_./g, (m) => m.toUpperCase())\n    .replace(/_/g, '')\n};\n\nexport const colorFromString = (str: string) => {\n  if (!str) return '#000';\n\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    let value = (hash >> (i * 8)) & 0xFF;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n\n  return color;\n};\n\nexport const isOnline = (time?: number) => {\n  if (!time) return false;\n  const lastActivity = time || parseInt(localStorage.getItem('lastActivity') || '0');\n  return (lastActivity + 180000) > new Date().getTime();\n};\n\nexport const doubleDigit = (str: number) => `${str}`.length === 1\n  ? `0${str}`\n  : str;\n\nexport const getTime = (time: number) => {\n  const date = new Date(time);\n  return [date.getHours(), date.getMinutes(), date.getSeconds()].map(doubleDigit).join(':');\n};\n\nexport const getDate = (time: number) => {\n  const date = new Date(time);\n  return [date.getDate(), date.getMonth() + 1, date.getFullYear()].map(doubleDigit).join('.');\n};\n\nexport const getFullTime = (time: number) => {\n  const date = new Date(time);\n  const messageTime = [date.getHours(), date.getMinutes(), date.getSeconds()].map(doubleDigit).join(':');\n  const messageDate = [date.getDate(), date.getMonth() + 1, date.getFullYear()].map(doubleDigit).join('.');\n\n  return [messageTime, messageDate].join(' ');\n};\n\nexport const isURL = (str: string) =>\n  /[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/igm.test(str);\n\nexport const processMessages = (messages: IMessage[]) => {\n  return messages\n    .filter((item: IMessage, pos: number, self: IMessage[]) =>\n      self.findIndex((_i: IMessage) => _i.time === item.time) === pos\n    )\n    .sort((a: IMessage, b: IMessage) => b.time - a.time)\n    .map((m: IMessage, index: number, messages: IMessage[]) => {\n      if (index < messages.length - 2) {\n        if (m.author === messages[index + 1].author) {\n          return {\n            ...m,\n            grouped: true,\n          }\n        }\n      }\n      return m;\n    })\n};\n\nexport const formatMessage = (message: IMessage) => {\n  const { body } = message;\n\n  if (diceRegex.test(body)) {\n    message.rolls = exportRolls(body);\n  }\n\n  if (body.indexOf('*') > -1) {\n    message.isRP = true;\n  }\n\n  if (/(@[a-zа-яё]*)/mui.test(body)) {\n    message.mentioned = true;\n  }\n\n  return message;\n};\n\nexport const validateMessage = (message: string) => {\n\n  if (!message) {\n    notify.error('Сообщение пустое');\n    return false;\n  }\n\n  if (hasDice(message)) {\n    const rolls: string[] | null = message.match(/(( |^)[a-zа-я]+\\d+[dд]\\d+)|(\\d+[dд]\\d+[a-zа-я]+( |$))|(\\d+[dд]\\d+)/miug);\n    if (rolls) {\n      const wasError = rolls.some((roll: string) => {\n        if (/(([a-zа-яё])\\d+[dд]\\d+)|(\\d+[dд]\\d+([a-zа-яё]))/miug.test(roll)) {\n          notify.error(`Ошибка в дайсе ${roll}. Рядом не должно быть символов`);\n          return true;\n        }\n\n        const [amount, size] = roll.split(/[dд]/u);\n\n        if (parseInt(amount) > 10) {\n          notify.error(`Ошибка в дайсе ${roll}. Нельзя бросать больше 10-ти дайсов`);\n          return true;\n        }\n\n        if ([2,4,6,8,10,12,20].indexOf(parseInt(size)) === -1) {\n          notify.error(`Ошибка в дайсе ${roll}. Можно бросать только дайсы размеров 4 6 8 10 12 20`);\n          return true;\n        }\n\n        return false;\n      });\n      if (wasError) return false;\n    }\n  }\n  return true;\n};\n\nexport const generateID = () =>\n  '_' + Math.random().toString(36).substr(2, 9);\n\nexport const getFailedItem: ((id: string) => IItem) = (id: string) => ({\n  discriminator: 'IItem',\n  id: id,\n  type: 'misc',\n  name: 'Ошибка',\n  weight: 0,\n  time: 0,\n  effect: id,\n  image: '',\n  description: 'Такого предмета не существует',\n  price: 0,\n  capacity: 0,\n  armor: 0,\n  approved: true,\n  failed: true,\n  amount: Number.MAX_VALUE,\n});\n\nexport const getItemName = (item: IItem, showAmount: boolean = true) =>\n  `${item ? `'${item.name}'` : 'предмет'}` + (showAmount && item.amount && item.amount >= 2 ? ` (${item.amount}шт)` : '');\n","import { IRoll } from '../helpers/dice';\nimport { ICharacter } from \"../containers/Character/config\";\n\nexport interface IAction {\n  type: string;\n\n  [key: string]: any; // Payload could be any type or size\n}\n\nexport interface IMessage {\n  author: string;\n  time: number;\n  body: string;\n  grouped?: boolean; // Remove header and top margin of message, because author is the same\n  isRP?: boolean;\n  mentioned?: boolean;\n  rolls?: IRoll[];\n  data?: { [key: string]: any }; // Extra data for special purposes\n}\n\nexport interface IState {\n  userData: IUser | null;\n  isLoggedIn: boolean;\n  settings: IUser | false;\n  loading: boolean;\n  messages: IMessage[];\n  users: IUsers;\n  uid: string;\n  currentUser: IUser | null;\n  items: IItem[];\n  error: Error | false;\n  notify?: string;\n  redirect?: string;\n  usersActivity: { [key: string]: string };\n  deletingItemData: IDeletedItemData;\n}\n\nexport interface IInventoryItem {\n  id: string;\n  time: number;\n  type: ItemType;\n  amount: number;\n}\n\nexport interface IInventory {\n  [key: string]: IInventoryItem;\n}\n\nexport interface IUser {\n  nickname: string;\n  avatar: string;\n  uid: string,\n  lastOnline: number;\n  isAdmin?: boolean;\n  inventory: IInventory,\n  character?: ICharacter,\n  approved: boolean;\n}\n\nexport interface IUsers {\n  [key: string]: IUser;\n}\n\nexport const defaultUser: IUser = {\n  lastOnline: 0,\n\n  nickname: '',\n  avatar: '',\n\n  isAdmin: false,\n  uid: '',\n  inventory: {},\n  approved: false,\n};\n\nexport type ItemType = 'weapon' | 'usable' | 'wearable' | 'junk' | 'ammo' | 'note' | 'key' | 'misc';\n\nexport interface IItem {\n  discriminator: 'IItem',\n  id: string;\n  name: string;\n  weight: number;\n  time: number;\n  effect: string;\n  image: string;\n  description: string;\n  price: number;\n  capacity: number;\n  armor: number;\n  amount?: number;\n  approved: boolean;\n  author?: string;\n  type: ItemType;\n  failed?: boolean;\n}\n\nexport const defaultItem: IItem = {\n  discriminator: 'IItem',\n  id: '',\n  type: 'junk',\n  name: '',\n  effect: '',\n  image: '',\n  weight: 0,\n  price: 0,\n  description: '',\n  capacity: 0,\n  approved: false,\n  armor: 0,\n  time: 0,\n  amount: 0,\n};\n\nexport interface IDeletedItemData {\n  itemId?: string;\n  deleted?: boolean;\n  messagesChecked?: number;\n  messagesCleared?: number;\n  usersChecked?: number;\n  usersCleared?: number;\n  done?: boolean;\n}\n\nexport const defaultDeletedItemData: IDeletedItemData = {\n  itemId: '',\n  deleted: false,\n  messagesChecked: 0,\n  messagesCleared: 0,\n  usersChecked: 0,\n  usersCleared: 0,\n  done: false,\n};\n","import { processMessages } from '../helpers/utils';\nimport {\n  defaultDeletedItemData,\n  defaultUser,\n  IAction,\n  IItem,\n  IState\n} from './interfaces';\n\nconst user = JSON.parse(localStorage.getItem('user') || 'null');\nif (user) localStorage.setItem('uid', user.uid);\nexport const initialState: IState = {\n  userData: user,\n  isLoggedIn: user !== null,\n  settings: false,\n  loading: false,\n  messages: [],\n  users: {},\n  uid: user ? user.uid : '',\n  currentUser: null,\n  items: [],\n  error: false,\n  usersActivity: {},\n  deletingItemData: defaultDeletedItemData,\n};\n\nconst reducer = (state = initialState, action: IAction) => {\n  switch (action.type) {\n    case 'LOGIN':\n    case 'GET_MESSAGES':\n    case 'GET_MORE_MESSAGES':\n    case 'SEND_MESSAGE':\n    case 'SET_USER':\n    case 'GET_ITEMS':\n    case 'GET_MORE_ITEMS':\n    case 'GET_ITEMS_BY_ID':\n    case 'CREATE_ITEM':\n    case 'GIVE_ITEM':\n    case 'REMOVE_ITEM':\n    case 'PASS_ITEM':\n    case 'GET_USERS_ACTIVITY':\n    case 'REGISTER':\n    case 'RESET_PASSWORD':\n    case 'UPLOAD_FILE': {\n      return {\n        ...state,\n        loading: true,\n      }\n    }\n    case 'SET_USER_SUCCESS':\n    case 'SET_USER_FAIL':\n    case 'GET_MESSAGES_FAIL':\n    case 'GET_MORE_MESSAGES_SUCCESS':\n    case 'GET_MORE_MESSAGES_FAIL':\n    case 'GIVE_ITEM_SUCCESS':\n    case 'REMOVE_ITEM_SUCCESS':\n    case 'REMOVE_ITEM_FAIL':\n    case 'PASS_ITEM_SUCCESS':\n    case 'PASS_ITEM_FAIL':\n    case 'GET_USERS_ACTIVITY_FAIL':\n    case 'DELETE_ITEM_FAIL':\n    case 'RESET_PASSWORD_FAIL':\n    case 'RESET_PASSWORD_SUCCESS':\n    case 'SEND_MESSAGE_FAIL': {\n      return {\n        ...state,\n        loading: false,\n      }\n    }\n    case 'LOGIN_SUCCESS': {\n      return {\n        ...state,\n        uid: action.user.uid,\n        userData: action.user,\n        isLoggedIn: action.user !== null,\n        currentUser: {\n          ...defaultUser,\n          uid: action.user.uid,\n        },\n        loading: false,\n      }\n    }\n    case 'REGISTER_FAIL':\n    case 'LOGIN_FAIL': {\n      return {\n        ...state,\n        loading: false,\n        error: action.error,\n      }\n    }\n    case 'LOGOUT': {\n      return {\n        ...state,\n        userData: null,\n        isLoggedIn: false,\n      }\n    }\n    case 'GET_MESSAGES_SUCCESS': {\n      const messages = action.concat\n        ? [...state.messages, ...action.messages]\n        : action.messages;\n\n      return {\n        ...state,\n        messages: processMessages(messages),\n        loading: false,\n      }\n    }\n    case 'GET_USER_SUCCESS': {\n      const currentUser = action.user.uid === state.uid\n        ? action.user\n        : state.currentUser;\n\n      return {\n        ...state,\n        currentUser,\n        users: {\n          ...state.users,\n          [action.uid]: action.user,\n        },\n      }\n    }\n    case 'GET_ITEMS_SUCCESS': {\n      const items: { [key: string]: IItem } = {};\n      [...state.items, ...action.items]\n        .forEach((item: IItem) => items[item.id] = item);\n\n      return {\n        ...state,\n        loading: false,\n        items: Object.values(items),\n      }\n    }\n    case 'NOTIFY': {\n      return {\n        ...state,\n        notify: action.message,\n      }\n    }\n    case 'NOTIFY_SUCCESS': {\n      return {\n        ...state,\n        notify: undefined,\n      }\n    }\n    case 'REDIRECT': {\n      return {\n        ...state,\n        redirect: action.to,\n      }\n    }\n    case 'REDIRECT_SUCCESS': {\n      return {\n        ...state,\n        redirect: undefined,\n      }\n    }\n    case 'GET_USERS_ACTIVITY_SUCCESS': {\n      return {\n        ...state,\n        loading: false,\n        usersActivity: action.usersActivity,\n      }\n    }\n    case 'DELETE_ITEM': {\n      return {\n        ...state,\n        loading: true,\n        deletingItemData: {\n          itemId: action.id,\n          defaultDeletedItemData,\n        },\n      }\n    }\n    case 'DELETE_ITEM_PROGRESS': {\n      return {\n        ...state,\n        deletingItemData: {\n          ...state.deletingItemData,\n          [action.field]: action.value\n        },\n      }\n    }\n    case 'DELETE_ITEM_SUCCESS': {\n      return {\n        ...state,\n        loading: false,\n        items: state.items.filter((item: IItem) => item.id !== action.id),\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","import { createStore, applyMiddleware } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport { composeWithDevTools } from 'redux-devtools-extension';\n\nimport { initialState } from '../reducers';\nimport reducers from '../reducers'\n\nexport const sagaMiddleware = createSagaMiddleware();\nconst store = createStore(\n  reducers,\n  initialState,\n  composeWithDevTools(applyMiddleware(sagaMiddleware)),\n);\n\nexport default store;\n","import store from '../helpers/store';\nimport { camelize } from '../helpers/utils';\n\nconst dispatch = store.dispatch;\n\nexport interface IPayload {\n  [key: string]: any;\n}\n\ninterface IActions {\n  [key: string]: (payload: IPayload) => void;\n}\n\nconst createAction =\n  (type: string) =>\n    (payload?: IPayload) =>\n      dispatch({ type, ...payload });\n\nconst createAsyncAction = (type: string) => {\n  const typeName = camelize(type);\n  return {\n    [typeName]: createAction(type),\n    [`${typeName}Success`]: createAction(`${type}_SUCCESS`),\n    [`${typeName}Fail`]: createAction(`${type}_FAIL`),\n  }\n};\n\nconst actions: IActions = {\n  ...createAsyncAction('LOGIN'),\n  ...createAsyncAction('REGISTER'),\n  ...createAsyncAction('RESET_PASSWORD'),\n  ...createAsyncAction('GET_USER'),\n  ...createAsyncAction('GET_MESSAGES'),\n  ...createAsyncAction('GET_MORE_MESSAGES'),\n  ...createAsyncAction('SET_USER'),\n  ...createAsyncAction('SEND_MESSAGE'),\n  ...createAsyncAction('CHANGE_MESSAGE'),\n  ...createAsyncAction('SUBSCRIBE'),\n  ...createAsyncAction('UNSUBSCRIBE'),\n  ...createAsyncAction('UPLOAD_FILE'),\n  ...createAsyncAction('SET_ITEM'),\n  ...createAsyncAction('DELETE_ITEM'),\n  ...createAsyncAction('GET_ITEMS'),\n  ...createAsyncAction('GET_ITEM_BY_ID'),\n  ...createAsyncAction('GET_MORE_ITEMS'),\n  ...createAsyncAction('GIVE_ITEM'),\n  ...createAsyncAction('REMOVE_ITEM'),\n  ...createAsyncAction('PASS_ITEM'),\n  ...createAsyncAction('TAKE_ITEM'),\n  ...createAsyncAction('NOTIFY'),\n  ...createAsyncAction('REDIRECT'),\n  ...createAsyncAction('GET_USERS_ACTIVITY'),\n  ...createAsyncAction('DELETE_ITEM'),\n  deleteItemProgress: createAction('DELETE_ITEM_PROGRESS'),\n  updateLastOnline: createAction('UPDATE_LAST_ONLINE'),\n  logout: createAction('LOGOUT'),\n};\n\nexport default actions;\n","import React from 'react';\nimport { Avatar as AntdAvatar } from 'antd';\nimport { AvatarProps } from 'antd/es/avatar';\n\nimport { colorFromString, isURL } from '../helpers/utils';\n\ninterface IAvatarProps extends AvatarProps {\n  avatar: string;\n  nickname: string;\n}\n\nconst Avatar = (props: IAvatarProps) => {\n  const { avatar, nickname, style, ...rest } = props;\n\n  const _avatar = isURL(avatar) ? avatar : '';\n  return (\n    <AntdAvatar\n      src={_avatar}\n      style={{ ...style, backgroundColor: _avatar ? 'transparent' : colorFromString(nickname) }}\n      {...rest}\n    >\n      {nickname && nickname.substr(0, 5)}\n    </AntdAvatar>\n  )\n};\n\nexport default Avatar;\n","import React, { Component } from 'react';\nimport { Modal } from 'antd';\nimport { CloseOutlined } from '@ant-design/icons';\n\nclass Image extends Component<{ src: string }, { visible: boolean }> {\n  state = { visible: false };\n\n  toggleModal = () => {\n    this.setState({\n      visible: !this.state.visible,\n    });\n  };\n\n  render() {\n    const { src } = this.props;\n\n    return (\n      <React.Fragment>\n        <img\n          onClick={this.toggleModal}\n          src={src}\n          alt=\"\"\n          className=\"chat-image\"\n        />\n        <Modal\n          title={\n            <div>\n              <a\n                href={src}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {src}\n              </a>\n              <CloseOutlined onClick={this.toggleModal}/>\n            </div>\n          }\n          className=\"image-modal\"\n          closable={false}\n          footer={null}\n          visible={this.state.visible}\n          onCancel={this.toggleModal}\n          width=\"fit-content\"\n        >\n          <img\n            style={{\n              maxWidth: '90vw',\n            }}\n            src={src}\n            alt=\"\"\n          />\n        </Modal>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Image;\n","import React, { Component } from 'react';\nimport { Card, Button } from 'antd';\nimport { DeleteOutlined } from '@ant-design/icons';\n\nimport '../styles/item.scss';\nimport { IItem } from '../reducers/interfaces';\nimport Avatar from './Avatar';\nimport actions from '../reducers/actions';\n\ninterface IItemProps {\n  item: IItem,\n  footer?: JSX.Element,\n  disabled?: boolean;\n  uid?: string;\n  amount?: number;\n}\n\nclass Item extends Component<IItemProps> {\n  getStats = () => {\n    const { type, armor, capacity } = this.props.item;\n\n    switch (type) {\n      case 'wearable':\n        return armor;\n\n      case 'weapon':\n        return capacity;\n\n      default:\n        const amount = this.props.amount || this.props.item.amount;\n        return (amount && amount >= 2) ? `${amount}шт` : false;\n    }\n  };\n\n  labels = {\n    wearable: 'Защита',\n    weapon: 'Магазин',\n  };\n\n  getFooter = () => {\n    const { footer, uid } = this.props;\n    const { failed, id } = this.props.item;\n\n    if (failed) {\n      return (\n        <div className=\"item-footer\">\n          <Button\n            disabled={!uid}\n            onClick={() => actions.removeItem({ uid, id, all: true })}\n          >\n            <DeleteOutlined/>\n          </Button>\n        </div>\n      )\n    }\n\n    if (footer)\n      return (\n        <div className=\"item-footer\">\n          {footer}\n        </div>\n      );\n\n    return false;\n  };\n\n  render = () => {\n    const { disabled, item } = this.props;\n    const {\n      name = item.id,\n      price = 0,\n      description,\n      image,\n      effect,\n      weight = 0,\n      type,\n      approved,\n    } = item;\n\n    const stats = this.getStats();\n    return (\n      <Card className={`item ${(approved && !disabled) ? '' : 'disabled'}`}>\n        <div className=\"item-info\">\n          <div className=\"item-name\">{name}</div>\n          <div className=\"item-subinfo\">\n            <div className=\"item-price\">\n              {price > 0 && `Цена: ${price}`}\n            </div>\n            <div className=\"item-weight\">\n              {weight > 0 && `Вес: ${weight}lb`}\n            </div>\n          </div>\n        </div>\n        {(image || description) && (\n          <div className=\"item-body\">\n            {image && <div className=\"item-image\">\n              <Avatar avatar={image} nickname={name} shape=\"square\"/>\n            </div>}\n            {description}\n          </div>\n        )}\n\n        {(stats || effect) && (\n          <div className=\"item-prefooter\">\n            <div className=\"item-ammo\">\n              {stats ? `${this.labels[type] || 'Кол-во'}: ${stats}` : ''}\n            </div>\n            <div className=\"item-effect\">{effect}</div>\n          </div>\n        )}\n        {this.getFooter()}\n      </Card>\n    )\n  }\n}\n\nexport default Item;\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport Item from './Item';\nimport { IItem, IState } from '../reducers/interfaces';\nimport actions from '../reducers/actions';\n\ninterface IItemByIdProps {\n  id: string;\n  item?: IItem;\n  disabled?: boolean;\n  footer?: JSX.Element;\n  messageId?: number;\n  amount?: number;\n}\n\nconst ItemById = (props: IItemByIdProps) => {\n  const { id, item, ...itemProps } = props;\n\n  if (!item) {\n    actions.getItemById({ id });\n    return <React.Fragment/>;\n  }\n\n  return (\n    <Item\n      item={item}\n      {...itemProps}\n    />\n  );\n};\n\nconst mapStateToProps = (state: IState, props: IItemByIdProps) => {\n  const { items } = state;\n  const item = items.find((item: IItem) => item.id === props.id);\n\n  return { item }\n};\n\nexport default connect(mapStateToProps)(ItemById);\n","import React from 'react';\nimport {\n  Button,\n  Popconfirm,\n  Collapse,\n  Tooltip,\n  Input,\n} from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\n\nimport { isURL } from '../../helpers/utils';\nimport { IMessage } from '../../reducers/interfaces';\nimport { importRolls } from '../../helpers/dice';\nimport Image from '../../components/Image';\nimport ItemById from '../../components/ItemById';\nimport actions from '../../reducers/actions';\nimport { ICharacterChanges, ICharacteristic } from \"../Character/config\";\n\ninterface IMessageBodyProps {\n  message: IMessage;\n  uid?: string;\n}\n\nconst MessageBody = (props: IMessageBodyProps) => {\n    const { uid, message } = props;\n    const {\n      body,\n      isRP,\n      rolls,\n      data,\n    } = message;\n\n    if (data) {\n      const { itemId, taken, amount, type, characterChanges } = data;\n\n      if (characterChanges) {\n        const changes: ICharacterChanges[] = Object.values(characterChanges);\n\n        const formatChange = (change: number | string | ICharacteristic) => {\n          switch (typeof change) {\n            case 'string':\n            case 'number':\n              return change;\n\n            default:\n              return [\n                change.base && `b:${change.base}`,\n                change.change && `${change.base ? ' + ' : ''}c:${change.change}`,\n                change.total && ` = t:${change.total}`,\n              ].filter(Boolean).join('');\n          }\n        };\n\n        return (\n          <Collapse>\n            <Collapse.Panel\n              key=\"char-changes\"\n              header={body}\n            >\n              {changes.map(({ label, full, before, after }) => (\n                <div\n                  key={label}\n                  className=\"chat-char-changes\"\n                >\n                  <Tooltip title={full}>\n                    <span>{label}</span>\n                  </Tooltip>\n                  <div>\n                    <Input\n                      value={formatChange(before)}\n                      readOnly\n                    />\n                    ->\n                    <Input\n                      value={formatChange(after)}\n                      readOnly\n                    />\n                  </div>\n                </div>\n              ))}\n            </Collapse.Panel>\n          </Collapse>\n        )\n      }\n\n      if (itemId) {\n        return (\n          <>\n            <i className=\"rp-message\">\n              {body}\n            </i>\n            <div className={taken ? '' : 'rp-message'}>\n              <ItemById\n                id={itemId.trim()}\n                amount={amount}\n                disabled={taken}\n                footer={uid && type ? (\n                  <Popconfirm\n                    title=\"Подобрать предмет?\"\n                    onConfirm={() => actions.takeItem({ uid, message, data })}\n                    okText=\"Подобрать\"\n                    cancelText=\"Отмена\"\n                    disabled={taken}\n                  >\n                    <Button className=\"take-button\" disabled={taken}>\n                      <UploadOutlined/>\n                    </Button>\n                  </Popconfirm>\n                ) : undefined}\n              />\n            </div>\n          </>\n        )\n      }\n    }\n\n    if (isURL(body)) {\n      if (/\\.(gif|jpe?g|tiff|png|webp|bmp)/ig.test(body)) {\n        return (\n          <Image src={body}/>\n        )\n      }\n\n      const link = (\n        <a\n          href={body}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          {body}\n        </a>\n      );\n\n      if (body.indexOf('youtu') > -1) {\n        const getVideoId = (body: string) => {\n          if (body.indexOf('youtu.be') > -1) {\n            const regExMatch = body.match(/youtu\\.be\\/.* /i);\n            if (regExMatch) {\n              const lastMatch = regExMatch.pop();\n              if (lastMatch) {\n                return lastMatch.split('/').pop() || '';\n              }\n            }\n          } else {\n            return new URL(body).searchParams.get('v') || '';\n          }\n          return ''\n        };\n\n        const searchParams = new URL(body).searchParams;\n        let params = 'listType=playlist';\n        const videoId = getVideoId(body);\n\n        if (videoId) {\n          const listId = searchParams.get('list');\n          if (listId)\n            params += '&list=' + listId;\n\n          const time = searchParams.get('t');\n          if (time)\n            params += '&start=' + time;\n\n          return (\n            <>\n              {link}\n              <iframe\n                title={videoId}\n                id=\"ytplayer\"\n                width=\"100%\"\n                height=\"360\"\n                src={`https://www.youtube.com/embed/${videoId}?${params}`}\n                frameBorder=\"0\"\n                allow=\"accelerometer; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n              />\n            </>\n          )\n        }\n      }\n\n      return link;\n    }\n\n    const _body = rolls\n      ? importRolls(body, rolls)\n      : body;\n\n    if (isRP) {\n      return (\n        <i className=\"rp-message\">\n          {_body}\n        </i>\n      )\n    }\n\n    return <span>{_body}</span>;\n  }\n;\n\nexport default MessageBody;\n","import React from 'react';\nimport { Card, Tooltip } from 'antd';\nimport { Link } from 'react-router-dom';\n\nimport { IMessage, IUser } from '../../reducers/interfaces';\nimport Avatar from '../../components/Avatar';\nimport MessageBody from './MessageBody';\nimport {\n  getDate,\n  getFullTime,\n  getTime,\n  isOnline\n} from '../../helpers/utils';\n\ninterface IMessageProps {\n  message: IMessage,\n  user: IUser,\n  uid: string;\n}\n\nconst Message = (props: IMessageProps) => {\n  const {\n    message: {\n      time,\n      grouped,\n      body,\n      mentioned,\n      author,\n    },\n    user,\n    uid,\n  } = props;\n\n  const title = user && (\n    <Link to={`./${author}/settings`}>\n      <Tooltip\n        title={user.lastOnline ? `Последняя активность: ${getFullTime(user.lastOnline)}` : undefined}\n        placement=\"left\"\n      >\n        <div className={`chat-message__title ${isOnline(user.lastOnline) ? 'online' : ''}`}>\n          <Avatar\n            avatar={user.avatar}\n            nickname={user.nickname || user.uid || author}\n          />\n          <div className=\"chat-message__nickname\">\n            {user.nickname || user.uid || author}\n          </div>\n        </div>\n      </Tooltip>\n    </Link>\n  );\n\n  return (\n    <Card\n      className={`chat-message ${grouped ? 'grouped' : ''} ${mentioned && user && (body.indexOf(`@${user.nickname} `) > -1) ? 'mentioned' : ''}`}\n      title={grouped ? undefined : title}\n      key={time}\n    >\n      <Tooltip\n        title={getDate(time)}\n        placement=\"left\"\n      >\n        <div className=\"chat-time\">{getTime(time)}</div>\n      </Tooltip>\n      <MessageBody message={props.message} uid={uid}/>\n    </Card>\n  );\n};\n\nexport default Message;\n","import React, {\n  ChangeEvent,\n  Component,\n  KeyboardEvent,\n  ClipboardEvent,\n  DragEvent,\n} from 'react';\nimport { connect } from 'react-redux';\nimport { SendOutlined } from '@ant-design/icons';\nimport {\n  Input,\n  message as notify,\n  Spin,\n} from 'antd';\n\nimport '../../styles/chat.scss';\nimport actions from '../../reducers/actions';\nimport { IMessage, IState, IUser, IUsers } from '../../reducers/interfaces';\nimport Message from './Message';\nimport { validateMessage } from '../../helpers/utils';\n\ninterface IChatProps {\n  messages: IMessage[],\n  uid: string,\n  loading: boolean,\n  users: IUsers;\n  user: IUser;\n}\n\ninterface IChatState {\n  message: string;\n  sending: boolean;\n}\n\nclass Chat extends Component<IChatProps, IChatState> {\n  state = {\n    message: '',\n    sending: false,\n  };\n\n  componentDidMount = () => {\n    actions.getMessages({});\n    actions.subscribe({});\n    this.setState({ message: localStorage.getItem('message') || '' });\n  };\n\n  componentWillUnmount = () => {\n    actions.unsubscribe({});\n  };\n\n  componentDidUpdate = (prevProps: IChatProps) => {\n    const { messages, users } = this.props;\n\n    if (this.state.sending && prevProps.messages !== messages) {\n      localStorage.setItem('message', '');\n      this.setState({\n        message: '',\n        sending: false,\n      });\n    }\n\n    messages.forEach((m: IMessage) => {\n      if (!users[m.author]) {\n        actions.getUser({ uid: m.author });\n      }\n    });\n  };\n\n  onChangeMessage = (event: ChangeEvent<HTMLTextAreaElement>) => {\n    const message = event.target.value;\n    localStorage.setItem('message', message);\n    this.setState({ message });\n  };\n\n  onKeyDown = (event: KeyboardEvent<HTMLTextAreaElement>) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n\n      this.onSendMessage();\n    }\n\n    const { uid } = this.props;\n    if (event.key === 'Up' || event.key === 'ArrowUp') {\n      const message = this.props.messages.find((m: IMessage) => m.author === uid);\n      if (message) {\n        const { currentTarget: { value, selectionStart } } = event;\n        if (value.substr(0, selectionStart).split('\\n').length === 1) {\n          const { body } = message;\n          localStorage.setItem('message', body);\n          this.setState({ message: body });\n        }\n      }\n    }\n  };\n\n  onSendMessage = () => {\n    const { message } = this.state;\n    const { user, loading, uid } = this.props;\n\n    if (loading) {\n      return;\n    }\n\n    if (!user) {\n      notify.error('Данные о пользователе отсутствуют');\n      return;\n    }\n\n    if (!user.nickname) {\n      notify.error('Никнейм не установлен. Пройдите в настройки и назовите себя');\n      return;\n    }\n\n    if (!user.approved) {\n      notify.error('Админ пока что не активировал Ваш аккаунт');\n      return;\n    }\n\n    if (!validateMessage(message)) {\n      return;\n    }\n\n    this.setState({ sending: true });\n    actions.sendMessage({\n      uid,\n      message,\n    });\n  };\n\n  getMoreMessages = () => {\n    actions.getMoreMessages({ firstMessage: this.props.messages[this.props.messages.length - 1] })\n  };\n\n  onScroll = (event: React.UIEvent<HTMLDivElement, UIEvent>) => {\n    if (event.currentTarget.scrollTop <= 50) {\n      event.preventDefault();\n      this.getMoreMessages();\n    }\n  };\n\n  uploadFile = (file: File, event: ClipboardEvent<HTMLTextAreaElement> | DragEvent<HTMLTextAreaElement>) => {\n    const { uid } = this.props;\n    if (file) {\n      if (file.type.indexOf('image') > -1) {\n        actions.uploadFile({ uid: uid, file });\n      } else {\n        notify.error('Только картинки могут быть загружены');\n      }\n      event.preventDefault();\n    }\n  };\n\n  onPaste = (e: ClipboardEvent<HTMLTextAreaElement>) => {\n    this.uploadFile(e.clipboardData.files[0], e)\n  };\n\n  onDrop = (e: DragEvent<HTMLTextAreaElement>) => {\n    const file = e.dataTransfer.items[0].getAsFile();\n    if (file)\n      this.uploadFile(file, e)\n  };\n\n  render = () => {\n    const { messages, loading, users, uid } = this.props;\n\n    return (\n      <Spin spinning={loading}>\n        <div className={`chat-wrapper`}>\n          <div\n            className=\"chat-body\"\n            onScroll={this.onScroll}\n          >\n            {messages.map((m: IMessage) => (\n              <Message\n                key={m.time}\n                message={m}\n                user={users[m.author]}\n                uid={uid}\n              />\n            ))}\n          </div>\n          <div className=\"chat-controls\">\n            <Input.TextArea\n              placeholder=\"Введите сообщение\"\n              autoSize={{ minRows: 1, maxRows: 10 }}\n              onChange={this.onChangeMessage}\n              onKeyDown={this.onKeyDown}\n              value={this.state.message}\n              onPaste={this.onPaste}\n              onDrop={this.onDrop}\n            />\n            <SendOutlined\n              onClick={this.onSendMessage}\n            />\n          </div>\n        </div>\n      </Spin>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { messages, uid, loading, users } = state;\n\n  return {\n    messages,\n    uid,\n    loading,\n    users,\n    user: users[uid]\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n","import React from 'react';\n\nexport default () => (\n  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"anticon-spin\" data-icon=\"sync\" width=\"1em\" height=\"1em\"\n       fill=\"#ff4d4f\" aria-hidden=\"true\">\n    <path d=\"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z\"/>\n  </svg>\n);\n","import React from 'react';\n\nexport default () => (\n  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"\" data-icon=\"check-circle\" width=\"1em\" height=\"1em\"\n       fill=\"currentColor\" aria-hidden=\"true\">\n    <path\n      d=\"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\"\n      fill=\"#52c41a\"/>\n    <path\n      d=\"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z\"\n      fill=\"transparent\"/>\n    <path\n      d=\"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z\"\n      fill=\"#52c41a\"/>\n  </svg>\n);\n","import React from 'react';\n\nimport LoadIcon from './LoadIcon';\nimport CheckIcon from './CheckIcon';\n\nconst Loader = (props: { loading: boolean }) => {\n  const { loading } = props;\n\n  return (\n    <div className=\"loader\">\n      {loading\n        ? (\n          <LoadIcon/>\n        ) : (\n          <CheckIcon/>\n        )\n      }\n    </div>\n  )\n};\n\nexport default Loader;\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Card,\n  Input,\n  Button,\n  Popconfirm, Switch,\n} from 'antd';\nimport { RouteComponentProps } from 'react-router';\n\nimport { ClearOutlined } from '@ant-design/icons';\n\nimport actions from '../../reducers/actions';\nimport { IState, IUser, defaultUser } from '../../reducers/interfaces';\nimport Avatar from '../../components/Avatar';\nimport Loader from '../../components/Loader/index';\nimport { getFullTime } from '../../helpers/utils';\n\ninterface ISettingsProps extends RouteComponentProps {\n  loading: boolean;\n  user: IUser | null;\n  hasRight: boolean;\n  uid: string;\n  currentUser: IUser | null;\n}\n\nexport class Settings extends React.Component<ISettingsProps> {\n  componentDidMount = () => {\n    const { user, uid } = this.props;\n    if (!user) {\n      actions.getUser({ uid });\n    }\n  };\n\n  rawOnChange = (field: string, value: string | boolean) => {\n    const { user } = this.props;\n    if (!user) return;\n\n    const newSettings = {\n      ...user,\n      [field]: value,\n    };\n\n    this.setSettings(newSettings);\n  };\n\n  onChange = (field: string) =>\n    (event: ChangeEvent<HTMLInputElement>) =>\n      this.rawOnChange(field, event.target.value);\n\n  setSettings = (newSettings: {}) => {\n    const { user } = this.props;\n    if (user) {\n      actions.setUser({\n        uid: user.uid,\n        user: newSettings,\n      });\n    }\n  };\n\n  clearAvatar = () => this.setSettings({\n    ...this.props.user,\n    avatar: '',\n  });\n\n  getField = (key: string, value: string, user: IUser) => {\n    const { nickname = '' } = user;\n    const { hasRight, currentUser, uid } = this.props;\n    const disabled = !hasRight;\n\n    switch (key) {\n      case 'avatar':\n        return (\n          <div>\n            <div style={{ display: 'flex' }}>\n              <Input\n                value={value}\n                onChange={this.onChange(key)}\n                readOnly={disabled}\n              />\n              <Popconfirm\n                title=\"Очистить аватар?\"\n                onConfirm={this.clearAvatar}\n                okText=\"Да\"\n                cancelText=\"Нет\"\n                icon={<ClearOutlined style={{ color: '#ff4d4f' }}/>}\n                disabled={!value}\n              >\n                <Button\n                  disabled={disabled || !value}\n                  danger\n                >\n                  <ClearOutlined/>\n                </Button>\n              </Popconfirm>\n            </div>\n            <Avatar\n              avatar={value}\n              nickname={nickname || uid}\n              size={128}\n              style={{ margin: '8px auto', display: 'block' }}\n            />\n          </div>\n        );\n\n      case 'uid':\n        return (\n          <Input\n            value={value}\n            readOnly\n          />\n        );\n\n      case 'lastOnline':\n        return value\n          ? (\n            <Input\n              value={getFullTime(parseInt(value))}\n              readOnly\n            />\n          ) : (\n            'Пользователь ещё не был активен'\n          );\n\n      case 'approved':\n        return <>\n          {(hasRight && (currentUser && currentUser.uid !== uid)) && (\n            <>\n              <Switch\n                checked={!!value}\n                onChange={(isAdmin: boolean) => this.rawOnChange(key, isAdmin)}\n              />\n            </>\n          )}\n          {value ? 'Активирован' : 'Не активирован'}\n        </>;\n\n      case 'isAdmin':\n        return <>\n          {\n            (hasRight && (currentUser && currentUser.uid !== uid)) &&\n            <>\n              <Switch\n                checked={!!value}\n                onChange={(isAdmin: boolean) => this.rawOnChange(key, isAdmin)}\n              />\n            </>\n          }\n          {value ? 'Имеются' : 'Отсутствуют'}\n        </>;\n\n      default:\n        return (\n          <Input\n            defaultValue={value}\n            onChange={this.onChange(key)}\n            readOnly={disabled}\n          />\n        )\n    }\n  };\n\n  labels: { [key: string]: string } = {\n    'avatar': 'Аватар',\n    'nickname': 'Никнейм',\n    'lastOnline': 'Последняя активность',\n    'isAdmin': 'Права админа',\n    'uid': 'UID',\n    'approved': 'Активирован',\n  };\n\n  render = () => {\n    const { user, loading } = this.props;\n\n    return (\n      <Card\n        className=\"settings\"\n        bordered={false}\n        loading={user === undefined}\n        title={user && `Настройки игрока ${user.nickname || user.uid}`}\n      >\n        <Loader loading={loading}/>\n        {user && Object\n          .keys(defaultUser)\n          .map((key: string) => {\n            const label = this.labels[key];\n            return label && (\n              <Card\n                className={key}\n                key={key}\n                title={label}\n              >\n                {this.getField(key, `${user[key] || ''}`, user)}\n              </Card>\n            )\n          })\n        }\n      </Card>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState, props: ISettingsProps) => {\n  const { loading, users, currentUser } = state;\n\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  return {\n    loading,\n    user,\n    uid,\n    hasRight: (!!user && !!currentUser) && (currentUser.uid === user.uid || !!currentUser.isAdmin),\n    currentUser,\n  };\n};\n\nexport default connect(mapStateToProps)(Settings);\n","import React from 'react';\nimport { Button, Avatar, Card } from 'antd';\n\nimport actions from '../reducers/actions';\n\nconst byeLink = 'https://cdn.lowgif.com/full/fc3d7d9abd06a92e-hi-bear-gifs-get-the-best-gif-on-giphy.gif';\n\nconst Logout = () => {\n  return (\n    <Card>\n      <Avatar\n        src={byeLink}\n        size={256}\n        style={{ margin: '0 auto', display: 'block' }}\n      />\n      <br/>\n      <br/>\n      <Button\n        type=\"primary\"\n        size=\"large\"\n        onClick={() => actions.logout({ })}\n        style={{ width: '100%' }}\n      >\n        Выйти\n      </Button>\n    </Card>\n  )\n};\n\nexport default Logout;\n","import React, { ChangeEvent, Component } from 'react';\nimport {\n  Card,\n  Input,\n  InputNumber,\n  Button,\n  Popconfirm,\n  message as notify,\n  Modal,\n  Select,\n  Switch,\n} from 'antd';\nimport { ClearOutlined, CloseOutlined } from '@ant-design/icons';\n\nimport { defaultItem, IItem } from '../../reducers/interfaces';\nimport Avatar from '../../components/Avatar';\n\ninterface IPItem extends Partial<IItem> {\n}\n\ninterface IItemCreatorProps {\n  onSubmit: (item: IItem) => void;\n  onClose: () => void;\n  visible: boolean;\n  item?: IItem;\n  isAdmin?: boolean;\n}\n\nclass ItemCreator extends Component<IItemCreatorProps, IPItem> {\n  state = {};\n\n  labels = {\n    id: 'ID',\n    type: 'Тип*',\n    name: 'Название*',\n    weight: 'Вес',\n    effect: 'Эффект',\n    image: 'Картинка',\n    description: 'Описание',\n    price: 'Цена',\n    capacity: 'Размер магазина',\n    armor: 'Защита',\n    approved: 'Подтверждён',\n  };\n\n  types = [\n    {\n      key: 'weapon',\n      value: 'Оружие',\n    },\n    {\n      key: 'wearable',\n      value: 'Одежда/Броня',\n    },\n    {\n      key: 'usable',\n      value: 'Используемое',\n    },\n    {\n      key: 'ammo',\n      value: 'Патроны',\n    },\n    {\n      key: 'misc',\n      value: 'Прочее',\n    },\n    {\n      key: 'note',\n      value: 'Записка',\n    },\n    {\n      key: 'key',\n      value: 'Ключ',\n    },\n    {\n      key: 'junk',\n      value: 'Мусор',\n    },\n  ];\n\n  onChange = (key: string, value: string | boolean | number) =>\n\n    this.setState({ [key]: value });\n\n  clearImage = () =>\n    this.setState({ image: '' });\n\n  fields = {\n    id: () => false,\n    type: (value: string, key: string) => (\n      <Select\n        value={value}\n        onChange={(value: string) => this.onChange(key, value)}\n      >\n        {this.types.map(({ key, value }) => (\n          <Select.Option value={key} key={key}>\n            {value}\n          </Select.Option>\n        ))}\n      </Select>\n    ),\n    name: (value: string, key: string) => (\n      <Input\n        value={value}\n        onChange={(e: ChangeEvent<HTMLInputElement>) => this.onChange(key, e.currentTarget.value)}\n      />\n    ),\n    weight: (value: number, key: string) => (\n      <InputNumber\n        value={value}\n        min={0}\n        precision={2}\n        onChange={(value?: number) => this.onChange(key, value || 0)}\n        step={0.01}\n      />\n    ),\n    effect: (value: string, key: string) => (\n      <Input\n        value={value}\n        onChange={(e: ChangeEvent<HTMLInputElement>) => this.onChange(key, e.currentTarget.value)}\n      />\n    ),\n    image: (value: string, key: string) => (\n      <div>\n        <div style={{ display: 'flex' }}>\n          <Input\n            value={value}\n            onChange={(e: ChangeEvent<HTMLInputElement>) => this.onChange(key, e.currentTarget.value)}\n          />\n          <Popconfirm\n            title=\"Очистить картинку?\"\n            onConfirm={this.clearImage}\n            okText=\"Да\"\n            cancelText=\"Нет\"\n            icon={<ClearOutlined style={{ color: '#ff4d4f' }}/>}\n          >\n            <Button\n              disabled={!value}\n              danger\n            >\n              <ClearOutlined/>\n            </Button>\n          </Popconfirm>\n        </div>\n        <Avatar\n          shape=\"square\"\n          avatar={value}\n          nickname={value}\n          size={128}\n          style={{ margin: '8px auto', display: 'block' }}\n        />\n      </div>\n    ),\n    description: (value: string, key: string) => (\n      <Input.TextArea\n        value={value}\n        onChange={(e: ChangeEvent<HTMLTextAreaElement>) => this.onChange(key, e.currentTarget.value)}\n      />\n    ),\n    price: (value: number, key: string) => (\n      <InputNumber\n        value={value}\n        min={0}\n        step={1}\n        onChange={(value?: number) => this.onChange(key, value || 0)}\n      />\n    ),\n    capacity: (value: number, key: string, item: IItem) => (\n      item.type === 'weapon' && <InputNumber\n        value={value}\n        min={1}\n        step={1}\n        onChange={(value?: number) => this.onChange(key, value || 1)}\n      />\n    ),\n    armor: (value: number, key: string, item: IItem) => (\n      item.type === 'wearable' && <InputNumber\n        value={value}\n        min={0}\n        step={1}\n        onChange={(value?: number) => this.onChange(key, value || 0)}\n      />\n    ),\n    approved: (value: boolean, key: string) => (\n      this.props.isAdmin && <Switch\n        checked={value}\n        disabled={!this.props.isAdmin}\n        onChange={(checked: boolean) => this.onChange(key, checked)}\n      />\n    ),\n  };\n\n  getField = (key: string, value: string | number | boolean, item: IPItem) => {\n\n    const field = this.fields[key];\n    return field && field(value, key, item);\n  };\n\n  onSubmit = () => {\n    const { onSubmit } = this.props;\n\n    const newItem = {};\n    Object.keys(defaultItem).forEach((key: string) => {\n      newItem[key] = this.getValue(key);\n    });\n\n    const instanceOfItem = (object: any): object is IItem => {\n      return object.discriminator === 'IItem';\n    };\n\n    if (!instanceOfItem(newItem)) {\n      notify.error('Ошибка генерации предмета!');\n      console.error(newItem);\n      return;\n    }\n\n    if (!newItem.name) {\n      notify.error('Имя не может быть пустым');\n      return;\n    }\n\n    onSubmit(newItem);\n    this.setState({});\n  };\n\n  getValue = (key: string) => {\n    const { state } = this;\n    const { item } = this.props;\n\n    const value = state[key];\n    const itemValue = item ? item[key] : undefined;\n    const defaultValue = defaultItem[key];\n\n    if (value !== undefined)\n      return value;\n    else if (itemValue !== undefined)\n      return itemValue;\n    else\n      return defaultValue;\n  };\n\n  content = () => {\n    const { state } = this;\n\n    return (\n      <div className=\"item-creator\">\n        <div className=\"item-creator__body\">\n          {Object\n            .keys(defaultItem)\n            .map((key: string) => {\n                const field = this.getField(key, this.getValue(key), state);\n                return field && (\n                  <Card\n                    className={key}\n                    key={key}\n\n                    title={this.labels[key]}\n                  >\n                    {field}\n                  </Card>\n                )\n              }\n            )\n          }\n        </div>\n        <div className=\"item-creator__controls\">\n          <Popconfirm\n            title=\"Все данные будут обнулены\"\n            onConfirm={() => this.setState(defaultItem)}\n            okText=\"Очистить\"\n            cancelText=\"Отмена\"\n            icon={<ClearOutlined style={{ color: '#ff4d4f' }}/>}\n          >\n            <Button>\n              Очистить\n            </Button>\n          </Popconfirm>\n          <Popconfirm\n            title=\"Подтвердить изменения?\"\n            onConfirm={this.onSubmit}\n            okText=\"Готово\"\n            cancelText=\"Отмена\"\n            icon={<ClearOutlined style={{ color: '#15395b' }}/>}\n          >\n            <Button>\n              Готово\n            </Button>\n          </Popconfirm>\n        </div>\n      </div>\n    )\n  };\n\n  render = () => {\n    const { onClose, visible } = this.props;\n\n    return (\n      <Modal\n        className=\"item-creator-modal\"\n        centered\n        closable={false}\n        onCancel={onClose}\n        footer={null}\n        visible={visible}\n        title={\n          <CloseOutlined onClick={onClose}/>\n        }\n      >\n        {this.content()}\n      </Modal>\n    )\n  }\n}\n\nexport default ItemCreator;\n","import React, { Component } from 'react';\nimport {\n  Dropdown,\n  Menu,\n  Button,\n  Empty,\n} from 'antd';\nimport { InsertRowBelowOutlined } from '@ant-design/icons';\n\nimport { IItem, IUser } from '../../reducers/interfaces';\nimport Item from '../../components/Item';\n\nexport interface IControl {\n  label: string,\n  onClick: (item: IItem) => void;\n  condition?: (item: IItem) => boolean;\n  isAdmin?: boolean;\n}\n\ninterface IItemsListProps {\n  items: IItem[];\n  uid?: string;\n  currentUser: IUser | null;\n  controls?: IControl[];\n}\n\nclass ItemsList extends Component<IItemsListProps> {\n  getFooter = (item: IItem) => {\n    const { controls } = this.props;\n    if (!controls) return;\n\n    const controlButtons = controls\n      .map(({ label, onClick, isAdmin, condition }: IControl) => {\n        if (condition && !condition(item)) return false;\n\n        return (\n          <Menu.Item key={label}>\n            <Button onClick={() => onClick && onClick(item)}>\n              {label}\n            </Button>\n          </Menu.Item>\n        );\n      }).filter(Boolean);\n    if (controlButtons.length === 0) return;\n\n    return (\n      <Dropdown\n        overlay={<Menu>{controlButtons}</Menu>}\n        trigger={['click']}\n      >\n        <Button>\n          <InsertRowBelowOutlined/>\n        </Button>\n      </Dropdown>\n    )\n  };\n\n  render = () => {\n    const { items, uid } = this.props;\n\n    if (!items || items.length === 0) {\n      return (\n        <Empty description=\"Нет предметов\"/>\n      )\n    }\n\n    return (\n      <div className=\"items-body\">\n        {items.map((item: IItem) => (\n          <Item\n            key={item.id + item.time}\n            item={item}\n            footer={this.getFooter(item)}\n            uid={uid}\n          />\n        ))}\n      </div>\n    )\n  }\n}\n\nexport default ItemsList;\n","import React, { Component } from 'react';\nimport {\n  Switch,\n  Radio,\n  Card,\n} from 'antd';\n\nimport Loader from '../../components/Loader';\nimport { RouteComponentProps } from \"react-router\";\nimport { IItem, ItemType } from \"../../reducers/interfaces\";\n\nexport interface IItemsTableProps extends RouteComponentProps {\n  loading: boolean;\n  items: IItem[];\n}\n\nexport interface IItemsTableState {\n  searchString: string;\n  filters: { [key: string]: boolean };\n  showApproved: boolean;\n  showNotApproved: boolean;\n}\n\nclass ItemsTable<P extends IItemsTableProps, S extends IItemsTableState> extends Component<P, S> {\n  defaultState = {\n    searchString: '',\n    showApproved: true,\n    showNotApproved: false,\n    filters: {\n      'weapon': true,\n      'usable': true,\n      'wearable': true,\n      'junk': true,\n      'ammo': true,\n      'note': true,\n      'key': true,\n      'misc': true,\n    },\n  };\n\n  get items() {\n    const { searchString, filters, showApproved, showNotApproved } = this.state;\n\n    const _searchString = searchString.toLowerCase();\n    return this\n      .props\n      .items\n      .filter((item: IItem) => {\n        const { name, description, effect, type, approved } = item;\n        return (\n          (name && name.toLowerCase().indexOf(_searchString) > -1)\n          || (description && description.toLowerCase().indexOf(_searchString) > -1)\n          || (effect && effect.toLowerCase().indexOf(_searchString) > -1)\n        ) && (\n\n          filters[type]\n        ) && (\n          (showApproved && approved === true)\n          || (showNotApproved && approved === false)\n        )\n      })\n  }\n\n  getFilters = (state: IItemsTableState) => {\n    const { showNotApproved, showApproved, filters } = state;\n\n    const getButton = (name: ItemType, label: string) => (\n      <div\n        tabIndex={0}\n        className=\"items-approved-button\"\n        onClick={() => this.setState({ filters: { ...filters, [name]: !filters[name] } })}\n      >\n        <Switch checked={filters[name]}/>\n        {label}\n      </div>\n    );\n\n    return (\n      <Radio.Group\n        defaultValue={undefined}\n        style={{ display: 'flex', flexDirection: 'column' }}\n      >\n        {getButton('weapon', 'Оружие')}\n        {getButton('usable', 'Используемое')}\n        {getButton('wearable', 'Одежда/Броня')}\n        {getButton('ammo', 'Патроны')}\n        {getButton('junk', 'Мусор')}\n        {getButton('note', 'Записки')}\n        {getButton('key', 'Ключи')}\n        {getButton('misc', 'Прочее')}\n        <div tabIndex={0} className=\"items-approved-button\"\n             onClick={() => this.setState({ showApproved: !showApproved })}>\n          <Switch checked={showApproved}/>Подтвержденные\n        </div>\n        <div tabIndex={0} className=\"items-approved-button\"\n             onClick={() => this.setState({ showNotApproved: !showNotApproved })}>\n          <Switch checked={showNotApproved}/>Не Подтвержденные\n        </div>\n      </Radio.Group>\n    )\n  };\n\n  getPageControls: (() => JSX.Element[]) = () => [];\n  getHeader: ((items: IItem[]) => JSX.Element) = () => {\n    return (\n      <div className=\"items-controls\">\n        {this.getPageControls()}\n      </div>\n    )\n  };\n\n  getContent: ((items: IItem[]) => JSX.Element) = () => <React.Fragment/>;\n  getFooter: ((items: IItem[]) => JSX.Element) = () => <React.Fragment/>;\n  getTitle: () => string | undefined | false = () => undefined;\n\n  render = () => {\n    const { loading } = this.props;\n    const items = this.items;\n\n    return (\n      <Card className=\"items\" title={this.getTitle()}>\n        <Loader loading={loading}/>\n        {this.getHeader(items)}\n        {this.getContent(items)}\n        {this.getFooter(items)}\n      </Card>\n    )\n  }\n}\n\nexport default ItemsTable;\n","import React, { useState } from 'react';\nimport { InputNumber, Modal, Slider } from 'antd';\nimport { InputNumberProps } from 'antd/lib/input-number';\nimport { ModalFuncProps } from 'antd/lib/modal';\n\nimport { IItem } from '../reducers/interfaces';\n\ninterface IAmountModalProps {\n  item: IItem;\n  inputProps?: InputNumberProps;\n  modalProps?: ModalFuncProps;\n  onSubmit?: (value: number) => void;\n  onChange?: (value?: number | [number, number]) => void;\n  max?: number;\n}\n\nexport const AmountModal: (props: IAmountModalProps) => JSX.Element = (props) => {\n  const { item, inputProps, onChange, max } = props;\n\n  const [amount, setAmount] = useState(1);\n  const onInnerChange = (value?: number | [number, number]) => {\n    if (typeof value === 'number') {\n      setAmount(value || 1);\n      onChange && onChange(value || 1);\n    }\n  };\n\n  return (\n    <>\n      <InputNumber\n        defaultValue={1}\n        value={amount}\n        min={1}\n        max={max || item.amount}\n        onChange={onInnerChange}\n        {...(inputProps || {})}\n      />\n      <Slider\n        value={amount}\n        defaultValue={1}\n        min={1}\n        max={max || item.amount}\n        onChange={onInnerChange}\n        dots={(max || item.amount || 10) <= 12}\n      />\n    </>\n  )\n};\n\n/**\n * This function creates modal for choosing item quantity.\n * I didn't made a simple modal, because I would need to make\n * a lot of state actions in order to pass all needed data\n */\nconst amountModal: (props: IAmountModalProps) => void = (props) => {\n  const { item, onSubmit, modalProps, max } = props;\n  const enough = (max && max >= 2) || (!max && item.amount && item.amount >= 2);\n  const title = enough\n    ? `Сколько? (макс. ${max || item.amount}шт)`\n    : 'Уверены?';\n\n  let amount = 1;\n\n  Modal.confirm({\n    title: title,\n    className: 'amount-modal',\n    content: enough && (\n      <AmountModal\n        {...props}\n        onChange={(value?: number | [number, number]) => {\n          if (typeof value === 'number') amount = value;\n        }}\n      />\n    ),\n    onOk: (close) => {\n      onSubmit && onSubmit(amount);\n      close();\n    },\n    okText: 'Готово',\n    cancelText: 'Отмена',\n    maskClosable: true,\n    centered: true,\n    ...(modalProps || {}),\n  });\n};\n\nexport default amountModal;\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Button,\n  Input,\n  Dropdown,\n  InputNumber,\n  Tooltip,\n  Modal,\n} from 'antd';\nimport { FilterOutlined } from '@ant-design/icons';\n\nimport '../../styles/items.scss';\nimport actions from '../../reducers/actions';\nimport { IDeletedItemData, IItem, IState, IUser } from '../../reducers/interfaces';\nimport ItemCreator from './ItemCreator';\nimport ItemsList, { IControl } from '../ItemsTable/ItemsList';\nimport ItemsTable, { IItemsTableProps, IItemsTableState } from \"../ItemsTable\";\nimport amountModal from \"../../components/AmountModal\";\n\nexport interface IItemsProps extends IItemsTableProps {\n  user: IUser | null;\n  uid: string;\n  currentUser: IUser | null;\n  deletingItemData: IDeletedItemData;\n}\n\ninterface IItemsState extends IItemsTableState {\n  creatingItem: boolean;\n  editingItem: IItem | null;\n  itemsToLoad: number;\n}\n\nexport class Items extends ItemsTable<IItemsProps, IItemsState> {\n  state = {\n    ...this.defaultState,\n    creatingItem: false,\n    editingItem: null,\n    itemsToLoad: 99,\n  };\n\n  componentDidMount = () => {\n    actions.getItems({});\n  };\n\n  getPageControls = () => [\n    <Button\n      key=\"creator\"\n      onClick={() => this.toggleCreatingItem(true)}\n      disabled={!this.props.currentUser || !this.props.currentUser.approved}\n    >\n      Создать предмет\n    </Button>,\n    <Input\n      key=\"search\"\n      placeholder=\"Поиск предмета\"\n      onChange={(e: ChangeEvent<HTMLInputElement>) => this.setState({ searchString: e.currentTarget.value })}\n      allowClear\n    />,\n    <Dropdown\n      key=\"filters\"\n      overlay={this.getFilters(this.state)}\n      trigger={['click']}\n    >\n      <Button>\n        <FilterOutlined/>\n      </Button>\n    </Dropdown>,\n    <Tooltip\n      key=\"load-amount\"\n      title=\"Кол-во загружаемых предметов за раз\"\n    >\n      <InputNumber\n        value={this.state.itemsToLoad}\n        min={1}\n        max={99}\n        onChange={(itemsToLoad?: number) => this.setState({ itemsToLoad: itemsToLoad || 1 })}\n      />\n    </Tooltip>\n  ];\n\n  cardControls: IControl[] = [\n    {\n      label: 'Взять',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        max: 100,\n        onSubmit: (amount: number) =>\n          actions.giveItem({\n            id: item.id,\n            uid: this.props.uid,\n            itemType: item.type,\n            amount,\n          })\n      }),\n      condition: (item: IItem) => item.approved && Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n    {\n      label: 'Редактировать',\n      onClick: (item: IItem) => this.toggleEditingItem(item),\n      condition: (item: IItem) => Boolean((this.props.uid === item.author && !item.approved) || (this.props.currentUser && this.props.currentUser.isAdmin))\n    },\n    {\n      label: 'В консоль',\n      onClick: console.log,\n      condition: () => Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n    {\n      label: 'Удалить',\n      onClick: (item: IItem) => this.deleteModal(item),\n      condition: (item: IItem) => Boolean((this.props.uid === item.author && !item.approved) || (this.props.currentUser && this.props.currentUser.isAdmin))\n    },\n  ];\n\n  toggleCreatingItem = (creatingItem: boolean = !this.state.creatingItem) =>\n    this.setState({ creatingItem });\n\n  toggleEditingItem = (item?: IItem | null) =>\n    this.setState({ editingItem: item || null });\n\n  onCreateItem = (item: IItem) => {\n    actions.setItem({ item });\n    this.toggleCreatingItem(false);\n    this.toggleEditingItem(null);\n  };\n\n  getCreators = () => {\n    const { creatingItem, editingItem } = this.state;\n    const { currentUser } = this.props;\n    const isAdmin = !!currentUser && currentUser.isAdmin && currentUser.approved;\n\n    return (\n      <>\n        <ItemCreator\n          visible={creatingItem}\n          onClose={() => this.toggleCreatingItem(false)}\n          onSubmit={this.onCreateItem}\n          isAdmin={isAdmin}\n        />\n        <ItemCreator\n          visible={!!editingItem}\n          onClose={() => this.toggleEditingItem(null)}\n          onSubmit={this.onCreateItem}\n          item={editingItem || undefined}\n          isAdmin={isAdmin}\n        />\n      </>\n    )\n  };\n\n  deleteModal: (item: IItem) => void = (item: IItem) => Modal.confirm({\n    title: 'Удалить',\n    content: 'Это действие невозможно отменить. Вы уверены?',\n    maskClosable: true,\n    okText: 'Удалить',\n    cancelText: 'Отмена',\n    onOk: (close) => {\n      actions.deleteItem({ id: item.id });\n      close();\n    }\n  });\n\n  getContent = (items: IItem[]) => {\n    const { currentUser } = this.props;\n    return (\n      <ItemsList\n        items={items}\n        currentUser={currentUser}\n        controls={this.cardControls}\n      />\n    )\n  };\n\n  getDeletingModal = () => {\n    const { deletingItemData, loading } = this.props;\n    const { itemId, usersChecked, messagesCleared, messagesChecked, deleted, usersCleared, done } = deletingItemData;\n    return itemId && (\n      <div className=\"item-deleting-modal\">\n        <div>ID предмета: {itemId}</div>\n        <div>Удалён из списка предметов: {deleted ? 'готово' : 'в процессе'}</div>\n        <div>Проверено сообщений: {messagesChecked}</div>\n        <div>Очищено сообщений: {messagesCleared}</div>\n        <div>Проверено пользователей: {usersChecked}</div>\n        <div>Очищено пользователей: {usersCleared}</div>\n        <Button\n          onClick={() => actions.deleteItemProgress({ field: 'itemId', value: '' })}\n          disabled={!done || loading}\n        >\n          Готово\n        </Button>\n        <button\n          className=\"secret\"\n          onClick={() => actions.deleteItemProgress({ field: 'itemId', value: '' })}\n          disabled={loading}\n        />\n      </div>\n    )\n  };\n\n  getTitle = () => !this.props.loading && `Список предметов. Количество: ${this.props.items.length}`;\n\n  getFooter = (items: IItem[]): JSX.Element => {\n    const { itemsToLoad } = this.state;\n    const { loading } = this.props;\n    return (\n      <>\n        {this.getCreators()}\n        {this.getDeletingModal()}\n        {!loading && (\n          <Button\n            className=\"items-load-button\"\n            onClick={() => actions.getMoreItems({ amount: itemsToLoad, lastItem: items[items.length - 1] })}\n          >\n            Загрузить {itemsToLoad}шт\n          </Button>\n        )}\n      </>\n    )\n  };\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { loading, currentUser, uid, items, deletingItemData } = state;\n\n  return {\n    loading,\n    currentUser,\n    uid,\n    items,\n    deletingItemData,\n  };\n};\n\nexport default connect(mapStateToProps)(Items);\n","import React, { Component } from 'react';\nimport { Menu } from 'antd';\nimport '../styles/active-users.scss';\n\nimport { IUsers, IUser, IState } from '../reducers/interfaces';\nimport { connect } from \"react-redux\";\nimport actions from \"../reducers/actions\";\nimport { getFullTime, isOnline } from \"../helpers/utils\";\nimport Avatar from './Avatar';\n\ninterface IActiveUsersListProps {\n  activeUsers: string[];\n  uid: string;\n  loading: boolean;\n  users: IUsers;\n  onClick: (user: IUser) => void;\n}\n\nclass ActiveUsersList extends Component<IActiveUsersListProps> {\n  componentDidMount = () => {\n    actions.getUsersActivity({});\n  };\n\n  componentDidUpdate = () => {\n    const { activeUsers, users, loading } = this.props;\n\n    if (!loading && activeUsers.length > 0) {\n      activeUsers.forEach((uid: string) => {\n        if (!users[uid])\n          actions.getUser({ uid });\n      });\n    }\n  };\n\n  render = () => {\n    const { activeUsers, users, onClick } = this.props;\n\n    const validUsers = activeUsers\n      .filter((uid: string) => users[uid] && users[uid].uid)\n      .map((uid: string) => users[uid]);\n\n    return (\n      <Menu className=\"active-users\">\n        {validUsers.map((user: IUser) => (\n          <div\n            className=\"active-users__item\"\n            key={user.uid}\n            onClick={() => onClick(user)}\n          >\n              <div className={`active-users__body ${isOnline(user.lastOnline) ? 'online' : ''}`}>\n                <Avatar\n                  avatar={user.avatar}\n                  nickname={user.nickname}\n                />\n                <div className=\"active-users__nickname\">\n                  {user.nickname || user.uid}\n                </div>\n              </div>\n              {user.lastOnline && (\n                <div className=\"active-users__online\">\n                  {getFullTime(user.lastOnline)}\n                </div>\n              )}\n          </div>\n        ))}\n      </Menu>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { usersActivity, uid, loading, users } = state;\n\n  return {\n    users,\n    activeUsers: Object.keys(usersActivity),\n    uid,\n    loading,\n  }\n};\n\nexport default connect(mapStateToProps)(ActiveUsersList);\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Input,\n  Dropdown,\n  Button,\n  message as notify,\n  Modal,\n} from 'antd';\nimport { FilterOutlined } from '@ant-design/icons';\n\nimport { IInventory, IItem, IState, IUser } from '../../reducers/interfaces';\nimport actions from '../../reducers/actions';\nimport ItemsList, { IControl } from '../ItemsTable/ItemsList';\nimport ActiveUsersList from '../../components/ActiveUsersList';\nimport ItemsTable, { IItemsTableProps, IItemsTableState } from '../ItemsTable';\nimport amountModal from '../../components/AmountModal';\nimport { getItemName } from \"../../helpers/utils\";\n\ninterface IInventoryProps extends IItemsTableProps {\n  inventory: IInventory;\n  loading: boolean;\n  user: IUser | null;\n  uid: string;\n  items: IItem[];\n  currentUser: IUser | null;\n  hasRight: boolean;\n}\n\ninterface IInventoryState extends IItemsTableState {\n  passItem: IItem | null;\n}\n\nclass Inventory extends ItemsTable<IInventoryProps, IInventoryState> {\n  state = {\n    ...this.defaultState,\n    editingItem: null,\n    passItem: null,\n  };\n\n  componentDidMount = () => {\n    const { user, uid } = this.props;\n    if (!user && uid) {\n      actions.getUser({ uid });\n    }\n  };\n\n  getPageControls = () => [\n    <Input\n      key=\"search\"\n      placeholder=\"Поиск предмета\"\n      onChange={(e: ChangeEvent<HTMLInputElement>) => this.setState({ searchString: e.currentTarget.value })}\n      allowClear\n    />,\n    <Dropdown\n      key=\"filters\"\n      overlay={this.getFilters(this.state)}\n      trigger={['click']}\n    >\n      <Button>\n        <FilterOutlined/>\n      </Button>\n    </Dropdown>,\n    this.getPassModal(),\n  ];\n\n  getInventoryItems = (items: IItem[]) => {\n    const { inventory, loading } = this.props;\n\n    if (inventory && !loading) {\n      const inventoryItems = Object.values(inventory);\n      const loadedItems: IItem[] = [];\n      const notLoadedItems: string[] = [];\n\n      inventoryItems\n        .forEach((inventoryItem) => {\n          const { id } = inventoryItem;\n          const item = items.find((item: IItem) => item.id === id);\n          if (item) {\n            loadedItems.push({\n              ...item,\n              ...inventoryItem,\n            });\n          } else {\n            notLoadedItems.push(id);\n          }\n        });\n\n      if (notLoadedItems.length > 0) {\n        actions.getItemById({ id: notLoadedItems.shift() });\n      }\n\n      return loadedItems;\n    }\n\n    return [];\n  };\n\n  passItem = (item?: IItem | null) =>\n    this.setState({ passItem: item || null });\n\n  getPassModal = () => {\n    const { passItem } = this.state;\n    return (\n      <Modal\n        key=\"pass-modal\"\n        visible={!!passItem}\n        closable={false}\n        footer={<Button onClick={() => this.passItem(null)}>Закрыть</Button>}\n      >\n        <ActiveUsersList onClick={(user: IUser) => {\n          if (passItem !== null) {\n            actions.passItem({\n              uid: this.props.uid,\n              // @ts-ignore\n              id: passItem.id,\n              to: user,\n              item: passItem,\n            });\n            this.passItem(null);\n          }\n        }}/>\n      </Modal>\n    )\n  };\n\n  cardControls: IControl[] = [\n    {\n      label: 'Показать',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) => actions.passItem({\n          id: item.id,\n          uid: this.props.uid,\n          demonstrate: true,\n          item: {\n            ...item,\n            amount,\n          }\n        })\n      })\n    },\n    {\n      label: 'Использовать',\n      onClick: (item: IItem) => Modal.confirm({\n        title: `Использовать ${getItemName(item, false)}?`,\n        onOk: (close) => {\n          actions.passItem({\n            id: item.id,\n            uid: this.props.uid,\n            item: {\n              ...item,\n              amount: 1,\n            },\n            use: true,\n          });\n          close();\n        },\n        okText: 'Да',\n        cancelText: 'Отмена',\n      }),\n      condition: (item: IItem) => item.type === 'usable',\n    },\n    {\n      label: 'Выбросить',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) => actions.passItem({\n          id: item.id,\n          uid: this.props.uid,\n          item: {\n            ...item,\n            amount,\n          },\n        })\n      }),\n    },\n    {\n      label: 'Передать',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) => this.passItem({ ...item, amount })\n      })\n    },\n    {\n      label: 'В консоль',\n      onClick: console.log,\n      condition: () => Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n    {\n      label: 'Убрать',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) =>\n          actions.removeItem({ id: item.id, uid: this.props.uid, amount })\n      }),\n      condition: () => Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n  ];\n\n  getTitle = () => !!this.props.user && `Инвентарь игрока ${this.props.user.nickname || this.props.user.uid}`;\n\n  getContent = (items: IItem[]) => {\n    const { currentUser, uid, hasRight } = this.props;\n\n    return (\n      <ItemsList\n        uid={uid}\n        currentUser={currentUser}\n        items={this.getInventoryItems(items)}\n        controls={hasRight\n          ? this.cardControls\n          : undefined\n        }\n      />\n    )\n  };\n}\n\nconst mapStateToProps = (state: IState, props: IInventoryProps) => {\n  const { loading, users, currentUser, items, messages, usersActivity } = state;\n\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  const inventory = user ? user.inventory : {};\n\n  return {\n    loading,\n    uid,\n    items,\n    inventory,\n    user,\n    currentUser,\n    users,\n    messages,\n    hasRight: (!!user && !!currentUser) && user.approved && (currentUser.uid === user.uid || !!currentUser.isAdmin),\n    usersActivity,\n  };\n};\n\nexport default connect(mapStateToProps)(Inventory);\n","export interface IField {\n  label: string;\n  full: string;\n  field: string;\n  formula?: string;\n  getBase?: (specials: { [key: string]: number }, stats: IStats) => number;\n\n}\n\nexport interface IStats {\n  level: number;\n  hpPerLevel: number;\n  exp: number;\n  carryWeight: number;\n  wounds: string;\n\n  healthPoints: number;\n  maxHealthPoints: number;\n  armorClass: ICharacteristic;\n  healingRate: number;\n  resistance: number;\n  actionPoints: number;\n  sequence: number;\n  meleeDamage: number;\n  criticalChance: number;\n  skillPoints: number;\n  spentSkillPoints: number;\n}\n\nexport interface ICharacteristic {\n  change: number;\n  base: number;\n  total: number;\n}\n\nexport interface ICharacter {\n  special: {\n    strength: ICharacteristic;\n    perception: ICharacteristic;\n    endurance: ICharacteristic;\n    charisma: ICharacteristic;\n    intelligence: ICharacteristic;\n    agility: ICharacteristic;\n    luck: ICharacteristic;\n  };\n  skills: {\n    smallGuns: ICharacteristic;\n    bigGuns: ICharacteristic;\n    energyGuns: ICharacteristic;\n    unarmed: ICharacteristic;\n    meleeWeapons: ICharacteristic;\n    medicine: ICharacteristic;\n    sneak: ICharacteristic;\n    lockpick: ICharacteristic;\n    steal: ICharacteristic;\n    traps: ICharacteristic;\n    science: ICharacteristic;\n    repair: ICharacteristic;\n    speech: ICharacteristic;\n    barter: ICharacteristic;\n    survival: ICharacteristic;\n  };\n  stats: IStats;\n  bio: string;\n}\n\nexport const initialCharacteristic = {\n  change: 0,\n  base: 0,\n  total: 0,\n};\n\nexport const initialCharacter: ICharacter = {\n  special: {\n    strength: initialCharacteristic,\n    perception: initialCharacteristic,\n    endurance: initialCharacteristic,\n    charisma: initialCharacteristic,\n    intelligence: initialCharacteristic,\n    agility: initialCharacteristic,\n    luck: initialCharacteristic,\n  },\n  skills: {\n    smallGuns: initialCharacteristic,\n    bigGuns: initialCharacteristic,\n    energyGuns: initialCharacteristic,\n    unarmed: initialCharacteristic,\n    meleeWeapons: initialCharacteristic,\n    medicine: initialCharacteristic,\n    sneak: initialCharacteristic,\n    lockpick: initialCharacteristic,\n    steal: initialCharacteristic,\n    traps: initialCharacteristic,\n    science: initialCharacteristic,\n    repair: initialCharacteristic,\n    speech: initialCharacteristic,\n    barter: initialCharacteristic,\n    survival: initialCharacteristic,\n  },\n  stats: {\n    level: 0,\n    hpPerLevel: 0,\n    exp: 0,\n    carryWeight: 0,\n    wounds: '',\n\n    maxHealthPoints: 0,\n    healthPoints: 0,\n    armorClass: initialCharacteristic,\n    healingRate: 0,\n    resistance: 0,\n    actionPoints: 0,\n    sequence: 0,\n    meleeDamage: 0,\n    criticalChance: 0,\n    skillPoints: 0,\n    spentSkillPoints: 0,\n  },\n  bio: '',\n};\n\nexport const special: IField[] = [\n  {\n    label: 'ST',\n    full: 'Сила',\n    field: 'strength',\n  },\n  {\n    label: 'PE',\n    full: 'Восприятие',\n    field: 'perception',\n  },\n  {\n    label: 'EN',\n    full: 'Выносливость',\n    field: 'endurance',\n  },\n  {\n    label: 'CH',\n    full: 'Харизма',\n    field: 'charisma',\n  },\n  {\n    label: 'IN',\n    full: 'Интеллект',\n    field: 'intelligence',\n  },\n  {\n    label: 'AG',\n    full: 'Ловкость',\n    field: 'agility',\n  },\n  {\n    label: 'LK',\n    full: 'Удача',\n    field: 'luck',\n  },\n];\n\nexport const skills: IField[] = [\n  {\n    label: 'Small Guns',\n    full: 'Оружие',\n    formula: '5+(4*AG)',\n    field: 'smallGuns',\n    getBase: (s) => 5 + (4 * s.ag),\n  },\n  {\n    label: 'Big Guns',\n    full: 'Большое оружие',\n    formula: '(2*AG)',\n    field: 'bigGuns',\n    getBase: (s) => (2 * s.ag),\n  },\n  {\n    label: 'Energy Guns',\n    full: 'Энергетическое оружие',\n    formula: '(2*AG)',\n    field: 'energyGuns',\n    getBase: (s) => (2 * s.ag),\n  },\n  {\n    label: 'Unarmed',\n    full: 'Без оружия',\n    formula: '(30+(2*(AG+ST)))',\n    field: 'unarmed',\n    getBase: (s) => 30 + (2 * (s.ag + s.st)),\n  },\n  {\n    label: 'Melee',\n    full: 'Холодное оружие',\n    formula: '20+(2*(AG+ST))',\n    field: 'meleeWeapons',\n    getBase: (s) => 20 + (2 * (s.ag + s.st)),\n  },\n  {\n    label: 'Medicine',\n    full: 'Медицина',\n    formula: '5+(PE+EN+(3*AG))',\n    field: 'medicine',\n    getBase: (s) => 5 + (s.pe + s.en + (3 * s.ag)),\n  },\n  {\n    label: 'Sneak',\n    full: 'Скрытность',\n    formula: '5+(3*AG)',\n    field: 'sneak',\n    getBase: (s) => 5 + (3 * s.ag),\n  },\n  {\n    label: 'Lockpick',\n    full: 'Взлом',\n    formula: '10+(PE+AG)',\n    field: 'lockpick',\n    getBase: (s) => 10 + (s.pe + s.ag),\n  },\n  {\n    label: 'Steal',\n    full: 'Кража',\n    formula: '(3+AG)',\n    field: 'steal',\n    getBase: (s) => 3 + s.ag,\n  },\n  {\n    label: 'Traps',\n    full: 'Ловушки',\n    formula: '10+(PE+AG)',\n    field: 'traps',\n    getBase: (s) => 10 + (s.pe + s.ag),\n  },\n  {\n    label: 'Science',\n    full: 'Наука',\n    formula: '(4*IN)',\n    field: 'science',\n    getBase: (s) => 4 * s.in,\n  },\n  {\n    label: 'Repair',\n    full: 'Ремонт',\n    formula: '(3*IN)',\n    field: 'repair',\n    getBase: (s) => 3 * s.in,\n  },\n  {\n    label: 'Speech',\n    full: 'Красноречие',\n    formula: '(5*CH)',\n    field: 'speech',\n    getBase: (s) => 5 * s.ch,\n  },\n  {\n    label: 'Barter',\n    full: 'Бартер',\n    formula: '(4*CH)',\n    field: 'barter',\n    getBase: (s) => 4 * s.ch,\n  },\n  {\n    label: 'Survival',\n    full: 'Выживание',\n    formula: '(2*(EN+IN))',\n    field: 'survival',\n    getBase: (s) => 2 * (s.en + s.in),\n  },\n];\n\nexport const stats: IField[] = [\n  {\n    label: 'Level',\n    full: 'Уровень',\n    field: 'level',\n    getBase: (_, stats) => (Math.sqrt(((stats.exp / 500) * 4) + 1) + 1) / 2,\n  },\n  {\n    label: 'HP/Level',\n    full: 'ОЗ/Уровень',\n    field: 'hpPerLevel',\n    getBase: (s) => 3 + Math.floor(s.en / 2),\n  },\n  {\n    label: 'Experience',\n    full: 'Опыт',\n    field: 'exp',\n  },\n  {\n    label: 'Carry Weight',\n    full: 'Переносимый вес',\n    field: 'carryWeight',\n    getBase: (s) => 25 + (25 * s.st),\n  },\n  {\n    label: 'Wounds',\n    full: 'Раны',\n    field: 'wounds',\n  },\n];\n\nexport const subStats: IField[] = [\n  {\n    label: 'Max HP',\n    full: 'Макс. Очки Здоровья (ОЗ)',\n    field: 'maxHealthPoints',\n    getBase: (s, stats) => (15 + (s.st + (2 * s.en))) + (stats.hpPerLevel * stats.level),\n  },\n  {\n    label: 'Health Points',\n    full: 'Очки Здоровья (ОЗ)',\n    field: 'healthPoints',\n  },\n  {\n    label: 'КБ',\n    full: 'Класс Брони',\n    field: 'armorClass',\n    getBase: (s) => s.ag,\n  },\n  {\n    label: 'СЛ',\n    full: 'СамоЛечение',\n    field: 'healingRate',\n    getBase: (s) => Math.floor(s.en / 3),\n  },\n  {\n    label: 'СП',\n    full: 'СоПротивление',\n    field: 'resistance',\n    getBase: (s) => 5 * s.en,\n  },\n  {\n    label: 'ОД',\n    full: 'Очки Действий',\n    field: 'actionPoints',\n    getBase: (s) => 5 + Math.ceil(s.ag / 2),\n  },\n  {\n    label: 'ИЦ',\n    full: 'ИниЦиатива',\n    field: 'sequence',\n    getBase: (s) => 2 * s.pe,\n  },\n  {\n    label: 'РУ',\n    full: 'Рукопашный Урон',\n    field: 'meleeDamage',\n    getBase: (s) => Math.max(1, s.st - 5),\n  },\n  {\n    label: 'ШК',\n    full: 'Шанс Крита',\n    field: 'criticalChance',\n    getBase: (s) => s.lk,\n  },\n  {\n    label: 'ОН',\n    full: 'Очки Навыков',\n    field: 'skillPoints',\n    getBase: (s, stats) => ((stats.level - 1) * (5 + (2 * s.in)) - stats.spentSkillPoints),\n  },\n];\n\nexport interface ICharacterChanges {\n  label: string;\n  full: string;\n  before: number | string | ICharacteristic;\n  after: number | string | ICharacteristic;\n}\n\nexport const getConfigByField = (findField: string): IField | undefined  => {\n  return [...special, ...skills, ...stats, ...subStats].find(({ field }) => field === findField);\n};\n\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Form,\n  Card,\n  Input,\n  InputNumber,\n  Tooltip,\n  Empty,\n  Spin,\n  Button,\n  Popconfirm,\n  message as notify,\n} from 'antd';\nimport { Callbacks, Store } from 'rc-field-form/lib/interface';\nimport { RouteComponentProps } from 'react-router';\nimport { diff } from 'deep-object-diff';\n\nimport '../../styles/character.scss';\nimport { IState, IUser } from '../../reducers/interfaces';\nimport {\n  initialCharacter,\n  special as configSpecial,\n  skills as configSkills,\n  stats as configStats,\n  subStats as configSubStats,\n  ICharacteristic,\n  ICharacter,\n  IStats,\n  getConfigByField,\n  IField,\n  ICharacterChanges,\n} from './config';\nimport actions from '../../reducers/actions';\n\ninterface ICharacterProps extends RouteComponentProps {\n  loading: boolean;\n  user: IUser | null;\n  hasRight: boolean;\n  uid: string;\n  currentUser: IUser | null;\n}\n\n/**\n * This component is most complex one in whole project\n * Beware of complex methods and data types\n */\nclass Character extends Component<ICharacterProps, ICharacter> {\n  state = initialCharacter;\n\n  componentDidMount = () => {\n    const { user, uid } = this.props;\n    if (!user) {\n      actions.getUser({ uid });\n    }\n  };\n\n  getSpecial = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-special\">\n        <div className=\"char-special-item\">\n          <span className=\"char-special-label\"/>\n          <div className=\"char-special-input total\">\n            Total\n          </div>\n          <div className=\"char-special-input\">\n            +/-\n          </div>\n          <div className=\"char-special-input\">\n            Base\n          </div>\n        </div>\n        {configSpecial.map(({ label, full, field }) => (\n          <div\n            key={label}\n            className=\"char-special-item\"\n          >\n            <Tooltip title={full}>\n              <span className=\"char-special-label\">{label}</span>\n            </Tooltip>\n            <Form.Item name={['special', field, 'total']}>\n              <Input\n                className=\"char-special-input total\"\n                readOnly\n                min={0}\n                max={9}\n                disabled={!hasRight}\n              />\n            </Form.Item>\n            <Form.Item name={['special', field, 'change']}>\n              <InputNumber\n                className=\"char-special-input\"\n                min={0}\n                max={9}\n                disabled={!hasRight}\n              />\n            </Form.Item>\n            <Form.Item name={['special', field, 'base']}>\n              <InputNumber\n                className=\"char-special-input\"\n                min={0}\n                max={9}\n                disabled={!hasRight}\n              />\n            </Form.Item>\n          </div>\n        ))}\n      </Card>\n    )\n  };\n\n\n  getSkills = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-skills\">\n        <div className=\"char-skills-item\">\n          <span className=\"char-skills-label\"/>\n          <div className=\"char-skills-input total\">\n            Total\n          </div>\n          <div className=\"char-skills-input\">\n            +/-\n          </div>\n          <div className=\"char-skills-input\">\n            Base\n          </div>\n        </div>\n        {configSkills.map(({ label, full, formula, field }) => (\n          <div\n            key={field}\n            className=\"char-skills-item\"\n          >\n            <Tooltip title={full}>\n              <span className=\"char-skills-label\">{label}</span>\n            </Tooltip>\n            <Form.Item name={['skills', field, 'total']}>\n              <Input\n                className=\"char-skills-input\"\n                readOnly\n                disabled={!hasRight}\n              />\n            </Form.Item>\n            <Form.Item name={['skills', field, 'change']}>\n              <InputNumber\n                className=\"char-skills-input\"\n                disabled={!hasRight}\n                min={1}\n                max={95}\n              />\n            </Form.Item>\n            <Tooltip title={formula}>\n              <Form.Item name={['skills', field, 'base']}>\n                <Input\n                  className=\"char-skills-input\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </Tooltip>\n          </div>\n        ))}\n      </Card>\n    )\n  };\n\n  getStats = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-stats\">\n        {configStats.map(({ label, full, field, getBase }) => (\n          <div\n            key={field}\n            className=\"char-stats-item\"\n          >\n            <Tooltip title={full}>\n              <span className=\"char-stats-label\">{label}</span>\n            </Tooltip>\n            <Form.Item name={['stats', field]}>\n              {field === 'wounds'\n                ? (\n                  <Input.TextArea\n                    className=\"char-stats-input\"\n                    disabled={!hasRight}\n                  />\n                ) : (\n                  !!getBase\n                    ? (\n                      <Input\n                        className=\"char-stats-input\"\n                        readOnly\n                        disabled={!hasRight}\n                      />\n                    ) : (\n                      <InputNumber\n                        className=\"char-stats-input\"\n                        min={1}\n                        max={Number.MAX_SAFE_INTEGER}\n                        disabled={!hasRight}\n                      />\n                    )\n                )}\n            </Form.Item>\n          </div>))}\n      </Card>\n    )\n  };\n\n  getMainStats = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-main-stats\">\n        <div className=\"char-main-stats-health\">\n          <div className=\"char-main-stats-hp\">\n            <span className=\"char-main-stats-hp-label\">Очки Здоровья (ОЗ)</span>\n            <div className=\"char-main-stats-hp-body\">\n              <Form.Item name={['stats', 'healthPoints']}>\n                <InputNumber\n                  max={this.state.stats.maxHealthPoints || undefined}\n                  min={-Math.floor(this.state.stats.maxHealthPoints / 2)}\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n              /\n              <Form.Item name={['stats', 'maxHealthPoints']}>\n                <Input\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </div>\n          </div>\n          <div className=\"char-main-stats-ap-wrapper\">\n            <div className=\"char-main-stats-ap\">\n              <Tooltip title=\"Класс Брони (КБ)\">\n                <div className=\"char-main-stats-ap-total\">\n                  КБ\n                </div>\n              </Tooltip>\n              <div className=\"char-main-stats-ap-change\">\n                +/-\n              </div>\n              <div className=\"char-main-stats-ap-base\">\n                Base\n              </div>\n            </div>\n            <div className=\"char-main-stats-ap\">\n              <Form.Item name={['stats', 'armorClass', 'total']}>\n                <Input\n                  className=\"char-main-stats-ap-total\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n              <Form.Item name={['stats', 'armorClass', 'change']}>\n                <InputNumber\n                  className=\"char-main-stats-ap-change\"\n                  min={1}\n                  max={95}\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n              <Form.Item name={['stats', 'armorClass', 'base']}>\n                <Input\n                  className=\"char-main-stats-ap-base\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </div>\n          </div>\n        </div>\n        <div className=\"char-main-stats-info\">\n          {configSubStats.slice(3).map(({ label, full, field }) => (\n            <div\n              key={field}\n              className=\"char-main-stats-item\"\n            >\n              <Tooltip title={full}>\n                <span className=\"char-main-stats-item-label\">{label}</span>\n              </Tooltip>\n              <Form.Item name={['stats', field]}>\n                <Input\n                  className=\"char-main-stats-item-input\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </div>\n          ))}\n        </div>\n      </Card>\n    )\n  };\n\n  onChange: Callbacks['onValuesChange'] = (value, char) => {\n    if (value.bio) {\n      this.setState({ bio: value.bio });\n    } else {\n      this.setState(this.processChar(value, char));\n    }\n  };\n\n  // TODO Needs refactor for sure\n  processChar = (value: Store, char: Store) => {\n    const { special, skills, stats, bio } = char;\n\n    if (!value.bio) {\n      const specialTotal: { [key: string]: number } = {};\n      configSpecial.forEach(({ field, label }) => {\n        const value: ICharacteristic = special[field];\n        const total = Math.max(0, Math.min(9, value.base + value.change));\n        special[field] = {\n          ...value,\n          total,\n        };\n        specialTotal[label.toLowerCase()] = total;\n      });\n\n      stats.spentSkillPoints = 0;\n      configSkills.forEach(({ field, getBase }) => {\n        const value: ICharacteristic = skills[field];\n        const change = Math.max(1, value.change);\n        const base = Math.max(1, getBase ? getBase(specialTotal, stats) : 1);\n        const total = Math.max(1, Math.min(95, base + change));\n\n        skills[field] = {\n          change,\n          base,\n          total,\n        };\n        stats.spentSkillPoints += (value.change - 1);\n      });\n\n      [...configStats, ...configSubStats].forEach(({ field, getBase }) => {\n        if (getBase) {\n          if (field === 'armorClass') {\n            const base = getBase(specialTotal, stats);\n            const change = stats[field].change;\n            stats[field] = {\n              change,\n              base,\n              total: change + base,\n            }\n          } else {\n            stats[field] = Math.floor(getBase(specialTotal, stats));\n          }\n        }\n      });\n    }\n\n    return {\n      special,\n      skills,\n      stats,\n      bio,\n    };\n  };\n\n  getChanges = (beforeChar: ICharacter, afterChar: ICharacter) => {\n    const before = diff(afterChar, beforeChar);\n    const after = diff(beforeChar, afterChar);\n\n    const changes: ICharacterChanges[] = [];\n\n    Object.entries(before).forEach(([name, characteristic]: [string, string | ICharacteristic | IStats]) => {\n      if (name === 'bio' && typeof characteristic === 'string') {\n        changes.push({\n          label: 'Bio',\n          full: 'Биография',\n          before: characteristic,\n\n          after: after[name],\n        });\n        return;\n      }\n\n      Object.entries(characteristic).forEach(([field, value]: [string, ICharacteristic]) => {\n\n        const afterValue = after[name][field];\n        const config: IField | undefined = getConfigByField(field);\n        if (config) {\n          changes.push({\n            label: config.label,\n            full: config.full,\n            before: value,\n            after: afterValue,\n          });\n        }\n      })\n    });\n\n    return changes;\n  };\n\n  onSave = () => {\n    const { uid, user } = this.props;\n    const character = this.state;\n\n    if (!user) {\n      notify.error('Пользователь не загружен!');\n      return;\n    }\n\n    if (character.stats.skillPoints < 0) {\n      notify.error('Очки Нвыков (ОН) не могут быть отрицательными!');\n      return;\n    }\n\n    const changes = this.getChanges(user.character || initialCharacter, character);\n    if (changes.length === 0) {\n      notify.error('В персонаже ничего не изменилось');\n      return;\n    }\n\n    notify.success('Персонаж сохранён');\n    actions.setUser({\n      uid,\n      user: {\n        ...user,\n        character,\n      }\n    });\n    actions.sendMessage({\n      uid,\n      message: `Характеристики персонажа изменены`,\n      data: { characterChanges: changes }\n    });\n  };\n\n\n  render = () => {\n    const { user, hasRight } = this.props;\n\n    if (!user) {\n      return (\n        <Spin spinning>\n          <Empty description=\"Пользователь не загружен\"/>\n        </Spin>\n      );\n    }\n\n    return (\n      <Form\n        initialValues={user.character || initialCharacter}\n        onValuesChange={this.onChange}\n      >\n        <Card\n          className=\"char\"\n          title={`Персонаж игрока ${user.nickname || user.uid}`}\n          extra={\n            <Popconfirm\n              title=\"Применить изменения?\"\n              okText=\"Да\"\n              cancelText=\"Отмена\"\n              onConfirm={this.onSave}\n            >\n              <Button>Готово</Button>\n            </Popconfirm>\n          }\n        >\n          <div className=\"char-bio\">\n            <Form.Item name={['bio']}>\n              <Input.TextArea\n                disabled={!hasRight}\n                minLength={3}\n              />\n            </Form.Item>\n          </div>\n          <div>\n            {this.getMainStats()}\n          </div>\n          <div>\n            <div>\n              {this.getSpecial()}\n              {this.getStats()}\n            </div>\n            <div>\n              {this.getSkills()}\n            </div>\n          </div>\n        </Card>\n      </Form>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState, props: ICharacterProps) => {\n  const { loading, users, currentUser } = state;\n\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  return {\n    loading,\n    user,\n    uid,\n    hasRight: (!!user && !!currentUser) && user.approved && (currentUser.uid === user.uid || !!currentUser.isAdmin),\n    currentUser,\n  };\n};\n\nexport default connect(mapStateToProps)(Character);\n","import { ConnectedComponent } from 'react-redux';\n\nimport Chat from '../containers/Chat/index';\nimport Settings from '../containers/Settings';\nimport Logout from '../components/Logout';\nimport Items from '../containers/Items';\nimport Help from '../components/Help';\nimport Inventory from '../containers/Inventory';\nimport Character from '../containers/Character';\n\nexport interface IRoute {\n  path: string;\n  component: ConnectedComponent<any, any> | (() => JSX.Element);\n  exact?: boolean;\n}\n\nconst routes: IRoute[] = [\n  {\n    path: '/text-roleplay/chat',\n    component: Chat,\n  },\n  {\n    path: '/text-roleplay/:uid/settings',\n    component: Settings,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/:uid/inventory',\n    component: Inventory,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/inventory',\n    component: Inventory,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/:uid/character',\n    component: Character,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/character',\n    component: Character,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/settings',\n    component: Settings,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/items',\n    component: Items,\n  },\n  {\n    path: '/text-roleplay/help',\n    component: Help,\n  },\n  {\n    path: '/text-roleplay/logout',\n    component: Logout,\n  },\n];\n\nexport default routes;\n","import React from 'react';\nimport { Card } from 'antd';\n\nexport default () => (\n  <Card className=\"help\">\n    Чат для текстовой ролевой игры. Инвентарь, управление чатом, настройки персонажа, профиля.\n    <br/><br/>\n    <h1>Возможности</h1>\n    <pre>\n      - Новосозданный игрок должен быть подтверждён админом<br/>\n      - Отправлять в чат картинки из буфера обмена (ctrl + v) либо перетаскивая в поле ввода<br/>\n      - Увеличение картинки<br/>\n      - Вставка ссылок<br/>\n      - Вставка YouTube видео (полная ссылка, не youtu.be)<br/>\n      - Броски дайсов<br/>\n      - В одном сообщении может быть не больше 10-ти дайсов\n      - Кол-во дайсов в первой цифре. Не больше 10<br/>\n      - Буква \"д\" или \"d\" вторым символом<br/>\n      - Размер дайса во второй цифре. Только размера 4 6 8 10 12 и 20<br/>\n      - Примеры: 1д10, 2д20, 9d4<br/>\n      - При неправильном дайсе сообщение не будет отправлено<br/>\n      - Дайс можно писать в любом месте сообщения и сколько угодно раз<br/>\n      - При наведении на брошенный дайс можно увидеть полный результат<br/>\n      - Крит попадания и промахи слегка подсвечиваются зеленым и красным соответственно<br/>\n      - РП сообщение, если первым символом написать \"*\"<br/>\n      - Игроки онлайн имеют синюю обводку вокруг аватара<br/>\n      - При наведении на игрока показывается последний онлайн<br/>\n      - При клике на игрока открывается страница настроек<br/>\n      - Админы могут редактировать настройки других игроков<br/>\n      - Настройки имени и аватара<br/>\n      - Настройки применяются сразу после изменения (даже в процессе редактирования)<br/>\n      - Все пользователи видят изменения<br/>\n      - При наведении на время сообщения показывается его дата<br/>\n      - Сообщения от одного автора сгруппированы<br/>\n      - Предметы (создание, удаление, редактирование)<br/>\n      - Только админ может создавать предметы<br/>\n      - Удалять и редактировать можно только предметы созданные тобой же, либо если админ<br/>\n      - Фильтр по типу предмета<br/>\n      - Поиск одновременно по названию, описанию и эффекту предметов<br/>\n      - Вес и стоимость не показываются, если нулевая<br/>\n      - Количество не показывается, если предмет один<br/>\n      - Загрузка больше предметов по нажатию на кнопку (не сортированных)<br/>\n      - Выбор кол-во загружаемых предметов<br/>\n      - В верхнем левом углу дата последнего билда проекта. Появляется только при наведении курсора<br/>\n      - Инвентарь<br/>\n      - Админ может взять в инвентарь предметы из списка<br/>\n      - Предмет из инвентаря может быть показан другим в чате<br/>\n      - Предмет может быть использован, чем будет израсходован (1шт)<br/>\n      - Предмет можно выбросить в чат и любой игрок может его подобрать<br/>\n      - Передача предмета другим игрокам<br/>\n      - Можно зайти в чужой инвентарь без редактирования<br/>\n      - Лист персонажа<br/>\n      - Не активные характеристики персонажа расчитываются сами<br/>\n      - После подтверждения изменений персонажа, чат оповещается об изменениях<br/>\n      - Нельзя сохранить персонажа при отрицательных Очках Навыков<br/>\n      - Если получить сообщение, когда вкладка не активна - в названии появится \"(!)\"<br/>\n      - <br/>\n    </pre>\n\n    <h1>Баги/ошибки</h1>\n    <pre>\n      - <br/>\n    </pre>\n\n    <h1>Исправления</h1>\n    <pre>\n      - Сделать lazy loading для подгрузки проекта только после регистрации<br/>\n      - Lazy loading для каждой основной страницы<br/>\n      - Нужна кнопка быстрого скролла вниз чата<br/>\n      - Загрузка аватара через буфер обмена<br/>\n      - Добавить подтверждение к отправке картинки<br/>\n      - Порезать контейнеры на файлы поменьше<br/>\n      - Отрефакторить ItemCreator на форму<br/>\n      - <br/>\n    </pre>\n\n    <h1>Todo</h1>\n    <pre>\n      - Character page<br/>\n      - Effect cards?<br/>\n      - Local Notes<br/>\n      - Global notes<br/>\n      - Drawing<br/>\n      - <br/>\n    </pre>\n  </Card>\n)\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Form,\n  Input,\n  Button,\n  Card,\n  Alert,\n  Tabs,\n} from 'antd';\n\nimport actions from '../reducers/actions';\nimport { IState } from '../reducers/interfaces';\n\ninterface ILoginProps {\n  loading: boolean;\n  error: Error | false;\n}\n\nconst Login = (props: ILoginProps) => {\n  const { error, loading } = props;\n\n  return (\n    <Card loading={loading}>\n      <Tabs defaultActiveKey=\"1\">\n        <Tabs.TabPane tab=\"Логин\" key=\"1\">\n          <Form\n            onFinish={(values) => actions.login(values)}\n          >\n            <Form.Item\n              label=\"Email\"\n              name=\"email\"\n              rules={[{ required: true, message: 'Введите e-mail!' }]}\n            >\n              <Input/>\n            </Form.Item>\n            <Form.Item\n              label=\"Password\"\n              name=\"password\"\n              rules={[{ required: true, message: 'Введите пароль!' }]}\n            >\n              <Input.Password/>\n            </Form.Item>\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n              >\n                Войти\n              </Button>\n            </Form.Item>\n          </Form>\n        </Tabs.TabPane>\n        <Tabs.TabPane tab=\"Регистрация\" key=\"2\">\n          <Form\n            onFinish={(values) => actions.register(values)}\n          >\n            <Form.Item\n              label=\"Email\"\n              name=\"email\"\n              rules={[{ required: true, message: 'Введите e-mail!' }]}\n            >\n              <Input/>\n            </Form.Item>\n            <Form.Item\n              label=\"Password\"\n              name=\"password\"\n              rules={[{ required: true, message: 'Введите пароль!' }]}\n            >\n              <Input.Password/>\n            </Form.Item>\n            <Form.Item\n              label=\"Confirm Password\"\n              name=\"passwordConfirm\"\n              rules={[{ required: true, message: 'Подтвердите парол!' }]}\n            >\n              <Input.Password/>\n            </Form.Item>\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n              >\n                Зарегистрировать\n              </Button>\n            </Form.Item>\n          </Form>\n        </Tabs.TabPane>\n        <Tabs.TabPane tab=\"Восстановить\" key=\"3\">\n          <Form\n            onFinish={(values) => actions.resetPassword(values)}\n          >\n            <Form.Item\n              label=\"Email\"\n              name=\"email\"\n              rules={[{ required: true, message: 'Введите e-mail!' }]}\n            >\n              <Input/>\n            </Form.Item>\n            <Form.Item>\n              <Button\n                type=\"primary\"\n                htmlType=\"submit\"\n              >\n                Отправить E-mail\n              </Button>\n            </Form.Item>\n          </Form>\n        </Tabs.TabPane>\n      </Tabs>\n      {error && (\n        <Alert\n          type=\"error\"\n          message={error.message}\n        />\n      )}\n    </Card>\n  );\n};\n\nconst mapStateToProps = (state: IState) => {\n  const { loading, error } = state;\n\n  return { loading, error };\n};\n\nexport default connect(mapStateToProps)(Login);\n","import React from 'react';\nimport {\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport routes, { IRoute } from '../configs/routes';\nimport Login from './Login';\nimport { IState } from '../reducers/interfaces';\n\ninterface IRouterProps {\n  isLoggedIn: boolean;\n}\n\nfunction Router(props: IRouterProps) {\n  if (!props.isLoggedIn) {\n    return (\n      <Switch>\n        <Route\n          path=\"*\"\n          component={Login}\n        />\n      </Switch>\n    )\n  }\n\n  return (\n    <Switch>\n      {\n        routes.map((value: IRoute) =>\n          <Route\n            key={value.path}\n            path={value.path}\n            component={value.component}\n            exact={value.exact || false}\n          />\n        )\n      }\n      <Redirect to=\"/text-roleplay/chat\"/>\n    </Switch>\n  );\n}\n\nexport default connect((state: IState) => ({ isLoggedIn: state.isLoggedIn }))(Router);\n","import { isOnline } from \"./utils\";\nimport actions from \"../reducers/actions\";\n\nconst listenForOnline = () => {\n  const callback = () => {\n    if (!isOnline(parseInt(localStorage.getItem('lastActivity') || '0') - 60000))\n      actions.updateLastOnline({});\n  };\n\n  [\n    'mousedown',\n    'mousemove',\n    'keydown',\n    'scroll',\n    'touchstart'\n  ].forEach((eventName) => {\n    document.addEventListener(eventName, callback, true);\n  });\n  callback();\n};\n\nlet blinking = false;\nexport const blinkTitle = () => {\n  if (blinking) return;\n  blinking = true;\n\n  const interval = setInterval(() => {\n    const title = document.head.querySelector('title');\n    if (title) {\n      title.innerText = title.innerText === 'TRP' ? '(!) TRP' : 'TRP';\n\n      if (!blinking || !document.hidden) {\n        title.innerText = 'TRP';\n        clearInterval(interval);\n        blinking = false;\n      }\n    }\n  }, 500);\n};\n\nexport const listenForActivity = () => {\n  listenForOnline();\n};\n","import React, { Component } from 'react';\nimport { BrowserRouter, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { message } from 'antd';\nimport 'antd/dist/antd.css';\n\nimport Menu from './components/Menu';\nimport Router from './components/Router';\n\nimport './App.css';\nimport './styles/antd-dark.scss';\nimport './styles/components.scss';\nimport { listenForActivity } from './helpers/activity';\nimport { IState } from './reducers/interfaces';\nimport actions from \"./reducers/actions\";\n\n// @ts-ignore\nconst buildDate = (<div className=\"build-date\">build date {window.buildDate.replace('_', ' ')}</div>);\n\nclass App extends Component<{ redirect?: string; notify?: string }> {\n  componentDidMount = listenForActivity;\n\n  componentDidUpdate = () => {\n    const { notify, redirect } = this.props;\n\n    if (notify) {\n      message.info(notify);\n      actions.notifySuccess({});\n    }\n    if (redirect) {\n      actions.redirectSuccess({});\n    }\n  };\n\n  getRedirect = () => {\n    const { redirect } = this.props;\n    return redirect && <Redirect to={redirect}/>;\n  };\n\n  render = () => {\n    return (\n      <>\n        {buildDate}\n        <BrowserRouter>\n          {this.getRedirect()}\n          <Menu/>\n          <div className=\"app\">\n            <Router/>\n          </div>\n        </BrowserRouter>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IState) => ({ redirect: state.redirect, notify: state.notify });\nexport default connect(mapStateToProps)(App);\n","import _firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\n\nimport firebaseConfig from '../configs/firebase.json';\nimport actions from '../reducers/actions';\n\nconst firebase = _firebase.initializeApp(firebaseConfig);\nconst auth = firebase.auth();\nauth.languageCode = 'ru';\nconst database = firebase.database();\n\nauth.onAuthStateChanged((user) => {\n  if (user) {\n    actions.loginSuccess({ user });\n    actions.getUser({ uid: user.uid, currentUser: true });\n  } else {\n    actions.logout({});\n  }\n});\n\nexport {\n  auth,\n  database,\n  firebase,\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { auth } from '../helpers/firebase';\nimport actions, { IPayload } from '../reducers/actions';\n\nfunction* login(payload: IPayload) {\n  const { email, password } = payload;\n\n  try {\n    const user = yield auth.signInWithEmailAndPassword(email, password);\n    actions.loginSuccess({ user });\n    localStorage.setItem('user', JSON.stringify(user.user));\n    localStorage.setItem('uid', user.user.uid);\n    return user.user;\n  } catch (error) {\n    actions.loginFail({ error });\n    return false;\n  }\n}\n\nfunction* register(payload: IPayload) {\n  const { email, password, passwordConfirm } = payload;\n\n  if (password !== passwordConfirm) {\n    actions.registerFail({ error: { message: 'Пароли не совпадают!' } });\n    return;\n  }\n\n  try {\n    yield auth.createUserWithEmailAndPassword(email, password);\n    actions.registerSuccess({});\n    const user = yield login(payload);\n    if (user) {\n      actions.sendMessage({ uid: user.uid, message: '*[Новый пользователь зарегистрирован]*' });\n    }\n  } catch (error) {\n    console.error(error);\n    actions.registerFail({ error });\n  }\n}\n\nfunction* resetPassword(payload: IPayload) {\n  const { email } = payload;\n  try {\n    yield auth.sendPasswordResetEmail(email);\n    actions.resetPasswordSuccess({});\n    actions.notify({ message: 'Ссылка отправлена на E-mail!' });\n  } catch(error) {\n    console.error(error);\n    actions.resetPasswordFail({ error });\n  }\n}\n\n\nfunction* logout() {\n  localStorage.removeItem('user');\n  localStorage.removeItem('uid');\n  localStorage.removeItem('loggedIn');\n  yield auth.signOut();\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('LOGIN', login),\n    takeLatest('REGISTER', register),\n    takeLatest('RESET_PASSWORD', resetPassword),\n    takeLatest('LOGOUT', logout),\n  ])\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { database } from '../helpers/firebase';\nimport actions, { IPayload } from '../reducers/actions';\n\nfunction* setUser(payload: IPayload) {\n  const { uid, user } = payload;\n\n  yield database\n    .ref('users')\n    .child(uid)\n    .set({\n      ...user,\n      lastOnline: new Date().getTime(),\n      uid,\n    });\n\n  actions.setUserSuccess({});\n  actions.getUser({ uid });\n}\n\nconst requestedUsers: { [key: string]: true } = {};\n\nfunction getUser(payload: IPayload) {\n  const { uid, currentUser } = payload;\n\n  if (requestedUsers[uid] && !currentUser) return;\n  requestedUsers[uid] = true;\n  database\n    .ref('users')\n    .child(uid)\n    .on('value', (rawUser) => {\n      const user = rawUser.val() || {};\n      actions.getUserSuccess({ user, uid, currentUser });\n    });\n}\n\nfunction* updateLastOnline() {\n  const uid = localStorage.getItem('uid');\n  if (!uid || uid === 'undefined') return;\n  const time = new Date().getTime();\n\n  localStorage.setItem('lastActivity', `${time}`);\n  yield database\n    .ref('users')\n    .child(`${uid}`)\n    .child('lastOnline')\n    .set(time);\n\n  yield database\n    .ref('usersActivity')\n    .child(`${uid}`)\n    .set(time);\n}\n\nfunction* getUsersActivity() {\n  const rawActivity = yield database\n    .ref('usersActivity')\n    .once('value');\n\n  const usersActivity = (rawActivity.val() || {});\n  actions.getUsersActivitySuccess({ usersActivity });\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('GET_USER', getUser),\n    takeLatest('SET_USER', setUser),\n    takeLatest('UPDATE_LAST_ONLINE', updateLastOnline),\n    takeLatest('GET_USERS_ACTIVITY', getUsersActivity),\n  ]);\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { IPayload } from '../reducers/actions';\nimport actions from '../reducers/actions';\nimport { database } from '../helpers/firebase';\nimport { formatMessage } from '../helpers/utils';\nimport { blinkTitle } from '../helpers/activity';\n\nfunction* sendMessage(payload: IPayload) {\n  const { uid, message, data = {} } = payload;\n  const time = new Date().getTime();\n\n  const newMessage = formatMessage({\n    time,\n    author: uid,\n    body: `${message} `,\n    data,\n  });\n\n  try {\n    yield database\n      .ref('messages')\n      .child(`${time}`)\n      .set(newMessage);\n    localStorage.setItem('message', '');\n    actions.sendMessageSuccess({ message: newMessage });\n  } catch (e) {\n    actions.sendMessageFail({});\n    console.error(e);\n    actions.notify({ message: 'Сообщение не было отправлено. Для деталей ctrl + shift + i, вкладка Console' });\n  }\n}\n\nfunction subscribe() {\n  database\n    .ref('messages')\n    .orderByKey()\n    .limitToLast(1)\n    .on('value', (rawMessages) => {\n      const messages = Object.values(rawMessages.val() || {});\n      actions.getMessagesSuccess({\n        messages,\n        concat: true\n      });\n\n      blinkTitle();\n    });\n}\n\nfunction unsubscribe() {\n  database.ref('messages').off();\n}\n\nfunction* getMessages() {\n  const rawMessages = yield database\n    .ref('messages')\n    .orderByKey()\n    .limitToLast(100)\n    .once('value');\n\n  const messages = Object.values(rawMessages.val() || {});\n  actions.getMessagesSuccess({ messages });\n}\n\nfunction* getMoreMessages(payload: IPayload) {\n  const { firstMessage } = payload;\n\n  const rawMessages = yield database\n    .ref('messages')\n    .orderByKey()\n    .endAt(`${firstMessage.time}`)\n    .limitToLast(30)\n    .once('value');\n\n  const messages = Object.values(rawMessages.val() || {});\n  actions.getMessagesSuccess({ messages, concat: true });\n}\n\nfunction uploadFile(payload: IPayload) {\n  const { file, uid } = payload;\n\n  const request = new XMLHttpRequest();\n  const formData = new FormData();\n\n  formData.append('image', file);\n\n  request.open('POST', 'https://api.imgur.com/3/image/');\n  request.setRequestHeader('Authorization', `Client-ID ea2c833b74d4583`);\n  request.onreadystatechange = () => {\n    if (request.status === 200 && request.readyState === 4) {\n      let res = JSON.parse(request.responseText);\n\n      actions.sendMessage({\n        uid,\n        message: res.data.link,\n      });\n      actions.notify({ message: 'Файл успешно загружен!' });\n    }\n  };\n\n  request.send(formData);\n}\n\nexport function* changeMessage(payload: IPayload) {\n  const { message } = payload;\n\n  const newMessage = formatMessage({\n    time: message.time,\n    author: message.author,\n    body: message.body,\n    data: message.data,\n  });\n\n  yield database\n    .ref('messages')\n    .child(`${message.time}`)\n    .set(newMessage);\n\n  actions.changeMessageSuccess({ message: newMessage });\n  return newMessage;\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('SEND_MESSAGE', sendMessage),\n    takeLatest('GET_MESSAGES', getMessages),\n    takeLatest('GET_MORE_MESSAGES', getMoreMessages),\n    takeLatest('SUBSCRIBE', subscribe),\n    takeLatest('UNSUBSCRIBE', unsubscribe),\n    takeLatest('UPLOAD_FILE', uploadFile),\n    takeLatest('CHANGE_MESSAGE', changeMessage),\n  ]);\n}\n","import { all, takeLatest, takeEvery } from 'redux-saga/effects';\n\nimport { IPayload } from '../reducers/actions';\nimport actions from '../reducers/actions';\nimport { database } from '../helpers/firebase';\nimport { generateID, getFailedItem } from '../helpers/utils';\nimport { IInventoryItem, IMessage, IUser } from \"../reducers/interfaces\";\nimport { getRandomInt } from '../helpers/dice';\n\nfunction* setItem(payload: IPayload) {\n  const { item } = payload;\n  const time = new Date().getTime();\n  const id = item.id || generateID();\n  const author = localStorage.getItem('uid');\n\n  const itemData = {\n    ...item,\n    id,\n    time,\n    author,\n  };\n\n  yield database\n    .ref('items')\n    .child(`${id}`)\n    .set(itemData);\n\n  actions.setItemSuccess({ itemData });\n  actions.getItemById({ id });\n}\n\nfunction* getItems() {\n  const rawItems = yield database\n    .ref('items')\n    .orderByKey()\n    .limitToFirst(30)\n    .once('value');\n\n  const items = Object.values(rawItems.val() || {});\n  actions.getItemsSuccess({ items });\n}\n\nfunction* getItemById(payload: IPayload) {\n  const { id } = payload;\n\n  const rawItem = yield database\n    .ref('items')\n    .child(id)\n    .once('value');\n\n  const item = rawItem.val() || getFailedItem(id);\n  actions.getItemsSuccess({ items: [item] });\n  return true;\n}\n\nfunction* getMoreItems(payload: IPayload) {\n  const { amount = 1, lastItem } = payload;\n\n  const rawItems = yield database\n    .ref('items')\n    .orderByKey()\n    .startAt(`${lastItem.id}`)\n    .limitToFirst(amount + 1)\n    .once('value');\n\n  const a = rawItems.val();\n  const items = Object.values(a || {}).splice(1);\n  actions.getItemsSuccess({ items });\n}\n\nfunction* deleteItem(payload: IPayload) {\n  const { id } = payload;\n\n  // Delete items from items list\n  yield database.ref(`items/${id}`).set({});\n  actions.deleteItemProgress({ field: 'deleted', value: true });\n  let waitCounter = 0;\n  const getWait = () => {\n    waitCounter += getRandomInt(10, 500);\n    return waitCounter;\n  };\n\n  // Delete item from all messages\n  const messages: IMessage[] = Object.values((yield database.ref(`messages`).once('value')).val() || {});\n  let clearedMessages = 0;\n\n  async function checkMessages(index: number) {\n    const message: IMessage = messages[index];\n    if (!message) return;\n    const randomWait = getWait();\n\n    setTimeout(() => actions.deleteItemProgress({\n      field: 'messagesChecked',\n      value: index + 1\n    }), randomWait);\n    if (message.data && message.data.itemId && message.data.itemId === id) {\n      await database.ref(`messages/${message.time}/data`).set({});\n      setTimeout(() => actions.deleteItemProgress({\n        field: 'messagesCleared',\n        value: ++clearedMessages\n      }), randomWait);\n    }\n    await checkMessages(index + 1);\n  }\n\n  yield checkMessages(0);\n\n  // Delete item from all users\n  const users: IUser[] = Object.values((yield database.ref(`users`).once('value')).val() || {});\n  let clearedUsers = 0;\n\n  async function checkUsers(index: number) {\n    const user: IUser = users[index];\n    if (!user) return;\n    const randomWait = getWait();\n\n    setTimeout(() => actions.deleteItemProgress({\n      field: 'usersChecked',\n      value: index + 1\n    }), randomWait);\n    if (user.inventory) {\n      const item = Object.values(user.inventory).find((item: IInventoryItem) => item.id === id);\n      if (item) {\n        await database.ref(`users/${user.uid}/inventory/${id}|${item.time}`).set({});\n        setTimeout(() => actions.deleteItemProgress({\n          field: 'usersCleared',\n          value: ++clearedUsers\n        }), randomWait);\n      }\n    }\n    await checkUsers(index + 1);\n  }\n\n  yield checkUsers(0);\n\n  setTimeout(\n    () => actions.deleteItemProgress({ field: 'done', value: true }),\n    getWait()\n  );\n  actions.deleteItemSuccess({ id });\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('DELETE_ITEM', deleteItem),\n    takeLatest('SET_ITEM', setItem),\n    takeLatest('GET_ITEMS', getItems),\n    takeLatest('GET_MORE_ITEMS', getMoreItems),\n    takeEvery('GET_ITEM_BY_ID', getItemById),\n  ]);\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { IInventoryItem } from '../reducers/interfaces';\nimport { database } from '../helpers/firebase';\nimport { IPayload } from '../reducers/actions';\nimport actions from '../reducers/actions';\nimport { changeMessage } from './messages';\nimport { getItemName } from \"../helpers/utils\";\n\nfunction* passItem(payload: IPayload) {\n  const { id, uid, demonstrate, use, item, to } = payload;\n\n  if (id && uid && item) {\n    const name = getItemName(item);\n    if (demonstrate) {\n      actions.sendMessage({\n        uid,\n        message: `*показывает ${name}`,\n        data: { itemId: id, amount: item.amount },\n      });\n      actions.passItemSuccess({});\n      actions.notify({ message: `Вы показали ${name}`});\n      actions.redirect({ to: '/text-roleplay/chat' });\n      return true;\n    }\n\n    const removed = yield removeItem({ id, uid, amount: item.amount });\n    if (!removed) {\n      console.error(`passItem error:`, payload);\n      actions.passItemFail({ id, uid });\n      return false;\n    }\n\n    if (use) {\n      const name = getItemName(item, false);\n      actions.sendMessage({\n        uid,\n        message: `*использовал ${name}`,\n        data: { itemId: id },\n      });\n      actions.notify({ message: `Вы использовали ${name}` });\n      actions.redirect({ to: '/text-roleplay/chat' });\n      actions.passItemSuccess({});\n      return true;\n    }\n\n    if (to) {\n      actions.giveItem({ uid: to.uid, id, itemType: item.type, amount: item.amount });\n      actions.notify({ message: `Вы передали ${item.name} игроку '${to.nickname}'` });\n      actions.passItemSuccess({});\n      return;\n    }\n\n    actions.sendMessage({\n      uid,\n      message: `*выбросил ${name}`,\n      data: { itemId: id, amount: item.amount, type: item.type },\n    });\n    actions.notify({ message: `Вы выбросили ${name}` });\n    actions.redirect({ to: '/text-roleplay/chat' });\n    actions.passItemSuccess({});\n    return true;\n  }\n\n  actions.passItemFail({ id, uid });\n  console.error(`passItem error: id, uid, or item are not defined`, payload);\n  return false;\n}\n\nfunction* removeItem(payload: IPayload) {\n  const { id, uid, amount = 1 } = payload;\n  const ref = database\n    .ref(`users`)\n    .child(uid)\n    .child('inventory');\n\n  const sameItem = yield getInventoryItem({ id, uid });\n  if (sameItem) {\n    if (sameItem.amount - amount >= 1) {\n      const item = {\n        ...sameItem,\n        amount: sameItem.amount - amount,\n      };\n\n      yield ref.child(`${id}|${sameItem.time}`).set(item);\n      actions.removeItemSuccess({ id, uid });\n      return true;\n    }\n\n    yield ref.child(`${id}|${sameItem.time}`).set({});\n    actions.removeItemSuccess({ id, uid });\n    return true;\n  }\n\n  console.error(`removeItem error: User '${uid}' doesn't have item '${id}'`);\n  actions.notify({ message: `Предмета нет в инвентаре` });\n  actions.removeItemFail({ id, uid, error: 'has-no-item' });\n  return false;\n}\n\nfunction* getInventoryItem(payload: IPayload) {\n  const { id, uid } = payload;\n\n  const rawItems = yield database\n    .ref('users')\n    .child(uid)\n    .child('inventory')\n    .once('value');\n  const items: IInventoryItem[] = Object.values(rawItems.val() || {});\n  if (items.length) {\n    const item: IInventoryItem | undefined = items.find(item => item.id === id);\n    if (item)\n      return item;\n  }\n  return;\n}\n\nfunction* giveItem(payload: IPayload) {\n  const { id, uid, itemType, amount = 1 } = payload;\n  if (!id || !uid || !itemType) {\n    console.error('giveItem error. One of the properties are not defined', id, uid, itemType);\n    actions.giveItemFail({});\n    return;\n  }\n\n  const time = new Date().getTime();\n  let item: IInventoryItem = { id, time, type: itemType, amount: amount };\n\n  if (itemType !== 'weapon' && itemType !== 'wearable') {\n    const sameItem = yield getInventoryItem({ id, uid });\n    if (sameItem) {\n      item.amount = (sameItem.amount || 1) + amount;\n      item.time = sameItem.time;\n    }\n  }\n\n  const fullId = `${item.id}|${item.time}`;\n  yield database\n    .ref('users')\n    .child(uid)\n    .child('inventory')\n    .child(fullId)\n    .set(item);\n\n  actions.giveItemSuccess({ id, uid });\n  return true;\n}\n\nfunction* takeItem(payload: IPayload) {\n  const { uid, message } = payload;\n  const { itemId, amount, type } = message.data;\n\n  message.data.taken = true;\n\n  const took = yield changeMessage({ uid, message });\n  if (took && type) {\n    const item = yield giveItem({\n      id: itemId,\n      uid,\n      amount: amount || 1,\n      itemType: type,\n    });\n    if (item) {\n      actions.sendMessage({\n        uid,\n        message: `*подобрал предмет`,\n      });\n      actions.takeItemSuccess({});\n      return true;\n    }\n  }\n\n  console.error('takeItem error. Cant take or no item', payload);\n  actions.takeItemFail({});\n  return false;\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('GIVE_ITEM', giveItem),\n    takeLatest('REMOVE_ITEM', removeItem),\n    takeLatest('PASS_ITEM', passItem),\n    takeLatest('TAKE_ITEM', takeItem),\n  ]);\n}\n","import { all } from 'redux-saga/effects';\n\nimport auth from './auth';\nimport users from './users';\nimport messages from './messages';\nimport items from './items';\nimport inventory from './inventory';\n\nexport default function* watchAll() {\n  yield all([\n    auth(),\n    users(),\n    messages(),\n    items(),\n    inventory(),\n  ])\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './index.css';\nimport App from './App';\nimport saga from './sagas/index';\nimport store, { sagaMiddleware } from './helpers/store';\nimport * as serviceWorker from './serviceWorker';\n\nsagaMiddleware.run(saga);\nReactDOM.render(\n  <Provider store={store}>\n    <App/>\n  </Provider>,\n  document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}