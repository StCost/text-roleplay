(this["webpackJsonptext-roleplay"]=this["webpackJsonptext-roleplay"]||[]).push([[13,42],{155:function(a,e,t){"use strict";t.r(e);var c=t(3),n=t(20),r=t(48),s=t(50),l=t(49),i=t(0),m=t.n(i),h=t(26),o=t(33),u=t(447),d=t(147),p=t(72),v=t(516),g=t(100),f=t(482),E=t(35),b=t(445),N=t(63),C=t(517),O=t(631),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888.3 757.4h-53.8c-4.2 0-7.7 3.5-7.7 7.7v61.8H197.1V197.1h629.8v61.8c0 4.2 3.5 7.7 7.7 7.7h53.8c4.2 0 7.7-3.4 7.7-7.7V158.7c0-17-13.7-30.7-30.7-30.7H158.7c-17 0-30.7 13.7-30.7 30.7v706.6c0 17 13.7 30.7 30.7 30.7h706.6c17 0 30.7-13.7 30.7-30.7V765.1c0-4.3-3.5-7.7-7.7-7.7zm18.6-251.7L765 393.7c-5.3-4.2-13-.4-13 6.3v76H438c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"export",theme:"outlined"},k=t(16),x=function(a,e){return i.createElement(k.a,Object.assign({},a,{ref:e,icon:j}))};x.displayName="ExportOutlined";var y=i.forwardRef(x),S=t(632),T=t(458),H=(t(467),t(28)),w=t(4),M=t(23),R=function(a){Object(s.a)(t,a);var e=Object(l.a)(t);function t(){var a;Object(r.a)(this,t);for(var s=arguments.length,l=new Array(s),i=0;i<s;i++)l[i]=arguments[i];return(a=e.call.apply(e,[this].concat(l))).state={character:H.initialCharacter,update:!1},a.componentDidMount=function(){var e=a.props,t=e.character,c=e.uid,n=e.user,r=e.currentUser,s=e.history;t?a.setState({character:t}):w.default.getCharacter({uid:c}),n||w.default.getUser({uid:c}),Object(M.redirectToUserPage)(n,r,s)},a.componentDidUpdate=function(e){var t=a.props,c=t.character,n=t.user,r=t.currentUser,s=t.history;e.character!==c&&a.setState({character:c}),Object(M.redirectToUserPage)(n,r,s)},a.getSpecial=function(e){var t=a.props.hasRight,c=e.special;return c&&m.a.createElement(u.a,{className:"char-special"},m.a.createElement("div",{className:"char-special-item"},m.a.createElement("span",{className:"char-special-label"}),m.a.createElement("div",{className:"char-special-input total"},"Total"),m.a.createElement("div",{className:"char-special-input"},"+/-"),m.a.createElement("div",{className:"char-special-input"},"Base")),H.special.map((function(e){var n=e.label,r=e.full,s=e.field;return m.a.createElement("div",{key:n,className:"char-special-item"},m.a.createElement(d.a,{title:r},m.a.createElement("span",{className:"char-special-label"},n)),m.a.createElement(p.a,{className:"char-special-input total",readOnly:!0,min:0,max:9,disabled:!t,value:c[s].total}),m.a.createElement(v.a,{className:"char-special-input",min:0,max:9,disabled:!t,value:c[s].change,onChange:a.onChange(["special",s,"change"])}),m.a.createElement(v.a,{className:"char-special-input",min:0,max:9,disabled:!t,value:c[s].base,onChange:a.onChange(["special",s,"base"])}))})))},a.onGiftSelect=function(e){return function(){var t=a.props.hasRight,r=a.state.character;if(t){var s=Object(n.a)(r.gifts),l=s.indexOf(e);if(l>-1)s.splice(l,1);else{if(!(s.length<=2))return;s.push(e)}a.setState({character:Object(c.a)(Object(c.a)(Object(c.a)({},r),Object(M.processCharacterChanges)({},Object(c.a)(Object(c.a)({},r),{},{gifts:s}))),{},{gifts:s})})}}},a.getSkills=function(e){var t=a.props.hasRight,c=e.skills,n=e.gifts;return c&&m.a.createElement(u.a,{className:"char-skills"},m.a.createElement("div",{className:"char-skills-item"},m.a.createElement("span",{className:"char-skills-label"}),m.a.createElement("div",{className:"char-skills-input total"},"Total"),m.a.createElement("div",{className:"char-skills-input"},"+/-"),m.a.createElement("div",{className:"char-skills-input"},"Base")),H.skills.map((function(e){var r=e.label,s=e.full,l=e.formula,i=e.field;return m.a.createElement("div",{key:i,className:"char-skills-item"},m.a.createElement(d.a,{title:s,placement:"left"},m.a.createElement("span",{className:"char-skills-label ".concat(n.indexOf(i)>-1?"gift":""),onClick:a.onGiftSelect(i)},r)),m.a.createElement(p.a,{className:"char-skills-input",readOnly:!0,disabled:!t,value:c[i].total}),m.a.createElement(v.a,{className:"char-skills-input",disabled:!t,min:0,max:95,value:c[i].change,onChange:a.onChange(["skills",i,"change"])}),m.a.createElement(d.a,{title:l},m.a.createElement(p.a,{className:"char-skills-input",readOnly:!0,disabled:!t,value:c[i].base,onChange:a.onChange(["skills",i,"base"])})))})))},a.getStats=function(e){var t=a.props.hasRight,c=e.stats;return c&&m.a.createElement(u.a,{className:"char-stats"},H.stats.map((function(e){var n=e.label,r=e.full,s=e.field,l=e.getBase;return m.a.createElement("div",{key:s,className:"char-stats-item"},m.a.createElement(d.a,{title:r},m.a.createElement("span",{className:"char-stats-label"},n)),"wounds"===s?m.a.createElement(p.a.TextArea,{className:"char-stats-input",disabled:!t,value:c[s],onChange:a.onChange(["stats",s])}):l?m.a.createElement(p.a,{className:"char-stats-input",readOnly:!0,disabled:!t,value:c[s]}):m.a.createElement(v.a,{className:"char-stats-input",min:0,disabled:!t,value:c[s],onChange:a.onChange(["stats",s])}))})))},a.componentWillUnmount=function(){return a.onSave(!0)},a.getMainStats=function(e){var t=a.props.hasRight,c=e.stats;return c&&m.a.createElement(u.a,{className:"char-main-stats"},m.a.createElement("div",{className:"char-main-stats-health"},m.a.createElement("div",{className:"char-main-stats-hp"},m.a.createElement("span",{className:"char-main-stats-hp-label"},"\u041e\u0447\u043a\u0438 \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u044f (\u041e\u0417)"),m.a.createElement("div",{className:"char-main-stats-hp-body"},m.a.createElement(v.a,{max:c.maxHealthPoints||1e3,min:-Math.floor(c.maxHealthPoints/2),disabled:!t,value:c.healthPoints,onChange:a.onChange("stats.healthPoints")}),"/",m.a.createElement(p.a,{value:c.maxHealthPoints,readOnly:!0,disabled:!t}))),m.a.createElement("div",{className:"char-main-stats-ap-wrapper"},m.a.createElement("div",{className:"char-main-stats-ap"},m.a.createElement(d.a,{title:"\u041a\u043b\u0430\u0441\u0441 \u0411\u0440\u043e\u043d\u0438 (\u041a\u0411)"},m.a.createElement("div",{className:"char-main-stats-ap-total"},"\u041a\u0411")),m.a.createElement("div",{className:"char-main-stats-ap-change"},"+/-"),m.a.createElement("div",{className:"char-main-stats-ap-base"},"Base")),m.a.createElement("div",{className:"char-main-stats-ap"},m.a.createElement(p.a,{className:"char-main-stats-ap-total",min:0,max:95,readOnly:!0,disabled:!t,value:Math.min(95,c.armorClass.total)}),m.a.createElement(v.a,{className:"char-main-stats-ap-change",min:1,max:95,disabled:!t,value:c.armorClass.change,onChange:a.onChange("stats.armorClass.change")}),m.a.createElement(p.a,{className:"char-main-stats-ap-base",readOnly:!0,disabled:!t,value:c.armorClass.base})))),m.a.createElement("div",{className:"char-main-stats-info"},H.subStats.slice(3).map((function(a){var e=a.label,n=a.full,r=a.field;return m.a.createElement("div",{key:r,className:"char-main-stats-item"},m.a.createElement(d.a,{title:n},m.a.createElement("span",{className:"char-main-stats-item-label"},e)),m.a.createElement(p.a,{className:"char-main-stats-item-input",readOnly:!0,disabled:!t,value:c[r]}))}))))},a.onChange=function(e){return function(t){if(void 0!==t&&("number"===typeof t||t.target)){var n="number"===typeof t?t:t.target.value||"",r="number"===typeof n?Math.min(464999,n):n||"",s=Object(M.set)(a.state.character,e,r),l=Object(M.processCharacterChanges)({},s);a.setState({character:Object(c.a)(Object(c.a)({},a.state.character),l)})}}},a.onSave=function(e){var t=a.props,c=t.uid,n=t.character,r=a.state.character;if(n){var s=Object(M.getCharacterChanges)(H.initialCharacter,r);0!==s.length&&0!==(s=Object(M.getCharacterChanges)(n,r)).length?r.stats.skillPoints<0?e||g.a.error("\u041e\u0447\u043a\u0438 \u041d\u0430\u0432\u044b\u043a\u043e\u0432 (\u041e\u041d) \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c\u0438!"):(g.a.success("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d"),w.default.setCharacter({uid:c,character:r}),w.default.sendMessage({uid:c,message:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b",data:{characterChanges:s}})):e||g.a.error("\u0412 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u043e\u0441\u044c")}else e||g.a.error("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d!")},a.changeBio=function(e){return a.setState({character:Object(c.a)(Object(c.a)({},a.state.character),{},{bio:e.currentTarget.value})})},a.downloadCharacter=function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a.props.character)),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download","character_".concat(Date.now(),".json")),t.click(),t.remove(),g.a.success("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043a\u0430\u0447\u0430\u043d!")},a.getControls=function(){return m.a.createElement("div",{className:"char-controls"},m.a.createElement(f.a,{title:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0432\u0441\u0435 \u0441\u0432\u043e\u0438 \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438? \u0421\u0431\u0440\u043e\u0441 \u0431\u0443\u0434\u0435\u0442 \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d \u043f\u043e\u0441\u043b\u0435 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f",okText:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",onConfirm:function(){a.setState({character:Object(c.a)({},H.initialCharacter)}),g.a.success("\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u0431\u0440\u043e\u0448\u0435\u043d\u043e!")}},m.a.createElement(E.a,null,m.a.createElement(C.a,null),"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c")),m.a.createElement(f.a,{title:"\u041e\u0442\u043a\u0430\u0442\u0438\u0442\u044c \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d\u043d\u044b\u0435 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f?",okText:"\u041e\u0442\u043a\u0430\u0442\u0438\u0442\u044c",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",onConfirm:function(){a.setState({character:Object(c.a)({},a.props.character)}),g.a.success("\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043a\u0430\u0447\u0435\u043d\u043e!")}},m.a.createElement(E.a,null,m.a.createElement(O.a,null),"\u041e\u0442\u043a\u0430\u0442\u0438\u0442\u044c")),m.a.createElement(f.a,{title:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430?",okText:"\u0414\u0430",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",onConfirm:a.downloadCharacter},m.a.createElement(E.a,null,m.a.createElement(y,null),"\u042d\u043a\u0441\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c")),m.a.createElement(f.a,{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f?",okText:"\u0414\u0430",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",onConfirm:function(){return a.onSave()}},m.a.createElement(E.a,null,m.a.createElement(S.a,null),"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")))},a.getTitle=function(a){return m.a.createElement(m.a.Fragment,null,m.a.createElement(T.a,null)," ","\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u0438\u0433\u0440\u043e\u043a\u0430 ",a.nickname||a.uid)},a.render=function(){var e=a.props,t=e.user,c=e.hasRight,n=e.character,r=e.loading,s=a.state.character;return t&&n&&s!==H.initialCharacter&&!r?(console.log(c),m.a.createElement(u.a,{className:"char",title:a.getTitle(t),extra:c&&a.getControls()},m.a.createElement("div",{className:"char-bio"},m.a.createElement(p.a.TextArea,{disabled:!c,minLength:3,value:s.bio,onChange:a.changeBio})),m.a.createElement("div",null,a.getMainStats(s)),m.a.createElement("div",null,m.a.createElement("div",null,a.getSpecial(s),a.getStats(s)),m.a.createElement("div",null,a.getSkills(s))))):m.a.createElement(b.a,{spinning:r},m.a.createElement(N.a,{description:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d"}))},a}return t}(i.Component);e.default=Object(h.g)(Object(o.b)((function(a,e){var t=Object(M.getStateUser)(a,e),n=t.user,r=t.currentUser,s=t.character,l=!!n&&!!r&&r.approved&&(r.uid===n.uid&&s&&!s.static||r.isAdmin);return Object(c.a)(Object(c.a)({},t),{},{hasRight:l})}))(R))},467:function(a,e,t){},517:function(a,e,t){"use strict";var c=t(0),n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},r=t(16),s=function(a,e){return c.createElement(r.a,Object.assign({},a,{ref:e,icon:n}))};s.displayName="ClearOutlined";e.a=c.forwardRef(s)}}]);
//# sourceMappingURL=13.bf0d8978.chunk.js.map