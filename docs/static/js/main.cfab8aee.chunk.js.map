{"version":3,"sources":["components/Menu.tsx","helpers/dice.tsx","helpers/utils.tsx","reducers/interfaces.ts","reducers/index.ts","helpers/store.tsx","reducers/actions.ts","components/Avatar.tsx","components/Image.tsx","components/Item.tsx","components/ItemById.tsx","containers/Chat/MessageBody.tsx","containers/Chat/Message.tsx","containers/Chat/index.tsx","components/Loader/LoadIcon.tsx","components/Loader/CheckIcon.tsx","components/Loader/index.tsx","containers/Settings/index.tsx","components/Logout.tsx","containers/Items/ItemCreator.tsx","containers/ItemsTable/ItemsList.tsx","containers/ItemsTable/index.tsx","components/AmountModal.tsx","containers/Items/index.tsx","components/ActiveUsersList.tsx","containers/Inventory/index.tsx","containers/Character/config.ts","containers/Character/index.tsx","configs/routes.tsx","components/Help.tsx","components/Login.tsx","components/Router.tsx","App.tsx","helpers/firebase.tsx","sagas/auth.ts","sagas/users.ts","sagas/messages.ts","sagas/items.ts","sagas/inventory.ts","sagas/index.ts","serviceWorker.ts","index.tsx"],"names":["connect","state","isLoggedIn","withRouter","props","Fragment","mode","window","innerWidth","selectedKeys","location","pathname","split","pop","menu","map","value","Item","key","path","disabled","link","href","target","rel","to","label","diceRegex","diceRegexG","getRandomInt","min","max","Math","floor","random","exportRolls","str","rolls","match","roll","_amount","_size","amount","parseInt","size","results","Array","fill","rollDice","maxResult","minResult","sum","reduce","a","b","splice","colorFromString","hash","i","length","charCodeAt","color","toString","substr","isOnline","time","localStorage","getItem","Date","getTime","doubleDigit","date","getHours","getMinutes","getSeconds","join","getDate","getMonth","getFullYear","getFullTime","listenForActivity","callback","actions","updateLastOnline","forEach","eventName","document","addEventListener","isURL","test","processMessages","messages","filter","item","pos","self","findIndex","_i","sort","m","index","author","grouped","formatMessage","message","body","indexOf","isRP","mentioned","validateMessage","notify","error","some","getFailedItem","id","type","name","weight","effect","image","description","price","capacity","armor","approved","failed","Number","MAX_VALUE","getItemName","showAmount","defaultItem","defaultDeletedItemData","itemId","deleted","messagesChecked","messagesCleared","usersChecked","usersCleared","done","user","JSON","parse","setItem","uid","initialState","userData","settings","loading","users","currentUser","items","usersActivity","deletingItemData","defaultUser","lastOnline","nickname","avatar","isAdmin","inventory","reducer","action","concat","Object","values","undefined","redirect","field","sagaMiddleware","createSagaMiddleware","store","createStore","reducers","composeWithDevTools","applyMiddleware","dispatch","createAction","payload","createAsyncAction","typeName","toLowerCase","replace","toUpperCase","deleteItemProgress","logout","Avatar","style","rest","_avatar","src","backgroundColor","Image","visible","toggleModal","setState","this","onClick","alt","className","title","CloseOutlined","closable","footer","onCancel","width","maxWidth","Component","getStats","labels","wearable","weapon","getFooter","removeItem","all","DeleteOutlined","render","stats","shape","find","itemProps","getItemById","MessageBody","data","taken","trim","onConfirm","takeItem","okText","cancelText","UploadOutlined","searchParams","URL","params","videoId","get","regExMatch","lastMatch","getVideoId","listId","height","frameBorder","allow","allowFullScreen","_body","_rolls","word","rollIndex","summing","importRolls","Message","placement","extra","Chat","sending","componentDidMount","getMessages","subscribe","componentWillUnmount","unsubscribe","componentDidUpdate","prevProps","getUser","onChangeMessage","event","onKeyDown","shiftKey","preventDefault","onSendMessage","currentTarget","selectionStart","sendMessage","getMoreMessages","firstMessage","onScroll","scrollTop","uploadFile","file","onPaste","e","clipboardData","files","onDrop","dataTransfer","getAsFile","spinning","TextArea","placeholder","autoSize","minRows","maxRows","onChange","SendOutlined","viewBox","focusable","data-icon","aria-hidden","d","Loader","LoadIcon","CheckIcon","Settings","rawOnChange","newSettings","setSettings","setUser","clearAvatar","getField","hasRight","display","readOnly","icon","ClearOutlined","danger","margin","checked","defaultValue","bordered","keys","React","URLSearchParams","Logout","ItemCreator","types","clearImage","fields","Option","precision","step","onSubmit","newItem","content","onClose","centered","ItemsList","controls","controlButtons","condition","Boolean","overlay","trigger","InsertRowBelowOutlined","ItemsTable","defaultState","searchString","showApproved","showNotApproved","filters","getFilters","getButton","tabIndex","console","log","Group","flexDirection","getPageControls","getHeader","getContent","getTitle","_searchString","AmountModal","inputProps","useState","setAmount","onInnerChange","dots","amountModal","modalProps","enough","Modal","confirm","onOk","close","maskClosable","Items","creatingItem","editingItem","itemsToLoad","getItems","toggleCreatingItem","allowClear","FilterOutlined","cardControls","giveItem","itemType","toggleEditingItem","deleteModal","onCreateItem","getCreators","deleteItem","getDeletingModal","getMoreItems","lastItem","ActiveUsersList","getUsersActivity","activeUsers","validUsers","Inventory","passItem","getPassModal","getInventoryItems","inventoryItems","loadedItems","notLoadedItems","inventoryItem","push","shift","getDeleteModalContent","success","demonstrate","use","initialCharacteristic","change","base","total","initialCharacter","special","strength","perception","endurance","charisma","intelligence","agility","luck","skills","smallGuns","bigGuns","energyGuns","unarmed","meleeWeapons","medicine","sneak","lockpick","steal","traps","science","repair","speech","barter","survival","level","hpPerLevel","exp","carryWeight","wounds","maxHealthPoints","healthPoints","armorClass","healingRate","resistance","actionPoints","sequence","meleeDamage","criticalChance","skillPoints","spentSkillPoints","bio","full","formula","getBase","s","ag","st","pe","en","in","ch","_","sqrt","subStats","ceil","lk","Character","char","getSpecial","configSpecial","getSkills","disableChange","configSkills","configStats","MAX_SAFE_INTEGER","getMainStats","configSubStats","slice","processChar","specialTotal","initialValues","character","onValuesChange","minLength","routes","component","exact","onFinish","login","rules","required","Password","htmlType","Login","buildDate","App","info","notifySuccess","redirectSuccess","getRedirect","firebase","_firebase","initializeApp","firebaseConfig","auth","database","onAuthStateChanged","loginSuccess","watchForActions","email","password","signInWithEmailAndPassword","stringify","code","createUserWithEmailAndPassword","loginFail","signOut","takeLatest","ref","child","set","setUserSuccess","requestedUsers","on","rawUser","val","getUserSuccess","once","rawActivity","getUsersActivitySuccess","changeMessage","newMessage","sendMessageSuccess","sendMessageFail","orderByKey","limitToLast","rawMessages","getMessagesSuccess","off","endAt","request","XMLHttpRequest","formData","FormData","append","open","setRequestHeader","onreadystatechange","status","readyState","res","responseText","send","changeMessageSuccess","itemData","setItemSuccess","limitToFirst","rawItems","getItemsSuccess","rawItem","startAt","checkMessages","checkUsers","randomWait","getWait","setTimeout","clearedUsers","clearedMessages","waitCounter","deleteItemSuccess","takeEvery","getInventoryItem","passItemSuccess","passItemFail","sameItem","removeItemSuccess","removeItemFail","giveItemFail","fullId","giveItemSuccess","takeItemSuccess","takeItemFail","watchAll","hostname","run","saga","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"m8CA6DeA,mBAAQ,SAACC,GAAD,MAAoB,CAAEC,WAAYD,EAAMC,cAAhDF,CAA+DG,aA1C9E,SAAcC,GACZ,IAAKA,EAAMF,WACT,OAAO,kBAAC,IAAMG,SAAP,MAGT,IAAMC,EAAOC,OAAOC,WAAa,IAC7B,aACA,SAEJ,OACE,kBAAC,IAAD,CACEF,KAAMA,EACNG,aAAc,CAACL,EAAMM,SAASC,SAASC,MAAM,KAAKC,OAAS,KAE1DC,EAAKC,KAAI,SAACC,GAAD,OACR,kBAAC,IAASC,KAAV,CACEC,IAAKF,EAAMG,KAAKP,MAAM,KAAKC,MAC3BO,SAAUJ,EAAMG,OAASf,EAAMM,SAASC,UAGtCK,EAAMK,KAGF,uBACEC,KAAMN,EAAMG,KACZI,OAAO,SACPC,IAAI,uBAHN,wCAQA,kBAAC,IAAD,CAAMC,GAAIT,EAAMG,MACbH,EAAMU,gB,qGCtCZC,EAAY,gDACZC,EAAa,iDAEbC,EAAe,SAACC,EAAaC,GAAd,OAC1BC,KAAKC,MAAMD,KAAKE,UAAaH,EAAM,EAAKD,GAAOA,IASpCK,EAAc,SAACC,GAC1B,IAAMC,EAAQD,EAAIE,MAAMV,GACxB,OAAIS,EACKA,EAAMtB,KAAI,SAACwB,GAAyB,IAAD,EACfA,EAAK3B,MAAM,aADI,mBACjC4B,EADiC,KACxBC,EADwB,KAElCC,EAASC,SAASH,GAClBI,EAAOD,SAASF,GAChBI,EAXY,SAACH,EAAgBE,GACvC,OAAO,IAAIE,MAAMJ,GAAQK,KAAKL,EAASE,GAAM7B,KAAI,kBAAMc,EAAa,EAAGe,MAUnDI,CAASN,EAAQE,GAEjC,MAAQ,CACNK,UAAWL,EAAOF,EAClBQ,UAAWR,EACXS,IAAKN,EAAQO,QAAO,SAACC,EAAGC,GAAJ,OAAUD,EAAIC,IAAG,GACrCf,OACAM,UACAH,SACAE,WAEDW,OAAO,EAAG,IAER,ICjCIC,EAAkB,SAACpB,GAC9B,IAAKA,EAAK,MAAO,OAGjB,IADA,IAAIqB,EAAO,EACFC,EAAI,EAAGA,EAAItB,EAAIuB,OAAQD,IAC9BD,EAAOrB,EAAIwB,WAAWF,KAAOD,GAAQ,GAAKA,GAI5C,IADA,IAAII,EAAQ,IACHH,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAE1BG,IAAU,MADGJ,GAAa,EAAJC,EAAU,KACTI,SAAS,KAAKC,QAAQ,GAG/C,OAAOF,GAGIG,EAAW,SAACC,GACvB,QAAKA,IACgBA,GAAQtB,SAASuB,aAAaC,QAAQ,iBAAmB,MACvD,MAAU,IAAIC,MAAOC,WAGjCC,EAAc,SAAClC,GAAD,OAAqC,IAApB,UAAGA,GAAMuB,OAAT,WACpCvB,GACJA,GAESiC,EAAU,SAACJ,GACtB,IAAMM,EAAO,IAAIH,KAAKH,GACtB,MAAO,CAACM,EAAKC,WAAYD,EAAKE,aAAcF,EAAKG,cAAc3D,IAAIuD,GAAaK,KAAK,MAG1EC,EAAU,SAACX,GACtB,IAAMM,EAAO,IAAIH,KAAKH,GACtB,MAAO,CAACM,EAAKK,UAAWL,EAAKM,WAAa,EAAGN,EAAKO,eAAe/D,IAAIuD,GAAaK,KAAK,MAG5EI,EAAc,SAACd,GAC1B,IAAMM,EAAO,IAAIH,KAAKH,GAItB,MAAO,CAHa,CAACM,EAAKC,WAAYD,EAAKE,aAAcF,EAAKG,cAAc3D,IAAIuD,GAAaK,KAAK,KAC9E,CAACJ,EAAKK,UAAWL,EAAKM,WAAa,EAAGN,EAAKO,eAAe/D,IAAIuD,GAAaK,KAAK,MAElEA,KAAK,MAG5BK,EAAoB,WAC/B,IAAMC,EAAW,WACVjB,EAASrB,SAASuB,aAAaC,QAAQ,iBAAmB,KAAO,MACpEe,GAAQC,iBAAiB,KAG7B,CACE,YACA,YACA,UACA,SACA,cACAC,SAAQ,SAACC,GACTC,SAASC,iBAAiBF,EAAWJ,GAAU,MAEjDA,KAGWO,EAAQ,SAACpD,GAAD,MACnB,sFAAsFqD,KAAKrD,IAEhFsD,EAAkB,SAACC,GAC9B,OAAOA,EACJC,QAAO,SAACC,EAAgBC,EAAaC,GAA9B,OACNA,EAAKC,WAAU,SAACC,GAAD,OAAkBA,EAAGhC,OAAS4B,EAAK5B,UAAU6B,KAE7DI,MAAK,SAAC7C,EAAaC,GAAd,OAA8BA,EAAEW,KAAOZ,EAAEY,QAC9ClD,KAAI,SAACoF,EAAaC,EAAeT,GAChC,OAAIS,EAAQT,EAAShC,OAAS,GACxBwC,EAAEE,SAAWV,EAASS,EAAQ,GAAGC,OAC5B,2BACFF,GADL,IAEEG,SAAS,IAIRH,MAIAI,EAAgB,SAACC,GAAuB,IAC3CC,EAASD,EAATC,KAcR,OAZI9E,EAAU8D,KAAKgB,KACjBD,EAAQnE,MAAQF,EAAYsE,IAG1BA,EAAKC,QAAQ,MAAQ,IACvBF,EAAQG,MAAO,GAGb,0DAAmBlB,KAAKgB,KAC1BD,EAAQI,WAAY,GAGfJ,GAGIK,EAAkB,SAACL,GAE9B,IAAKA,EAEH,OADAM,IAAOC,MAAM,gGACN,EAGT,GDvGA,gCAAgBtB,KCuGJe,GAAU,CACpB,IAAMnE,EAAyBmE,EAAQlE,MAAM,kMAC7C,GAAID,EAqBF,GApBiBA,EAAM2E,MAAK,SAACzE,GAC3B,GAAI,uKAAsDkD,KAAKlD,GAE7D,OADAuE,IAAOC,MAAP,qFAA+BxE,EAA/B,kKACO,EAHmC,MAMrBA,EAAK3B,MAAM,aANU,mBAMrC8B,EANqC,KAM7BE,EAN6B,KAQ5C,OAAID,SAASD,GAAU,IACrBoE,IAAOC,MAAP,qFAA+BxE,EAA/B,iLACO,IAG2C,IAAhD,CAAC,EAAE,EAAE,EAAE,EAAE,GAAG,GAAG,IAAImE,QAAQ/D,SAASC,MACtCkE,IAAOC,MAAP,qFAA+BxE,EAA/B,qNACO,MAKG,OAAO,EAGzB,OAAO,GAMI0E,EAAyC,SAACC,GAAD,MAAiB,CACrEA,GAAIA,EACJC,KAAM,OACNC,KAAM,uCACNC,OAAQ,EACRpD,KAAM,EACNqD,OAAQJ,EACRK,MAAO,GACPC,YAAa,kKACbC,MAAO,EACPC,SAAU,EACVC,MAAO,EACPC,UAAU,EACVC,QAAQ,EACRnF,OAAQoF,OAAOC,YAGJC,EAAc,SAACnC,GAAD,IAAcoC,IAAd,+DACzB,UAAGpC,EAAI,WAAOA,EAAKuB,KAAZ,KAAsB,+CAAea,GAAcpC,EAAKnD,QAAUmD,EAAKnD,QAAU,EAA5C,YAAqDmD,EAAKnD,OAA1D,iBAAwE,KC3FzGwF,EAAqB,CAChChB,GAAI,GACJC,KAAM,OACNC,KAAM,GACNE,OAAQ,GACRC,MAAO,GACPF,OAAQ,EACRI,MAAO,EACPD,YAAa,GACbE,SAAU,EACVE,UAAU,EACVD,MAAO,EACP1D,KAAM,EACNvB,OAAQ,GAaGyF,EAA2C,CACtDC,OAAQ,GACRC,SAAS,EACTC,gBAAiB,EACjBC,gBAAiB,EACjBC,aAAc,EACdC,aAAc,EACdC,MAAM,GChHFC,EAAOC,KAAKC,MAAM3E,aAAaC,QAAQ,SAAW,QACpDwE,GAAMzE,aAAa4E,QAAQ,MAAOH,EAAKI,KACpC,IAAMC,EAAuB,CAClCC,SAAUN,EACVzI,WAAqB,OAATyI,EACZO,UAAU,EACVC,SAAS,EACTxD,SAAU,GACVyD,MAAO,GACPL,IAAKJ,EAAOA,EAAKI,IAAM,GACvBM,YAAa,KACbC,MAAO,GACPvC,OAAO,EACPwC,cAAe,GACfC,iBAAkBrB,GAGPsB,EAAqB,CAChCC,WAAY,EAEZC,SAAU,GACVC,OAAQ,GAERC,SAAS,EACTd,IAAK,GACLe,UAAW,IAuKEC,EApKC,WAA4C,IAA3C9J,EAA0C,uDAAlC+I,EAAcgB,EAAoB,uCACzD,OAAQA,EAAO7C,MACb,IAAK,QACL,IAAK,eACL,IAAK,oBACL,IAAK,eACL,IAAK,WACL,IAAK,YACL,IAAK,iBACL,IAAK,kBACL,IAAK,cACL,IAAK,YACL,IAAK,cACL,IAAK,YACL,IAAK,qBACL,IAAK,cACH,OAAO,2BACFlH,GADL,IAEEkJ,SAAS,IAGb,IAAK,mBACL,IAAK,gBACL,IAAK,oBACL,IAAK,4BACL,IAAK,yBACL,IAAK,oBACL,IAAK,sBACL,IAAK,mBACL,IAAK,oBACL,IAAK,iBACL,IAAK,0BACL,IAAK,mBACL,IAAK,oBACH,OAAO,2BACFlJ,GADL,IAEEkJ,SAAS,IAGb,IAAK,gBACH,OAAO,2BACFlJ,GADL,IAEE8I,IAAKiB,EAAOrB,KAAKI,IACjBE,SAAUe,EAAOrB,KACjBzI,WAA4B,OAAhB8J,EAAOrB,KACnBU,YAAY,2BACPI,GADM,IAETV,IAAKiB,EAAOrB,KAAKI,MAEnBI,SAAS,IAGb,IAAK,aACH,OAAO,2BACFlJ,GADL,IAEEkJ,SAAS,EACTpC,MAAOiD,EAAOjD,QAGlB,IAAK,SACH,OAAO,2BACF9G,GADL,IAEEgJ,SAAU,KACV/I,YAAY,IAGhB,IAAK,uBACH,IAAMyF,EAAWqE,EAAOC,OAAP,sBACThK,EAAM0F,UADG,YACUqE,EAAOrE,WAC9BqE,EAAOrE,SAEX,OAAO,2BACF1F,GADL,IAEE0F,SAAUD,EAAgBC,GAC1BwD,SAAS,IAGb,IAAK,mBACH,IAAME,EAAcW,EAAOrB,KAAKI,MAAQ9I,EAAM8I,IAC1CiB,EAAOrB,KACP1I,EAAMoJ,YAEV,OAAO,2BACFpJ,GADL,IAEEoJ,cACAD,MAAM,2BACDnJ,EAAMmJ,OADN,kBAEFY,EAAOjB,IAAMiB,EAAOrB,SAI3B,IAAK,oBACH,IAAMW,EAAkC,GAIxC,MAHA,sBAAIrJ,EAAMqJ,OAAV,YAAoBU,EAAOV,QACxBlE,SAAQ,SAACS,GAAD,OAAiByD,EAAMzD,EAAKqB,IAAMrB,KAEtC,2BACF5F,GADL,IAEEkJ,SAAS,EACTG,MAAOY,OAAOC,OAAOb,KAGzB,IAAK,SACH,OAAO,2BACFrJ,GADL,IAEE6G,OAAQkD,EAAOxD,UAGnB,IAAK,iBACH,OAAO,2BACFvG,GADL,IAEE6G,YAAQsD,IAGZ,IAAK,WACH,OAAO,2BACFnK,GADL,IAEEoK,SAAUL,EAAOvI,KAGrB,IAAK,mBACH,OAAO,2BACFxB,GADL,IAEEoK,cAAUD,IAGd,IAAK,6BACH,OAAO,2BACFnK,GADL,IAEEkJ,SAAS,EACTI,cAAeS,EAAOT,gBAG1B,IAAK,cACH,OAAO,2BACFtJ,GADL,IAEEkJ,SAAS,EACTK,iBAAkB,CAChBpB,OAAQ4B,EAAO9C,GACfiB,4BAIN,IAAK,uBACH,OAAO,2BACFlI,GADL,IAEEuJ,iBAAiB,2BACZvJ,EAAMuJ,kBADK,kBAEbQ,EAAOM,MAAQN,EAAOhJ,UAI7B,IAAK,sBACH,OAAO,2BACFf,GADL,IAEEkJ,SAAS,EACTG,MAAOrJ,EAAMqJ,MAAM1D,QAAO,SAACC,GAAD,OAAiBA,EAAKqB,KAAO8C,EAAO9C,QAGlE,QACE,OAAOjH,ICxLAsK,EAAiBC,cAOfC,EANDC,sBACZC,EACA3B,EACA4B,8BAAoBC,0BAAgBN,KCRhCO,EAAWL,EAAMK,SAUjBC,GACJ,SAAC5D,GAAD,OACE,SAAC6D,GAAD,OACEF,EAAS,aAAE3D,QAAS6D,MAEpBC,GAAoB,SAAC9D,GAAkB,IAAD,EACpC+D,EAAoB/D,EJXvBgE,cACAC,QAAQ,OAAO,SAACjF,GAAD,OAAOA,EAAEkF,iBACxBD,QAAQ,KAAM,IIUjB,OAAO,EAAP,iBACGF,EAAWH,GAAa5D,IAD3B,wBAEM+D,EAFN,WAE0BH,GAAa,GAAD,OAAI5D,EAAJ,cAFtC,wBAGM+D,EAHN,QAGuBH,GAAa,GAAD,OAAI5D,EAAJ,WAHnC,GAoCajC,GA7BQ,mSAClB+F,GAAkB,UAClBA,GAAkB,aAClBA,GAAkB,iBAClBA,GAAkB,sBAClBA,GAAkB,aAClBA,GAAkB,iBAClBA,GAAkB,mBAClBA,GAAkB,cAClBA,GAAkB,gBAClBA,GAAkB,gBAClBA,GAAkB,aAClBA,GAAkB,gBAClBA,GAAkB,cAClBA,GAAkB,mBAClBA,GAAkB,mBAClBA,GAAkB,cAClBA,GAAkB,gBAClBA,GAAkB,cAClBA,GAAkB,cAClBA,GAAkB,WAClBA,GAAkB,aAClBA,GAAkB,uBAClBA,GAAkB,gBAvBA,IAwBrBK,mBAAoBP,GAAa,wBACjC5F,iBAAkB4F,GAAa,sBAC/BQ,OAAQR,GAAa,Y,8BC3BRS,GAfA,SAACpL,GAAyB,IAC/BwJ,EAAqCxJ,EAArCwJ,OAAQD,EAA6BvJ,EAA7BuJ,SAAU8B,EAAmBrL,EAAnBqL,MAAUC,EADE,aACOtL,EADP,+BAGhCuL,EAAUnG,EAAMoE,GAAUA,EAAS,GACzC,OACE,kBAAC,KAAD,eACEgC,IAAKD,EACLF,MAAK,2BAAOA,GAAP,IAAcI,gBAAiBF,EAAU,cAAgBnI,EAAgBmG,MAC1E+B,GAEH/B,I,2DCoCQmC,G,4MApDb7L,MAAQ,CAAE8L,SAAS,G,EAEnBC,YAAc,WACZ,EAAKC,SAAS,CACZF,SAAU,EAAK9L,MAAM8L,W,wDAIf,IACAH,EAAQM,KAAK9L,MAAbwL,IAER,OACE,kBAAC,IAAMvL,SAAP,KACE,yBACE8L,QAASD,KAAKF,YACdJ,IAAKA,EACLQ,IAAI,GACJC,UAAU,eAEZ,kBAAC,KAAD,CACEC,MACE,6BACE,uBACEhL,KAAMsK,EACNrK,OAAO,SACPC,IAAI,uBAEHoK,GAEH,kBAACW,GAAA,EAAD,CAAeJ,QAASD,KAAKF,eAGjCK,UAAU,cACVG,UAAU,EACVC,OAAQ,KACRV,QAASG,KAAKjM,MAAM8L,QACpBW,SAAUR,KAAKF,YACfW,MAAM,eAEN,yBACElB,MAAO,CACLmB,SAAU,QAEZhB,IAAKA,EACLQ,IAAI,W,GA7CIS,a,UCiHL5L,I,mNAnGb6L,SAAW,WAAO,IAAD,EACmB,EAAK1M,MAAMyF,KAArCsB,EADO,EACPA,KAAMQ,EADC,EACDA,MAAOD,EADN,EACMA,SAErB,OAAQP,GACN,IAAK,WACH,OAAOQ,EAET,IAAK,SACH,OAAOD,EAET,QACE,IAAMhF,EAAS,EAAKtC,MAAMsC,QAAU,EAAKtC,MAAMyF,KAAKnD,OACpD,SAAQA,GAAUA,GAAU,IAArB,UAA6BA,EAA7B,kB,EAIbqK,OAAS,CACPC,SAAU,uCACVC,OAAQ,8C,EAGVC,UAAY,WAAO,IAAD,EACQ,EAAK9M,MAArBqM,EADQ,EACRA,OAAQ1D,EADA,EACAA,IADA,EAEO,EAAK3I,MAAMyF,KAA1BgC,EAFQ,EAERA,OAAQX,EAFA,EAEAA,GAEhB,OAAIW,EAEA,yBAAKwE,UAAU,eACb,kBAAC,KAAD,CACEjL,UAAW2H,EACXoD,QAAS,kBAAMjH,GAAQiI,WAAW,CAAEpE,MAAK7B,KAAIkG,KAAK,MAElD,kBAACC,GAAA,EAAD,QAMJZ,EAEA,yBAAKJ,UAAU,eACZI,QAHP,G,EAQFa,OAAS,WAAO,IAAD,EACc,EAAKlN,MAAxBgB,EADK,EACLA,SAAUyE,EADL,EACKA,KADL,EAWTA,EARFuB,YAHW,MAGJvB,EAAKqB,GAHD,IAWTrB,EAPF4B,aAJW,MAIH,EAJG,EAKXD,EAME3B,EANF2B,YACAD,EAKE1B,EALF0B,MACAD,EAIEzB,EAJFyB,OAPW,EAWTzB,EAHFwB,cARW,MAQF,EARE,EASXF,EAEEtB,EAFFsB,KACAS,EACE/B,EADF+B,SAGI2F,EAAQ,EAAKT,WACnB,OACE,kBAAC,KAAD,CAAMT,UAAS,eAAWzE,IAAaxG,EAAY,GAAK,aACtD,yBAAKiL,UAAU,aACb,yBAAKA,UAAU,aAAajF,GAC5B,yBAAKiF,UAAU,gBACb,yBAAKA,UAAU,cACZ5E,EAAQ,GAAR,oCAAsBA,IAEzB,yBAAK4E,UAAU,eACZhF,EAAS,GAAT,8BAAsBA,EAAtB,UAILE,GAASC,IACT,yBAAK6E,UAAU,aACZ9E,GAAS,yBAAK8E,UAAU,cACvB,kBAAC,GAAD,CAAQzC,OAAQrC,EAAOoC,SAAUvC,EAAMoG,MAAM,YAE9ChG,IAIH+F,GAASjG,IACT,yBAAK+E,UAAU,kBACb,yBAAKA,UAAU,aAGXkB,EAAK,UAAM,EAAKR,OAAO5F,IAAS,kCAA3B,aAAwCoG,GAAU,IAG3D,yBAAKlB,UAAU,eAAe/E,IAGjC,EAAK4F,c,YA9FKL,cCsBJ7M,gBAPS,SAACC,EAAeG,GAItC,MAAO,CAAEyF,KAHS5F,EAAVqJ,MACWmE,MAAK,SAAC5H,GAAD,OAAiBA,EAAKqB,KAAO9G,EAAM8G,SAK9ClH,EAvBE,SAACI,GAA2B,IACnC8G,EAA2B9G,EAA3B8G,GAAIrB,EAAuBzF,EAAvByF,KAAS6H,EADqB,aACPtN,EADO,eAG1C,OAAKyF,EAMH,kBAAC,GAAD,eACEA,KAAMA,GACF6H,KAPNxI,GAAQyI,YAAY,CAAEzG,OACf,kBAAC,IAAM7G,SAAP,UC0HIuN,GA/HK,SAACxN,GAA8B,IACvC2I,EAAiB3I,EAAjB2I,IAAKvC,EAAYpG,EAAZoG,QAEXC,EAIED,EAJFC,KACAE,EAGEH,EAHFG,KACAtE,EAEEmE,EAFFnE,MACAwL,EACErH,EADFqH,KAGF,GAAIA,EAAM,CAAC,IACDzF,EAAgCyF,EAAhCzF,OAAQ0F,EAAwBD,EAAxBC,MAAOpL,EAAiBmL,EAAjBnL,OAAQyE,EAAS0G,EAAT1G,KAE/B,GAAIiB,EACF,OACE,oCACE,uBAAGiE,UAAU,cACV5F,GAEH,yBAAK4F,UAAWyB,EAAQ,GAAK,cAC3B,kBAAC,GAAD,CACE5G,GAAIkB,EAAO2F,OACXrL,OAAQA,EACRtB,SAAU0M,EACVrB,OAAQ1D,GAAO5B,EACb,kBAAC,KAAD,CACEmF,MAAM,qGACN0B,UAAW,kBAAM9I,GAAQ+I,SAAS,CAAElF,MAAKvC,UAASqH,UAClDK,OAAO,yDACPC,WAAW,uCACX/M,SAAU0M,GAEV,kBAAC,KAAD,CAAQzB,UAAU,cAAcjL,SAAU0M,GACxC,kBAACM,GAAA,EAAD,aAGFhE,MAQhB,GAAI5E,EAAMiB,GAAO,CACf,GAAI,oCAAoChB,KAAKgB,GAC3C,OACE,kBAAC,GAAD,CAAOmF,IAAKnF,IAIhB,IAAMpF,EACJ,uBACEC,KAAMmF,EACNlF,OAAO,SACPC,IAAI,uBAEHiF,GAKL,GAAIA,EAAKC,QAAQ,UAAY,EAAG,CAC9B,IAeM2H,EAAe,IAAIC,IAAI7H,GAAM4H,aAC/BE,EAAS,oBACPC,EAjBa,SAAC/H,GAClB,KAAIA,EAAKC,QAAQ,aAAe,GAS9B,OAAO,IAAI4H,IAAI7H,GAAM4H,aAAaI,IAAI,MAAQ,GAR9C,IAAMC,EAAajI,EAAKnE,MAAM,mBAC9B,GAAIoM,EAAY,CACd,IAAMC,EAAYD,EAAW7N,MAC7B,GAAI8N,EACF,OAAOA,EAAU/N,MAAM,KAAKC,OAAS,GAM3C,MAAO,GAKO+N,CAAWnI,GAE3B,GAAI+H,EAAS,CACX,IAAMK,EAASR,EAAaI,IAAI,QAC5BI,IACFN,GAAU,SAAWM,GAEvB,IAAM5K,EAAOoK,EAAaI,IAAI,KAI9B,OAHIxK,IACFsK,GAAU,UAAYtK,GAGtB,oCACG5C,EACD,4BACEiL,MAAOkC,EACPtH,GAAG,WACHyF,MAAM,OACNmC,OAAO,MACPlD,IAAG,uCAAkC4C,EAAlC,YAA6CD,GAChDQ,YAAY,IACZC,MAAM,gEACNC,iBAAe,MAOzB,OAAO5N,EAGT,IAAM6N,EAAQ7M,EV9ES,SAACoE,EAAc0I,GACxC,IAAM9M,EAAK,YAAO8M,GAClB,OAAO1I,EAAK7F,MAAM,KAAKG,KAAI,SAACqO,EAAchJ,GACxC,IAAMiJ,EAAYhN,EAAM2D,WAAU,qBAAGzD,OAAoB6M,KACzD,GAAIC,GAAa,EAAG,CAAC,IAAD,EAMdhN,EAAMkB,OAAO8L,EAAW,GAAG,GAJ7BxM,EAFgB,EAEhBA,QACAI,EAHgB,EAGhBA,UACAC,EAJgB,EAIhBA,UACAC,EALgB,EAKhBA,IAGImM,EAAUzM,EAAQc,OAAS,EAAjB,UACTR,EADS,cACAN,EAAQ8B,KAAK,QADb,UAET9B,EAAQ8B,KAAK,QAEd0H,GAAalJ,IAAQF,EAAa,UAAeE,IAAQD,GAAa,aAAe,GAE3F,OACE,kBAAC,IAAM7C,SAAP,CAAgBa,IAAKkO,EAAOhJ,GACzB,IACD,kBAAC,IAAD,CAASkG,MAAOgD,GACd,uBAAGjD,UAAWA,GACX+C,EADH,IACUjM,EADV,OAOR,MAAM,IAAN,OAAWiM,MUkDPG,CAAY9I,EAAMpE,GAClBoE,EAEJ,OAAIE,EAEA,uBAAG0F,UAAU,cACV6C,GAKA,8BAAOA,ICxEHM,GA/CC,SAACpP,GAA0B,IAAD,EAUpCA,EARFoG,QACEvC,EAHoC,EAGpCA,KACAqC,EAJoC,EAIpCA,QACAG,EALoC,EAKpCA,KACAG,EANoC,EAMpCA,UAEF+B,EAEEvI,EAFFuI,KACAI,EACE3I,EADF2I,IAGIuD,EAAQ3D,GACZ,kBAAC,IAAD,CAAMlH,GAAE,YAAOkH,EAAKI,IAAZ,cACN,kBAAC,IAAD,CACEuD,MAAO3D,EAAKe,WAAL,+HAA2C3E,EAAY4D,EAAKe,kBAAgBU,EACnFqF,UAAU,QAEV,yBAAKpD,UAAS,8BAAyBrI,EAAS2E,EAAKe,YAAc,SAAW,KAC5E,kBAAC,GAAD,CACEE,OAAQjB,EAAKiB,OACbD,SAAUhB,EAAKgB,WAEjB,yBAAK0C,UAAU,0BACZ1D,EAAKgB,UAAYhB,EAAKI,QAOjC,OACE,kBAAC,KAAD,CACEsD,UAAS,uBAAkB/F,EAAU,UAAY,GAAxC,YAA8CM,GAAa+B,GAASlC,EAAKC,QAAL,WAAiBiC,EAAKgB,SAAtB,OAAsC,EAAK,YAAc,IACtI2C,MAAOA,EACPpL,IAAK+C,EACLyL,MACE,kBAAC,IAAD,CAASpD,MAAO1H,EAAQX,IACtB,yBAAKoI,UAAU,aAAahI,EAAQJ,MAIxC,kBAAC,GAAD,CAAauC,QAASpG,EAAMoG,QAASuC,IAAKA,MC5B1C4G,G,4MACJ1P,MAAQ,CACNuG,QAAS,GACToJ,SAAS,G,EAGXC,kBAAoB,WAClB3K,GAAQ4K,YAAY,IACpB5K,GAAQ6K,UAAU,IAClB,EAAK9D,SAAS,CAAEzF,QAAStC,aAAaC,QAAQ,YAAc,M,EAG9D6L,qBAAuB,WACrB9K,GAAQ+K,YAAY,K,EAGtBC,mBAAqB,SAACC,GAA2B,IAAD,EAClB,EAAK/P,MAAzBuF,EADsC,EACtCA,SAAUyD,EAD4B,EAC5BA,MAEd,EAAKnJ,MAAM2P,SAAWO,EAAUxK,WAAaA,IAC/CzB,aAAa4E,QAAQ,UAAW,IAChC,EAAKmD,SAAS,CACZzF,QAAS,GACToJ,SAAS,KAIbjK,EAASP,SAAQ,SAACe,GACXiD,EAAMjD,EAAEE,SACXnB,GAAQkL,QAAQ,CAAErH,IAAK5C,EAAEE,a,EAK/BgK,gBAAkB,SAACC,GACjB,IAAM9J,EAAU8J,EAAM/O,OAAOP,MAC7BkD,aAAa4E,QAAQ,UAAWtC,GAChC,EAAKyF,SAAS,CAAEzF,a,EAGlB+J,UAAY,SAACD,GACO,UAAdA,EAAMpP,KAAoBoP,EAAME,WAClCF,EAAMG,iBAEN,EAAKC,iBAJkD,IAOjD3H,EAAQ,EAAK3I,MAAb2I,IACR,GAAkB,OAAduH,EAAMpP,KAA8B,YAAdoP,EAAMpP,IAAmB,CACjD,IAAMsF,EAAU,EAAKpG,MAAMuF,SAAS8H,MAAK,SAACtH,GAAD,OAAiBA,EAAEE,SAAW0C,KACvE,GAAIvC,EAAS,CAAC,IAAD,EAC0C8J,EAA7CK,cAAiB3P,EADd,EACcA,MAAO4P,EADrB,EACqBA,eAChC,GAA2D,IAAvD5P,EAAM+C,OAAO,EAAG6M,GAAgBhQ,MAAM,MAAM+C,OAAc,CAAC,IACrD8C,EAASD,EAATC,KACRvC,aAAa4E,QAAQ,UAAWrC,GAChC,EAAKwF,SAAS,CAAEzF,QAASC,Q,EAMjCiK,cAAgB,WAAO,IACblK,EAAY,EAAKvG,MAAjBuG,QADY,EAEW,EAAKpG,MAA5BuI,EAFY,EAEZA,KAAMQ,EAFM,EAENA,QAASJ,EAFH,EAEGA,IAEnBI,IAICR,EAKAA,EAAKgB,SAKL9C,EAAgBL,KAIrB,EAAKyF,SAAS,CAAE2D,SAAS,IACzB1K,GAAQ2L,YAAY,CAClB9H,MACAvC,aAXAM,IAAOC,MAAM,yTALbD,IAAOC,MAAM,6L,EAoBjB+J,gBAAkB,WAChB5L,GAAQ4L,gBAAgB,CAAEC,aAAc,EAAK3Q,MAAMuF,SAAS,EAAKvF,MAAMuF,SAAShC,OAAS,M,EAG3FqN,SAAW,SAACV,GACNA,EAAMK,cAAcM,WAAa,KACnCX,EAAMG,iBACN,EAAKK,oB,EAITI,WAAa,SAACC,EAAYb,GAAiF,IACjGvH,EAAQ,EAAK3I,MAAb2I,IACJoI,IACEA,EAAKhK,KAAKT,QAAQ,UAAY,EAChCxB,GAAQgM,WAAW,CAAEnI,IAAKA,EAAKoI,SAE/BrK,IAAOC,MAAM,wMAEfuJ,EAAMG,mB,EAIVW,QAAU,SAACC,GACT,EAAKH,WAAWG,EAAEC,cAAcC,MAAM,GAAIF,I,EAG5CG,OAAS,SAACH,GACR,IAAMF,EAAOE,EAAEI,aAAanI,MAAM,GAAGoI,YACjCP,GACF,EAAKD,WAAWC,EAAME,I,EAG1B/D,OAAS,WAAO,IAAD,EAC6B,EAAKlN,MAAvCuF,EADK,EACLA,SAAUwD,EADL,EACKA,QAASC,EADd,EACcA,MAAOL,EADrB,EACqBA,IAElC,OACE,kBAAC,IAAD,CAAM4I,SAAUxI,GACd,yBAAKkD,UAAS,gBACZ,yBACEA,UAAU,YACV2E,SAAU,EAAKA,UAEdrL,EAAS5E,KAAI,SAACoF,GAAD,OACZ,kBAAC,GAAD,CACEjF,IAAKiF,EAAElC,KACPuC,QAASL,EACTwC,KAAMS,EAAMjD,EAAEE,QACd0C,IAAKA,QAIX,yBAAKsD,UAAU,iBACb,kBAAC,IAAMuF,SAAP,CACEC,YAAY,oGACZC,SAAU,CAAEC,QAAS,EAAGC,QAAS,IACjCC,SAAU,EAAK5B,gBACfE,UAAW,EAAKA,UAChBvP,MAAO,EAAKf,MAAMuG,QAClB4K,QAAS,EAAKA,QACdI,OAAQ,EAAKA,SAEf,kBAACU,EAAA,EAAD,CACE/F,QAAS,EAAKuE,oB,YAzJT7D,aA8KJ7M,gBAZS,SAACC,GAAmB,IAClC0F,EAAkC1F,EAAlC0F,SAAUoD,EAAwB9I,EAAxB8I,IAAKI,EAAmBlJ,EAAnBkJ,QAASC,EAAUnJ,EAAVmJ,MAEhC,MAAO,CACLzD,WACAoD,MACAI,UACAC,QACAT,KAAMS,EAAML,MAID/I,CAAyB2P,I,oBC9MzB,qBACb,yBAAKwC,QAAQ,gBAAgBC,UAAU,QAAQ/F,UAAU,eAAegG,YAAU,OAAO1F,MAAM,MAAMmC,OAAO,MACvG/L,KAAK,UAAUuP,cAAY,QAC9B,0BAAMC,EAAE,guBCHG,qBACb,yBAAKJ,QAAQ,gBAAgBC,UAAU,QAAQ/F,UAAU,GAAGgG,YAAU,eAAe1F,MAAM,MAAMmC,OAAO,MACnG/L,KAAK,eAAeuP,cAAY,QACnC,0BACEC,EAAE,gLACFxP,KAAK,YACP,0BACEwP,EAAE,uRACFxP,KAAK,gBACP,0BACEwP,EAAE,6LACFxP,KAAK,cCQIyP,GAhBA,SAACpS,GAAiC,IACvC+I,EAAY/I,EAAZ+I,QAER,OACE,yBAAKkD,UAAU,UACZlD,EAEG,kBAACsJ,GAAD,MAEA,kBAACC,GAAD,QCaGC,GAAb,4MACE9C,kBAAoB,WAAO,IAAD,EACF,EAAKzP,MAAnBuI,EADgB,EAChBA,KAAMI,EADU,EACVA,IACTJ,GACHzD,GAAQkL,QAAQ,CAAErH,SAJxB,EAQE6J,YAAc,SAACtI,EAAetJ,GAA6B,IACjD2H,EAAS,EAAKvI,MAAduI,KACR,GAAKA,EAAL,CAEA,IAAMkK,EAAW,2BACZlK,GADY,kBAEd2B,EAAQtJ,IAGX,EAAK8R,YAAYD,KAjBrB,EAoBEZ,SAAW,SAAC3H,GAAD,OACT,SAACgG,GAAD,OACE,EAAKsC,YAAYtI,EAAOgG,EAAM/O,OAAOP,SAtB3C,EAwBE8R,YAAc,SAACD,GAAqB,IAC1BlK,EAAS,EAAKvI,MAAduI,KACJA,GACFzD,GAAQ6N,QAAQ,CACdhK,IAAKJ,EAAKI,IACVJ,KAAMkK,KA7Bd,EAkCEG,YAAc,kBAAM,EAAKF,YAAL,2BACf,EAAK1S,MAAMuI,MADI,IAElBiB,OAAQ,OApCZ,EAuCEqJ,SAAW,SAAC/R,EAAaF,EAAe2H,GAAiB,IAAD,EAC5BA,EAAlBgB,gBAD8C,MACnC,GADmC,IAEf,EAAKvJ,MAApC8S,EAF8C,EAE9CA,SAAU7J,EAFoC,EAEpCA,YAAaN,EAFuB,EAEvBA,IACzB3H,GAAY8R,EAElB,OAAQhS,GACN,IAAK,SACH,OACE,6BACE,yBAAKuK,MAAO,CAAE0H,QAAS,SACrB,kBAAC,IAAD,CACEnS,MAAOA,EACPiR,SAAU,EAAKA,SAAS/Q,GACxBkS,SAAUhS,IAEZ,kBAAC,KAAD,CACEkL,MAAM,yFACN0B,UAAW,EAAKgF,YAChB9E,OAAO,eACPC,WAAW,qBACXkF,KAAM,kBAACC,GAAA,EAAD,CAAe7H,MAAO,CAAE5H,MAAO,aACrCzC,UAAWJ,GAEX,kBAAC,KAAD,CACEI,SAAUA,IAAaJ,EACvBuS,QAAM,GAEN,kBAACD,GAAA,EAAD,SAIN,kBAAC,GAAD,CACE1J,OAAQ5I,EACR2I,SAAUA,EACV/G,KAAM,IACN6I,MAAO,CAAE+H,OAAQ,WAAYL,QAAS,YAK9C,IAAK,MACH,OACE,kBAAC,IAAD,CACEnS,MAAOA,EACPoS,UAAQ,IAId,IAAK,aACH,OAAOpS,EAEH,kBAAC,IAAD,CACEA,MAAO+D,EAAYpC,SAAS3B,IAC5BoS,UAAQ,IAGV,yKAGN,IAAK,UACH,OAAO,oCAEFF,GAAa7J,GAAeA,EAAYN,MAAQA,GACjD,oCACE,kBAAC,KAAD,CACE0K,UAAWzS,EACXiR,SAAU,SAACpI,GAAD,OAAsB,EAAK+I,YAAY1R,EAAK2I,OAI3D7I,EAAQ,6CAAY,sEAGzB,QACE,OACE,kBAAC,IAAD,CACE0S,aAAc1S,EACdiR,SAAU,EAAKA,SAAS/Q,GACxBkS,SAAUhS,MArHtB,EA2HE2L,OAAoC,CAClC,OAAU,uCACV,SAAY,6CACZ,WAAc,sHACd,QAAW,sEACX,IAAO,OAhIX,EAmIEO,OAAS,WAAO,IAAD,EACa,EAAKlN,MAAvBuI,EADK,EACLA,KAAMQ,EADD,EACCA,QAEd,OACE,kBAAC,KAAD,CACEkD,UAAU,WACVsH,UAAU,EACVxK,aAAkBiB,IAATzB,EACT2D,MAAO3D,GAAI,sGAAwBA,EAAKgB,UAAYhB,EAAKI,MAEzD,kBAAC,GAAD,CAAQI,QAASA,IAChBR,GAAQuB,OACN0J,KAAKnK,GACL1I,KAAI,SAACG,GACJ,IAAMQ,EAAQ,EAAKqL,OAAO7L,GAC1B,OAAOQ,GACL,kBAAC,KAAD,CACE2K,UAAWnL,EACXA,IAAKA,EACLoL,MAAO5K,GAIL,EAAKuR,SAAS/R,EAAd,UAAsByH,EAAKzH,IAAQ,IAAMyH,SA1J3D,YAA8BkL,IAAMhH,WAuLrB7M,gBAlBS,SAACC,EAAeG,GAA2B,IACzD+I,EAAgClJ,EAAhCkJ,QAASC,EAAuBnJ,EAAvBmJ,MAAOC,EAAgBpJ,EAAhBoJ,YAElBN,EAAM,IAAI+K,gBAAgB1T,EAAMkC,MAAMiM,QAAQE,IAAI,QAAUxO,EAAM8I,KAAO,IACzEJ,EAAOS,EAAML,GAKnB,OAJIJ,IAASA,EAAKI,KAAOA,IACvBJ,EAAKI,IAAMA,GAGN,CACLI,UACAR,OACAI,MACAmK,WAAavK,KAAUU,IAAiBA,EAAYN,MAAQJ,EAAKI,OAASM,EAAYQ,SACtFR,iBAIWrJ,CAAyB2S,ICrLzBoB,GAtBA,WACb,OACE,kBAAC,KAAD,KACE,kBAAC,KAAD,CACEnI,IANQ,0FAORhJ,KAAM,IACN6I,MAAO,CAAE+H,OAAQ,SAAUL,QAAS,WAEtC,6BACA,6BACA,kBAAC,KAAD,CACEhM,KAAK,UACLvE,KAAK,QACLuJ,QAAS,kBAAMjH,GAAQqG,OAAO,KAC9BE,MAAO,CAAEkB,MAAO,SAJlB,oC,0DCmRSqH,G,4MA1Qb/T,MAAQiI,E,EAER6E,OAAS,CACP7F,GAAI,KACJC,KAAM,sBACNC,KAAM,oDACNC,OAAQ,qBACRC,OAAQ,uCACRC,MAAO,mDACPC,YAAa,mDACbC,MAAO,2BACPC,SAAU,wFACVC,MAAO,uCACPC,SAAU,sE,EAGZqM,MAAQ,CACN,CACE/S,IAAK,SACLF,MAAO,wCAET,CACEE,IAAK,WACLF,MAAO,uEAET,CACEE,IAAK,SACLF,MAAO,4EAET,CACEE,IAAK,OACLF,MAAO,8CAET,CACEE,IAAK,OACLF,MAAO,wCAET,CACEE,IAAK,OACLF,MAAO,8CAET,CACEE,IAAK,MACLF,MAAO,4BAET,CACEE,IAAK,OACLF,MAAO,mC,EAIXiR,SAAW,SAAC/Q,EAAaF,GAAd,OAET,EAAKiL,SAAL,eAAiB/K,EAAMF,K,EAEzBkT,WAAa,kBACX,EAAKjI,SAAS,CAAE1E,MAAO,M,EAEzB4M,OAAS,CACPjN,GAAI,kBAAM,GACVC,KAAM,SAACnG,EAAeE,GAAhB,OACJ,kBAAC,KAAD,CACEF,MAAOA,EACPiR,SAAU,SAACjR,GAAD,OAAmB,EAAKiR,SAAS/Q,EAAKF,KAE/C,EAAKiT,MAAMlT,KAAI,gBAAGG,EAAH,EAAGA,IAAKF,EAAR,EAAQA,MAAR,OACd,kBAAC,KAAOoT,OAAR,CAAepT,MAAOE,EAAKA,IAAKA,GAC7BF,QAKToG,KAAM,SAACpG,EAAeE,GAAhB,OACJ,kBAAC,IAAD,CACEF,MAAOA,EACPiR,SAAU,SAACZ,GAAD,OAAsC,EAAKY,SAAS/Q,EAAKmQ,EAAEV,cAAc3P,WAGvFqG,OAAQ,SAACrG,EAAeE,GAAhB,OACN,kBAAC,KAAD,CACEF,MAAOA,EACPc,IAAK,EACLuS,UAAW,EACXpC,SAAU,SAACjR,GAAD,OAAoB,EAAKiR,SAAS/Q,EAAKF,GAAS,IAC1DsT,KAAM,OAGVhN,OAAQ,SAACtG,EAAeE,GAAhB,OACN,kBAAC,IAAD,CACEF,MAAOA,EACPiR,SAAU,SAACZ,GAAD,OAAsC,EAAKY,SAAS/Q,EAAKmQ,EAAEV,cAAc3P,WAGvFuG,MAAO,SAACvG,EAAeE,GAAhB,OACL,6BACE,yBAAKuK,MAAO,CAAE0H,QAAS,SACrB,kBAAC,IAAD,CACEnS,MAAOA,EACPiR,SAAU,SAACZ,GAAD,OAAsC,EAAKY,SAAS/Q,EAAKmQ,EAAEV,cAAc3P,UAErF,kBAAC,KAAD,CACEsL,MAAM,qGACN0B,UAAW,EAAKkG,WAChBhG,OAAO,eACPC,WAAW,qBACXkF,KAAM,kBAACC,GAAA,EAAD,CAAe7H,MAAO,CAAE5H,MAAO,cAErC,kBAAC,KAAD,CACEzC,UAAWJ,EACXuS,QAAM,GAEN,kBAACD,GAAA,EAAD,SAIN,kBAAC,GAAD,CACE9F,MAAM,SACN5D,OAAQ5I,EACR2I,SAAU3I,EACV4B,KAAM,IACN6I,MAAO,CAAE+H,OAAQ,WAAYL,QAAS,aAI5C3L,YAAa,SAACxG,EAAeE,GAAhB,OACX,kBAAC,IAAM0Q,SAAP,CACE5Q,MAAOA,EACPiR,SAAU,SAACZ,GAAD,OAAyC,EAAKY,SAAS/Q,EAAKmQ,EAAEV,cAAc3P,WAG1FyG,MAAO,SAACzG,EAAeE,GAAhB,OACL,kBAAC,KAAD,CACEF,MAAOA,EACPc,IAAK,EACLwS,KAAM,EACNrC,SAAU,SAACjR,GAAD,OAAoB,EAAKiR,SAAS/Q,EAAKF,GAAS,OAG9D0G,SAAU,SAAC1G,EAAeE,EAAa2E,GAA7B,MACM,WAAdA,EAAKsB,MAAqB,kBAAC,KAAD,CACxBnG,MAAOA,EACPc,IAAK,EACLwS,KAAM,EACNrC,SAAU,SAACjR,GAAD,OAAoB,EAAKiR,SAAS/Q,EAAKF,GAAS,OAG9D2G,MAAO,SAAC3G,EAAeE,EAAa2E,GAA7B,MACS,aAAdA,EAAKsB,MAAuB,kBAAC,KAAD,CAC1BnG,MAAOA,EACPc,IAAK,EACLwS,KAAM,EACNrC,SAAU,SAACjR,GAAD,OAAoB,EAAKiR,SAAS/Q,EAAKF,GAAS,OAG9D4G,SAAU,SAAC5G,EAAgBE,GAAjB,OACR,EAAKd,MAAMyJ,SAAW,kBAAC,KAAD,CACpB4J,QAASzS,EACTI,UAAW,EAAKhB,MAAMyJ,QACtBoI,SAAU,SAACwB,GAAD,OAAsB,EAAKxB,SAAS/Q,EAAKuS,Q,EAKzDR,SAAW,SAAC/R,EAAaF,EAAkC6E,GAEzD,IAAMyE,EAAQ,EAAK6J,OAAOjT,GAC1B,OAAOoJ,GAASA,EAAMtJ,EAAOE,EAAK2E,I,EAGpC0O,SAAW,WAAO,IACRtU,EADO,gBACPA,MADO,EAEiB,EAAKG,MAA7BmU,EAFO,EAEPA,SAFO,IAEG1O,YAFH,MAEU,GAFV,EAIT2O,EAAc,eAAQvU,GAC5BiK,OAAO0J,KAAK3T,GAAOmF,SAAQ,SAAClE,GAAD,OAGzBsT,EAAQtT,GAAOsT,EAAQtT,KAASgH,EAAYhH,IAAQ2E,EAAK3E,IAASsT,EAAQtT,MAGvEsT,EAAQpN,MAKbmN,EAASC,GACT,EAAKvI,SAAS/D,IALZpB,IAAOC,MAAM,iI,EAQjB0N,QAAU,WAAO,IACPxU,EADM,gBACNA,MADM,EAEQ,EAAKG,MAAnByF,YAFM,MAEC,GAFD,EAId,OACE,yBAAKwG,UAAU,gBACb,yBAAKA,UAAU,sBACZnC,OACE0J,KAAK1L,GACLnH,KAAI,SAACG,GAGF,IAAMF,EAAQf,EAAMiB,KAASgH,EAAYhH,IAAQ2E,EAAK3E,IAASjB,EAAMiB,GAC/DoJ,EAAQ,EAAK2I,SAAS/R,EAAKF,EAAOf,GACxC,OAAOqK,GACL,kBAAC,KAAD,CACE+B,UAAWnL,EACXA,IAAKA,EAELoL,MAAO,EAAKS,OAAO7L,IAElBoJ,OAOb,yBAAK+B,UAAU,0BACb,kBAAC,KAAD,CACEC,MAAM,0IACN0B,UAAW,kBAAM,EAAK/B,SAAS/D,IAC/BgG,OAAO,mDACPC,WAAW,uCACXkF,KAAM,kBAACC,GAAA,EAAD,CAAe7H,MAAO,CAAE5H,MAAO,cAErC,kBAAC,KAAD,0DAIF,kBAAC,KAAD,CACEyI,MAAM,6HACN0B,UAAW,EAAKuG,SAChBrG,OAAO,uCACPC,WAAW,uCACXkF,KAAM,kBAACC,GAAA,EAAD,CAAe7H,MAAO,CAAE5H,MAAO,cAErC,kBAAC,KAAD,iD,EASVyJ,OAAS,WAAO,IAAD,EACgB,EAAKlN,MAA1BsU,EADK,EACLA,QAAS3I,EADJ,EACIA,QAEjB,OACE,kBAAC,KAAD,CACEM,UAAU,qBACVsI,UAAQ,EACRnI,UAAU,EACVE,SAAUgI,EACVjI,OAAQ,KACRV,QAASA,EACTO,MACE,kBAACC,GAAA,EAAD,CAAeJ,QAASuI,KAGzB,EAAKD,Y,YArQY5H,a,mBCwDX+H,G,4MAtDb1H,UAAY,SAACrH,GAAiB,IACpBgP,EAAa,EAAKzU,MAAlByU,SACR,GAAKA,EAAL,CAEA,IAAMC,EAAiBD,EACpB9T,KAAI,YAAuD,IAApDW,EAAmD,EAAnDA,MAAOyK,EAA4C,EAA5CA,QAAkB4I,GAA0B,EAAnClL,QAAmC,EAA1BkL,WAC/B,QAAIA,IAAcA,EAAUlP,KAG1B,kBAAC,IAAK5E,KAAN,CAAWC,IAAKQ,GACd,kBAAC,KAAD,CAAQyK,QAAS,kBAAMA,GAAWA,EAAQtG,KACvCnE,OAINkE,OAAOoP,SACZ,GAA8B,IAA1BF,EAAenR,OAEnB,OACE,kBAAC,KAAD,CACEsR,QAAS,kBAAC,IAAD,KAAOH,GAChBI,QAAS,CAAC,UAEV,kBAAC,KAAD,KACE,kBAACC,GAAA,EAAD,U,EAMR7H,OAAS,WAAO,IAAD,EACU,EAAKlN,MAApBkJ,EADK,EACLA,MAAOP,EADF,EACEA,IAEf,OAAKO,GAA0B,IAAjBA,EAAM3F,OAOlB,yBAAK0I,UAAU,cACZ/C,EAAMvI,KAAI,SAAC8E,GAAD,OACT,kBAAC,GAAD,CACE3E,IAAK2E,EAAKqB,GAAKrB,EAAK5B,KACpB4B,KAAMA,EACN4G,OAAQ,EAAKS,UAAUrH,GACvBkD,IAAKA,QAXT,kBAAC,KAAD,CAAOvB,YAAY,+E,YApCHqF,a,UCgHTuI,G,4MAlHbC,aAAe,CACbC,aAAc,GACdC,cAAc,EACdC,iBAAiB,EACjBC,QAAS,CACP,QAAU,EACV,QAAU,EACV,UAAY,EACZ,MAAQ,EACR,MAAQ,EACR,MAAQ,EACR,KAAO,EACP,MAAQ,I,EA2BZC,WAAa,SAACzV,GAA6B,IACjCuV,EAA2CvV,EAA3CuV,gBAAiBD,EAA0BtV,EAA1BsV,aAAcE,EAAYxV,EAAZwV,QAEjCE,EAAY,SAACvO,EAAgB1F,GAAjB,OAChB,yBACEkU,SAAU,EACVvJ,UAAU,wBAEVF,QAAS,WACP0J,QAAQC,IAAI1O,EAAMqO,EAAQrO,IAC1B,EAAK6E,SAAS,CAAEwJ,QAAQ,2BAAMA,GAAP,kBAAiBrO,GAAQqO,EAAQrO,SAG1D,kBAAC,KAAD,CACEqM,QAEEgC,EAAQrO,KAEX1F,IAIL,OACE,kBAAC,KAAMqU,MAAP,CACErC,kBAActJ,EACdqB,MAAO,CAAE0H,QAAS,OAAQ6C,cAAe,WAExCL,EAAU,SAAU,wCACpBA,EAAU,SAAU,4EACpBA,EAAU,WAAY,uEACtBA,EAAU,OAAQ,8CAClBA,EAAU,OAAQ,kCAClBA,EAAU,OAAQ,8CAClBA,EAAU,MAAO,kCACjBA,EAAU,OAAQ,wCACnB,yBAAKC,SAAU,EAAGvJ,UAAU,wBACvBF,QAAS,kBAAM,EAAKF,SAAS,CAAEsJ,cAAeA,MACjD,kBAAC,KAAD,CAAQ9B,QAAS8B,IAFnB,wFAIA,yBAAKK,SAAU,EAAGvJ,UAAU,wBACvBF,QAAS,kBAAM,EAAKF,SAAS,CAAEuJ,iBAAkBA,MACpD,kBAAC,KAAD,CAAQ/B,QAAS+B,IAFnB,uG,EAQNS,gBAAyC,iBAAM,I,EAC/CC,UAA+C,WAC7C,OACE,yBAAK7J,UAAU,kBACZ,EAAK4J,oB,EAKZE,WAAgD,kBAAM,kBAAC,IAAM9V,SAAP,O,EACtD6M,UAA+C,kBAAM,kBAAC,IAAM7M,SAAP,O,EACrD+V,SAA6C,a,EAE7C9I,OAAS,WAAO,IACNnE,EAAY,EAAK/I,MAAjB+I,QACFG,EAAQ,EAAKA,MAEnB,OACE,kBAAC,KAAD,CAAM+C,UAAU,QAAQC,MAAO,EAAK8J,YAClC,kBAAC,GAAD,CAAQjN,QAASA,IAChB,EAAK+M,UAAU5M,GACf,EAAK6M,WAAW7M,GAChB,EAAK4D,UAAU5D,K,qDA5FT,IAAD,EACuD4C,KAAKjM,MAA9DqV,EADE,EACFA,aAAcG,EADZ,EACYA,QAASF,EADrB,EACqBA,aAAcC,EADnC,EACmCA,gBAEvCa,EAAgBf,EAAanK,cACnC,OAAOe,KACJ9L,MACAkJ,MACA1D,QAAO,SAACC,GAAiB,IAChBuB,EAA8CvB,EAA9CuB,KAAMI,EAAwC3B,EAAxC2B,YAAaF,EAA2BzB,EAA3ByB,OAAQH,EAAmBtB,EAAnBsB,KAAMS,EAAa/B,EAAb+B,SACzC,OACGR,GAAQA,EAAK+D,cAAczE,QAAQ2P,IAAkB,GAClD7O,GAAeA,EAAY2D,cAAczE,QAAQ2P,IAAkB,GACnE/O,GAAUA,EAAO6D,cAAczE,QAAQ2P,IAAkB,IAG7DZ,EAAQtO,KAEPoO,IAA6B,IAAb3N,GACb4N,IAAgC,IAAb5N,U,GAnCgDiF,a,UCPpEyJ,GAAyD,SAAClW,GAAW,IACxEyF,EAAoCzF,EAApCyF,KAAM0Q,EAA8BnW,EAA9BmW,WAAYtE,EAAkB7R,EAAlB6R,SAAUlQ,EAAQ3B,EAAR2B,IAD2C,EAGnDyU,mBAAS,GAH0C,mBAGxE9T,EAHwE,KAGhE+T,EAHgE,KAIzEC,EAAgB,SAAC1V,GACA,kBAAVA,IACTyV,EAAUzV,GAAS,GACnBiR,GAAYA,EAASjR,GAAS,KAIlC,OACE,oCACE,kBAAC,KAAD,eACE0S,aAAc,EACd1S,MAAO0B,EACPZ,IAAK,EACLC,IAAKA,GAAO8D,EAAKnD,OACjBuP,SAAUyE,GACLH,GAAc,KAErB,kBAAC,KAAD,CACEvV,MAAO0B,EACPgR,aAAc,EACd5R,IAAK,EACLC,IAAKA,GAAO8D,EAAKnD,OACjBuP,SAAUyE,EACVC,MAAO5U,GAAO8D,EAAKnD,QAAU,KAAO,OA2C7BkU,GAhCyC,SAACxW,GAAW,IAC1DyF,EAAoCzF,EAApCyF,KAAM0O,EAA8BnU,EAA9BmU,SAAUsC,EAAoBzW,EAApByW,WAAY9U,EAAQ3B,EAAR2B,IAC9B+U,EAAU/U,GAAOA,GAAO,IAAQA,GAAO8D,EAAKnD,QAAUmD,EAAKnD,QAAU,EACrE4J,EAAQwK,EAAM,iFACG/U,GAAO8D,EAAKnD,OADf,iBAEhB,8CAEAA,EAAS,EAEbqU,KAAMC,QAAN,aACE1K,MAAOA,EACPD,UAAW,eACXoI,QAASqC,GACP,kBAAC,GAAD,iBACM1W,EADN,CAEE6R,SAAU,SAACjR,GACY,kBAAVA,IAAoB0B,EAAS1B,OAI9CiW,KAAM,SAACC,GACL3C,GAAYA,EAAS7R,GACrBwU,KAEFhJ,OAAQ,uCACRC,WAAY,uCACZgJ,cAAc,EACdxC,UAAU,GACNkC,GAAc,MCjDTO,GAAb,4MACEnX,MADF,2BAEO,EAAKoV,cAFZ,IAGIgC,cAAc,EACdC,YAAa,KACbC,YAAa,KALjB,EAQE1H,kBAAoB,WAClB3K,GAAQsS,SAAS,KATrB,EAYEvB,gBAAkB,iBAAM,CACtB,kBAAC,KAAD,CACE/U,IAAI,UACJiL,QAAS,kBAAM,EAAKsL,oBAAmB,KAFzC,yFAMA,kBAAC,IAAD,CACEvW,IAAI,SACJ2Q,YAAY,kFACZI,SAAU,SAACZ,GAAD,OAAsC,EAAKpF,SAAS,CAAEqJ,aAAcjE,EAAEV,cAAc3P,SAC9F0W,YAAU,IAEZ,kBAAC,KAAD,CACExW,IAAI,UACJ+T,QAAS,EAAKS,WAAW,EAAKzV,OAC9BiV,QAAS,CAAC,UAEV,kBAAC,KAAD,KACE,kBAACyC,GAAA,EAAD,QAGJ,kBAAC,IAAD,CACEzW,IAAI,cACJoL,MAAM,6LAEN,kBAAC,KAAD,CACEtL,MAAO,EAAKf,MAAMsX,YAClBzV,IAAK,EACLC,IAAK,GACLkQ,SAAU,SAACsF,GAAD,OAA0B,EAAKtL,SAAS,CAAEsL,YAAaA,GAAe,UA1CxF,EA+CEK,aAA2B,CACzB,CACElW,MAAO,iCACPyK,QAAS,SAACtG,GAAD,OAAiB+Q,GAAY,CACpC/Q,KAAMA,EACN9D,IAAK,IACLwS,SAAU,SAAC7R,GAAD,OACRwC,GAAQ2S,SAAS,CACf3Q,GAAIrB,EAAKqB,GACT6B,IAAK,EAAK3I,MAAM2I,IAChB+O,SAAUjS,EAAKsB,KACfzE,eAGNqS,UAAW,SAAClP,GAAD,OAAiBA,EAAK+B,UAAYoN,QAAQ,EAAK5U,MAAMiJ,aAAe,EAAKjJ,MAAMiJ,YAAYQ,WAExG,CACEnI,MAAO,iFACPyK,QAAS,SAACtG,GAAD,OAAiB,EAAKkS,kBAAkBlS,IACjDkP,UAAW,SAAClP,GAAD,OAAiBmP,QAAS,EAAK5U,MAAM2I,MAAQlD,EAAKQ,SAAWR,EAAK+B,UAAc,EAAKxH,MAAMiJ,aAAe,EAAKjJ,MAAMiJ,YAAYQ,WAE9I,CACEnI,MAAO,oDACPyK,QAAS0J,QAAQC,IACjBf,UAAW,kBAAMC,QAAQ,EAAK5U,MAAMiJ,aAAe,EAAKjJ,MAAMiJ,YAAYQ,WAE5E,CACEnI,MAAO,6CACPyK,QAAS,SAACtG,GAAD,OAAiB,EAAKmS,YAAYnS,IAC3CkP,UAAW,SAAClP,GAAD,OAAiBmP,QAAS,EAAK5U,MAAM2I,MAAQlD,EAAKQ,SAAWR,EAAK+B,UAAc,EAAKxH,MAAMiJ,aAAe,EAAKjJ,MAAMiJ,YAAYQ,YA5ElJ,EAgFE4N,mBAAqB,eAACJ,EAAD,wDAA0B,EAAKpX,MAAMoX,aAArC,OACnB,EAAKpL,SAAS,CAAEoL,kBAjFpB,EAmFEU,kBAAoB,SAAClS,GAAD,OAClB,EAAKoG,SAAS,CAAEqL,YAAazR,GAAQ,QApFzC,EAsFEoS,aAAe,SAACpS,GACdX,GAAQ4D,QAAQ,CAAEjD,SAClB,EAAK4R,oBAAmB,GACxB,EAAKM,kBAAkB,OAzF3B,EA4FEG,YAAc,WAAO,IAAD,EACoB,EAAKjY,MAAnCoX,EADU,EACVA,aAAcC,EADJ,EACIA,YACdjO,EAAgB,EAAKjJ,MAArBiJ,YACFQ,KAAaR,IAAeA,EAAYQ,SAE9C,OACE,oCACE,kBAAC,GAAD,CACEkC,QAASsL,EACT3C,QAAS,kBAAM,EAAK+C,oBAAmB,IACvClD,SAAU,EAAK0D,aACfpO,QAASA,IAEX,kBAAC,GAAD,CACEkC,UAAWuL,EACX5C,QAAS,kBAAM,EAAKqD,kBAAkB,OACtCxD,SAAU,EAAK0D,aACfpS,KAAMyR,QAAelN,EACrBP,QAASA,MA9GnB,EAoHEmO,YAAqC,SAACnS,GAAD,OAAiBkR,KAAMC,QAAQ,CAClE1K,MAAO,6CACPmI,QAAS,8OACT0C,cAAc,EACdjJ,OAAQ,6CACRC,WAAY,uCACZ8I,KAAM,SAACC,GACLhS,GAAQiT,WAAW,CAAEjR,GAAIrB,EAAKqB,KAC9BgQ,QA5HN,EAgIEf,WAAa,SAAC7M,GAAoB,IACxBD,EAAgB,EAAKjJ,MAArBiJ,YACR,OACE,kBAAC,GAAD,CACEC,MAAOA,EACPD,YAAaA,EACbwL,SAAU,EAAK+C,gBAtIvB,EA2IEQ,iBAAmB,WAAO,IAAD,EACe,EAAKhY,MAAnCoJ,EADe,EACfA,iBAAkBL,EADH,EACGA,QAClBf,EAAwFoB,EAAxFpB,OAAQI,EAAgFgB,EAAhFhB,aAAcD,EAAkEiB,EAAlEjB,gBAAiBD,EAAiDkB,EAAjDlB,gBAAiBD,EAAgCmB,EAAhCnB,QAASI,EAAuBe,EAAvBf,aAAcC,EAASc,EAATd,KACvF,OAAON,GACL,yBAAKiE,UAAU,uBACb,qFAAmBjE,GACnB,+KAAkCC,EAAU,uCAAW,2DACvD,+IAA2BC,GAC3B,mIAAyBC,GACzB,uKAA+BC,GAC/B,2JAA6BC,GAC7B,kBAAC,KAAD,CACE0D,QAAS,kBAAMjH,GAAQoG,mBAAmB,CAAEhB,MAAO,SAAUtJ,MAAO,MACpEI,UAAWsH,GAAQS,GAFrB,wCAMA,4BACEkD,UAAU,SACVF,QAAS,kBAAMjH,GAAQoG,mBAAmB,CAAEhB,MAAO,SAAUtJ,MAAO,MACpEI,SAAU+H,MA/JpB,EAqKEiN,SAAW,kBAAO,EAAKhW,MAAM+I,SAAZ,qKAAwD,EAAK/I,MAAMkJ,MAAM3F,SArK5F,EAuKEuJ,UAAY,SAAC5D,GAAiC,IACpCiO,EAAgB,EAAKtX,MAArBsX,YACApO,EAAY,EAAK/I,MAAjB+I,QACR,OACE,oCACG,EAAK+O,cACL,EAAKE,oBACJjP,GACA,kBAAC,KAAD,CACEkD,UAAU,oBACVF,QAAS,kBAAMjH,GAAQmT,aAAa,CAAE3V,OAAQ6U,EAAae,SAAUhP,EAAMA,EAAM3F,OAAS,OAF5F,0DAIa4T,EAJb,kBA/KV,YAA2BnC,IAuMZpV,gBAZS,SAACC,GAGvB,MAAO,CACLkJ,QAH6DlJ,EAAvDkJ,QAINE,YAJ6DpJ,EAA9CoJ,YAKfN,IAL6D9I,EAAjC8I,IAM5BO,MAN6DrJ,EAA5BqJ,MAOjCE,iBAP6DvJ,EAArBuJ,oBAW7BxJ,CAAyBoX,ICtNlCmB,I,mNACJ1I,kBAAoB,WAClB3K,GAAQsT,iBAAiB,K,EAG3BtI,mBAAqB,WAAO,IAAD,EACe,EAAK9P,MAArCqY,EADiB,EACjBA,YAAarP,EADI,EACJA,OADI,EACGD,SAEZsP,EAAY9U,OAAS,GACnC8U,EAAYrT,SAAQ,SAAC2D,GACdK,EAAML,IACT7D,GAAQkL,QAAQ,CAAErH,Y,EAK1BuE,OAAS,WAAO,IAAD,EAC2B,EAAKlN,MAArCqY,EADK,EACLA,YAAarP,EADR,EACQA,MAAO+C,EADf,EACeA,QAEtBuM,EAAaD,EAChB7S,QAAO,SAACmD,GAAD,OAAiBK,EAAML,IAAQK,EAAML,GAAKA,OACjDhI,KAAI,SAACgI,GAAD,OAAiBK,EAAML,MAE9B,OACE,kBAAC,IAAD,CAAMsD,UAAU,gBACbqM,EAAW3X,KAAI,SAAC4H,GAAD,OACd,yBACE0D,UAAU,qBACVnL,IAAKyH,EAAKI,IACVoD,QAAS,kBAAMA,EAAQxD,KAErB,yBAAK0D,UAAS,6BAAwBrI,EAAS2E,EAAKe,YAAc,SAAW,KAC3E,kBAAC,GAAD,CACEE,OAAQjB,EAAKiB,OACbD,SAAUhB,EAAKgB,WAEjB,yBAAK0C,UAAU,0BACZ1D,EAAKgB,UAAYhB,EAAKI,MAG1BJ,EAAKe,YACJ,yBAAK2C,UAAU,wBACZtH,EAAY4D,EAAKe,mB,YA1CNmD,cA+Df7M,gBAXS,SAACC,GAAmB,IAClCsJ,EAAuCtJ,EAAvCsJ,cAAeR,EAAwB9I,EAAxB8I,IAAKI,EAAmBlJ,EAAnBkJ,QAE5B,MAAO,CACLC,MAH6CnJ,EAAVmJ,MAInCqP,YAAavO,OAAO0J,KAAKrK,GACzBR,MACAI,aAIWnJ,CAAyBuY,ICjDlCI,G,4MACJ1Y,M,2BACK,EAAKoV,c,IACRiC,YAAa,KACbsB,SAAU,O,EAGZ/I,kBAAoB,WAAO,IAAD,EACF,EAAKzP,MAAnBuI,EADgB,EAChBA,KAAMI,EADU,EACVA,KACTJ,GAAQI,GACX7D,GAAQkL,QAAQ,CAAErH,S,EAItBkN,gBAAkB,iBAAM,CACtB,kBAAC,IAAD,CACE/U,IAAI,SACJ2Q,YAAY,kFACZI,SAAU,SAACZ,GAAD,OAAsC,EAAKpF,SAAS,CAAEqJ,aAAcjE,EAAEV,cAAc3P,SAC9F0W,YAAU,IAEZ,kBAAC,KAAD,CACExW,IAAI,UACJ+T,QAAS,EAAKS,WAAW,EAAKzV,OAC9BiV,QAAS,CAAC,UAEV,kBAAC,KAAD,KACE,kBAACyC,GAAA,EAAD,QAGJ,EAAKkB,iB,EAGPC,kBAAoB,SAACxP,GAAoB,IAAD,EACP,EAAKlJ,MAA5B0J,EAD8B,EAC9BA,UAAWX,EADmB,EACnBA,QAEnB,GAAIW,IAAcX,EAAS,CACzB,IAAM4P,EAAiB7O,OAAOC,OAAOL,GAC/BkP,EAAuB,GACvBC,EAA2B,GAoBjC,OAlBAF,EACG3T,SAAQ,SAAC8T,GAAmB,IACnBhS,EAAOgS,EAAPhS,GACFrB,EAAOyD,EAAMmE,MAAK,SAAC5H,GAAD,OAAiBA,EAAKqB,KAAOA,KACjDrB,EACFmT,EAAYG,KAAZ,2BACKtT,GACAqT,IAGLD,EAAeE,KAAKjS,MAItB+R,EAAetV,OAAS,GAC1BuB,GAAQyI,YAAY,CAAEzG,GAAI+R,EAAeG,UAGpCJ,EAGT,MAAO,I,EAGTJ,SAAW,SAAC/S,GAAD,OACT,EAAKoG,SAAS,CAAE2M,SAAU/S,GAAQ,Q,EAEpCgT,aAAe,WAAO,IACZD,EAAa,EAAK3Y,MAAlB2Y,SACR,OACE,kBAAC,KAAD,CACE1X,IAAI,aACJ6K,UAAW6M,EACXpM,UAAU,GAEV,kBAAC,GAAD,CAAiBL,QAAS,SAACxD,GACR,OAAbiQ,IACF1T,GAAQ0T,SAAS,CACf7P,IAAK,EAAK3I,MAAM2I,IAEhB7B,GAAI0R,EAAS1R,GACbzF,GAAIkH,EACJ9C,KAAM+S,IAER,EAAKA,SAAS,Y,EAOxBS,sBAAwB,SAACxT,GAAD,OACtB,6BACE,6QACA,6BAFF,IAEQ,6BAFR,IAEc,6BACZ,kBAAC,KAAD,CACE4F,MAAO,CAAEkB,MAAO,0BAChBR,QAAS,WACPjH,GAAQiI,WAAW,CAAEjG,GAAIrB,EAAKqB,GAAI6B,IAAK,EAAK3I,MAAM2I,MAClDjC,IAAOwS,QAAQ,gDAJnB,yE,EAUJ1B,aAA2B,CACzB,CACElW,MAAO,mDACPyK,QAAS,SAACtG,GAAD,OAAiB+Q,GAAY,CACpC/Q,KAAMA,EACN0O,SAAU,SAAC7R,GAAD,OAAoBwC,GAAQ0T,SAAS,CAC7C1R,GAAIrB,EAAKqB,GACT6B,IAAK,EAAK3I,MAAM2I,IAChBwQ,aAAa,EACb1T,KAAK,2BACAA,GADD,IAEFnD,kBAKR,CACEhB,MAAO,2EACPyK,QAAS,SAACtG,GAAD,OAAiBkR,KAAMC,QAAQ,CACtC1K,MAAM,4EAAD,OAAkBtE,EAAYnC,GAAM,GAApC,KACLoR,KAAM,SAACC,GACLhS,GAAQ0T,SAAS,CACf1R,GAAIrB,EAAKqB,GACT6B,IAAK,EAAK3I,MAAM2I,IAChBlD,KAAK,2BACAA,GADD,IAEFnD,OAAQ,IAEV8W,KAAK,IAEPtC,KAEFhJ,OAAQ,eACRC,WAAY,0CAEd4G,UAAW,SAAClP,GAAD,MAA+B,WAAdA,EAAKsB,OAEnC,CACEzF,MAAO,yDACPyK,QAAS,SAACtG,GAAD,OAAiB+Q,GAAY,CACpC/Q,KAAMA,EACN0O,SAAU,SAAC7R,GAAD,OAAoBwC,GAAQ0T,SAAS,CAC7C1R,GAAIrB,EAAKqB,GACT6B,IAAK,EAAK3I,MAAM2I,IAChBlD,KAAK,2BACAA,GADD,IAEFnD,kBAKR,CACEhB,MAAO,mDACPyK,QAAS,SAACtG,GAAD,OAAiB+Q,GAAY,CACpC/Q,KAAMA,EACN0O,SAAU,SAAC7R,GAAD,OAAoB,EAAKkW,SAAL,2BAAmB/S,GAAnB,IAAyBnD,iBAG3D,CACEhB,MAAO,oDACPyK,QAAS0J,QAAQC,IACjBf,UAAW,kBAAMC,QAAQ,EAAK5U,MAAMiJ,aAAe,EAAKjJ,MAAMiJ,YAAYQ,WAE5E,CACEnI,MAAO,uCACPyK,QAAS,SAACtG,GAAD,OAAiB+Q,GAAY,CACpC/Q,KAAMA,EACN0O,SAAU,SAAC7R,GAAD,OACRwC,GAAQiI,WAAW,CAAEjG,GAAIrB,EAAKqB,GAAI6B,IAAK,EAAK3I,MAAM2I,IAAKrG,eAE3DqS,UAAW,kBAAMC,QAAQ,EAAK5U,MAAMiJ,aAAe,EAAKjJ,MAAMiJ,YAAYQ,Y,EAI9EuM,SAAW,mBAAQ,EAAKhW,MAAMuI,MAAb,sGAAyC,EAAKvI,MAAMuI,KAAKgB,UAAY,EAAKvJ,MAAMuI,KAAKI,M,EAEtGoN,WAAa,SAAC7M,GAAoB,IAAD,EACF,EAAKlJ,MAA1BiJ,EADuB,EACvBA,YAAaN,EADU,EACVA,IAErB,OACE,kBAAC,GAAD,CACEA,IAAKA,EACLM,YAAaA,EACbC,MAAO,EAAKwP,kBAAkBxP,GAC9BuL,SAAWxL,IAAgBA,EAAYN,MAAQA,GAAOM,EAAYQ,SAC9D,EAAK+N,kBACLxN,K,YAhMYgL,IA+NTpV,gBAxBS,SAACC,EAAeG,GAA4B,IAC1D+I,EAAgElJ,EAAhEkJ,QAASC,EAAuDnJ,EAAvDmJ,MAAOC,EAAgDpJ,EAAhDoJ,YAAaC,EAAmCrJ,EAAnCqJ,MAAO3D,EAA4B1F,EAA5B0F,SAAU4D,EAAkBtJ,EAAlBsJ,cAEhDR,EAAM,IAAI+K,gBAAgB1T,EAAMkC,MAAMiM,QAAQE,IAAI,QAAUxO,EAAM8I,KAAO,IACzEJ,EAAOS,EAAML,GAOnB,OANIJ,IAASA,EAAKI,KAAOA,IACvBJ,EAAKI,IAAMA,GAKN,CACLI,UACAJ,MACAO,QACAQ,UANgBnB,EAAOA,EAAKmB,UAAY,GAOxCnB,OACAU,cACAD,QACAzD,WACA4D,mBAIWvJ,CAAyB2Y,I,UC7L3Bc,I,OAAwB,CACnCC,OAAQ,EACRC,KAAM,EACNC,MAAO,IAGIC,GAA+B,CAC1CC,QAAS,CACPC,SAAUN,GACVO,WAAYP,GACZQ,UAAWR,GACXS,SAAUT,GACVU,aAAcV,GACdW,QAASX,GACTY,KAAMZ,IAERa,OAAQ,CACNC,UAAWd,GACXe,QAASf,GACTgB,WAAYhB,GACZiB,QAASjB,GACTkB,aAAclB,GACdmB,SAAUnB,GACVoB,MAAOpB,GACPqB,SAAUrB,GACVsB,MAAOtB,GACPuB,MAAOvB,GACPwB,QAASxB,GACTyB,OAAQzB,GACR0B,OAAQ1B,GACR2B,OAAQ3B,GACR4B,SAAU5B,IAEZlM,MAAO,CACL+N,MAAO,EACPC,WAAY,EACZC,IAAK,EACLC,YAAa,EACbC,OAAQ,GAERC,gBAAiB,EACjBC,aAAc,EACdC,WAAYpC,GACZqC,YAAa,EACbC,WAAY,EACZC,aAAc,EACdC,SAAU,EACVC,YAAa,EACbC,eAAgB,EAChBC,YAAa,EACbC,iBAAkB,GAEpBC,IAAK,IAGMxC,GAAoB,CAC/B,CACEpY,MAAO,KACP6a,KAAM,2BACNjS,MAAO,YAET,CACE5I,MAAO,KACP6a,KAAM,+DACNjS,MAAO,cAET,CACE5I,MAAO,KACP6a,KAAM,2EACNjS,MAAO,aAET,CACE5I,MAAO,KACP6a,KAAM,6CACNjS,MAAO,YAET,CACE5I,MAAO,KACP6a,KAAM,yDACNjS,MAAO,gBAET,CACE5I,MAAO,KACP6a,KAAM,mDACNjS,MAAO,WAET,CACE5I,MAAO,KACP6a,KAAM,iCACNjS,MAAO,SAIEgQ,GAAmB,CAC9B,CACE5Y,MAAO,aACP6a,KAAM,uCACNC,QAAS,WACTlS,MAAO,YACPmS,QAAS,SAACC,GAAD,OAAO,EAAK,EAAIA,EAAEC,KAE7B,CACEjb,MAAO,WACP6a,KAAM,kFACNC,QAAS,SACTlS,MAAO,UACPmS,QAAS,SAACC,GAAD,OAAQ,EAAIA,EAAEC,KAEzB,CACEjb,MAAO,cACP6a,KAAM,4HACNC,QAAS,SACTlS,MAAO,aACPmS,QAAS,SAACC,GAAD,OAAQ,EAAIA,EAAEC,KAEzB,CACEjb,MAAO,UACP6a,KAAM,0DACNC,QAAS,mBACTlS,MAAO,UACPmS,QAAS,SAACC,GAAD,OAAO,GAAM,GAAKA,EAAEC,GAAKD,EAAEE,MAEtC,CACElb,MAAO,QACP6a,KAAM,wFACNC,QAAS,iBACTlS,MAAO,eACPmS,QAAS,SAACC,GAAD,OAAO,GAAM,GAAKA,EAAEC,GAAKD,EAAEE,MAEtC,CACElb,MAAO,WACP6a,KAAM,mDACNC,QAAS,mBACTlS,MAAO,WACPmS,QAAS,SAACC,GAAD,OAAO,GAAKA,EAAEG,GAAKH,EAAEI,GAAM,EAAIJ,EAAEC,MAE5C,CACEjb,MAAO,QACP6a,KAAM,+DACNC,QAAS,WACTlS,MAAO,QACPmS,QAAS,SAACC,GAAD,OAAO,EAAK,EAAIA,EAAEC,KAE7B,CACEjb,MAAO,WACP6a,KAAM,iCACNC,QAAS,aACTlS,MAAO,WACPmS,QAAS,SAACC,GAAD,OAAO,IAAMA,EAAEG,GAAKH,EAAEC,MAEjC,CACEjb,MAAO,QACP6a,KAAM,iCACNC,QAAS,SACTlS,MAAO,QACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEC,KAExB,CACEjb,MAAO,QACP6a,KAAM,6CACNC,QAAS,aACTlS,MAAO,QACPmS,QAAS,SAACC,GAAD,OAAO,IAAMA,EAAEG,GAAKH,EAAEC,MAEjC,CACEjb,MAAO,UACP6a,KAAM,iCACNC,QAAS,SACTlS,MAAO,UACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEK,KAExB,CACErb,MAAO,SACP6a,KAAM,uCACNC,QAAS,SACTlS,MAAO,SACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEK,KAExB,CACErb,MAAO,SACP6a,KAAM,qEACNC,QAAS,SACTlS,MAAO,SACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEM,KAExB,CACEtb,MAAO,SACP6a,KAAM,uCACNC,QAAS,SACTlS,MAAO,SACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEM,KAExB,CACEtb,MAAO,WACP6a,KAAM,yDACNC,QAAS,cACTlS,MAAO,WACPmS,QAAS,SAACC,GAAD,OAAO,GAAKA,EAAEI,GAAKJ,EAAEK,OAIrBxP,GAAkB,CAC7B,CACE7L,MAAO,QACP6a,KAAM,6CACNjS,MAAO,QACPmS,QAAS,SAACQ,EAAG1P,GAAJ,OAAevL,KAAKkb,KAAO3P,EAAMiO,IAAM,IAAO,EAAK,GAAK,GAAK,IAExE,CACE9Z,MAAO,WACP6a,KAAM,0DACNjS,MAAO,aACPmS,QAAS,SAACC,GAAD,OAAO,EAAI1a,KAAKC,MAAMya,EAAEI,GAAK,KAExC,CACEpb,MAAO,aACP6a,KAAM,2BACNjS,MAAO,OAET,CACE5I,MAAO,eACP6a,KAAM,wFACNjS,MAAO,cACPmS,QAAS,SAACC,GAAD,OAAO,GAAM,GAAKA,EAAEE,KAE/B,CACElb,MAAO,SACP6a,KAAM,2BACNjS,MAAO,WAIE6S,GAAqB,CAChC,CACEzb,MAAO,SACP6a,KAAM,qHACNjS,MAAO,kBACPmS,QAAS,SAACC,EAAGnP,GAAJ,OAAe,IAAMmP,EAAEE,GAAM,EAAIF,EAAEI,IAASvP,EAAMgO,WAAahO,EAAM+N,QAEhF,CACE5Z,MAAO,gBACP6a,KAAM,2FACNjS,MAAO,gBAET,CACE5I,MAAO,eACP6a,KAAM,gEACNjS,MAAO,aACPmS,QAAS,SAACC,GAAD,OAAOA,EAAEC,KAEpB,CACEjb,MAAO,eACP6a,KAAM,qEACNjS,MAAO,cACPmS,QAAS,SAACC,GAAD,OAAO1a,KAAKC,MAAMya,EAAEI,GAAK,KAEpC,CACEpb,MAAO,eACP6a,KAAM,iFACNjS,MAAO,aACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEI,KAExB,CACEpb,MAAO,eACP6a,KAAM,4EACNjS,MAAO,eACPmS,QAAS,SAACC,GAAD,OAAO,EAAI1a,KAAKob,KAAKV,EAAEC,GAAK,KAEvC,CACEjb,MAAO,eACP6a,KAAM,+DACNjS,MAAO,WACPmS,QAAS,SAACC,GAAD,OAAO,EAAIA,EAAEG,KAExB,CACEnb,MAAO,eACP6a,KAAM,wFACNjS,MAAO,cACPmS,QAAS,SAACC,GAAD,OAAO1a,KAAKD,IAAI,EAAG2a,EAAEE,GAAK,KAErC,CACElb,MAAO,eACP6a,KAAM,0DACNjS,MAAO,iBACPmS,QAAS,SAACC,GAAD,OAAOA,EAAEW,KAEpB,CACE3b,MAAO,eACP6a,KAAM,sEACNjS,MAAO,cACPmS,QAAS,SAACC,EAAGnP,GAAJ,OAAgBA,EAAM+N,MAAQ,IAAM,EAAK,EAAIoB,EAAEK,IAAOxP,EAAM8O,oBChUnEiB,G,4MACJrd,MAAQ,CAAEsd,KAAM1D,I,EAEhBhK,kBAAoB,WAAO,IAAD,EACF,EAAKzP,MAAnBuI,EADgB,EAChBA,KAAMI,EADU,EACVA,IACTJ,GACHzD,GAAQkL,QAAQ,CAAErH,S,EAItByU,WAAa,WAAO,IACVtK,EAAa,EAAK9S,MAAlB8S,SAER,OACE,kBAAC,KAAD,CAAM7G,UAAU,gBACd,yBAAKA,UAAU,qBACb,0BAAMA,UAAU,uBAChB,yBAAKA,UAAU,4BAAf,SAGA,yBAAKA,UAAU,sBAAf,OAGA,yBAAKA,UAAU,sBAAf,SAIDoR,GAAc1c,KAAI,gBAAGW,EAAH,EAAGA,MAAO6a,EAAV,EAAUA,KAAMjS,EAAhB,EAAgBA,MAAhB,OACjB,yBACEpJ,IAAKQ,EACL2K,UAAU,qBAEV,kBAAC,IAAD,CAASC,MAAOiQ,GACd,0BAAMlQ,UAAU,sBAAsB3K,IAExC,kBAAC,KAAKT,KAAN,CAAWmG,KAAM,CAAC,UAAWkD,EAAO,UAClC,kBAAC,IAAD,CACE+B,UAAU,2BACV+G,UAAQ,EACRtR,IAAK,EACLC,IAAK,EACLX,UAAW8R,KAGf,kBAAC,KAAKjS,KAAN,CAAWmG,KAAM,CAAC,UAAWkD,EAAO,WAClC,kBAAC,KAAD,CACE+B,UAAU,qBACVvK,IAAK,EACLC,IAAK,EACLX,UAAW8R,KAGf,kBAAC,KAAKjS,KAAN,CAAWmG,KAAM,CAAC,UAAWkD,EAAO,SAClC,kBAAC,KAAD,CACE+B,UAAU,qBACVvK,IAAK,EACLC,IAAK,EACLX,UAAW8R,W,EAUzBwK,UAAY,WAAO,IACTxK,EAAa,EAAK9S,MAAlB8S,SAGFyK,EAFY,EAAK1d,MAAMsd,KAArBhQ,MAEoB6O,aAAe,EAC3C,OACE,kBAAC,KAAD,CAAM/P,UAAU,eACd,yBAAKA,UAAU,oBACb,0BAAMA,UAAU,sBAChB,yBAAKA,UAAU,2BAAf,SAGA,yBAAKA,UAAU,qBAAf,OAGA,yBAAKA,UAAU,qBAAf,SAIDuR,GAAa7c,KAAI,gBAAGW,EAAH,EAAGA,MAAO6a,EAAV,EAAUA,KAAMC,EAAhB,EAAgBA,QAASlS,EAAzB,EAAyBA,MAAzB,OAChB,yBACEpJ,IAAKoJ,EACL+B,UAAU,oBAEV,kBAAC,IAAD,CAASC,MAAOiQ,GACd,0BAAMlQ,UAAU,qBAAqB3K,IAEvC,kBAAC,KAAKT,KAAN,CAAWmG,KAAM,CAAC,SAAUkD,EAAO,UACjC,kBAAC,IAAD,CACE+B,UAAU,oBACV+G,UAAQ,EACRhS,UAAW8R,KAGf,kBAAC,KAAKjS,KAAN,CAAWmG,KAAM,CAAC,SAAUkD,EAAO,WACjC,kBAAC,KAAD,CACE+B,UAAU,oBACVjL,UAAW8R,EACXpR,IAAK,EACLC,IAAK,GACLqR,SAAUuK,KAGd,kBAAC,IAAD,CAASrR,MAAOkQ,GACd,kBAAC,KAAKvb,KAAN,CAAWmG,KAAM,CAAC,SAAUkD,EAAO,SACjC,kBAAC,IAAD,CACE+B,UAAU,oBACV+G,UAAQ,EACRhS,UAAW8R,Y,EAU3BpG,SAAW,WAAO,IACRoG,EAAa,EAAK9S,MAAlB8S,SAER,OACE,kBAAC,KAAD,CAAM7G,UAAU,cACbwR,GAAY9c,KAAI,gBAAGW,EAAH,EAAGA,MAAO6a,EAAV,EAAUA,KAAMjS,EAAhB,EAAgBA,MAAOmS,EAAvB,EAAuBA,QAAvB,OACf,yBACEvb,IAAKoJ,EACL+B,UAAU,mBAEV,kBAAC,IAAD,CAASC,MAAOiQ,GACd,0BAAMlQ,UAAU,oBAAoB3K,IAEtC,kBAAC,KAAKT,KAAN,CAAWmG,KAAM,CAAC,QAASkD,IACd,WAAVA,EAEG,kBAAC,IAAMsH,SAAP,CACEvF,UAAU,mBACVjL,UAAW8R,IAGXuJ,EAEE,kBAAC,IAAD,CACEpQ,UAAU,mBACV+G,UAAQ,EACRhS,UAAW8R,IAGb,kBAAC,KAAD,CACE7G,UAAU,mBACVvK,IAAK,EACLC,IAAK+F,OAAOgW,iBACZ1c,UAAW8R,W,EAUjC6K,aAAe,WAAO,IACZ7K,EAAa,EAAK9S,MAAlB8S,SAER,OACE,kBAAC,KAAD,CAAM7G,UAAU,mBACd,yBAAKA,UAAU,0BACb,yBAAKA,UAAU,sBACb,0BAAMA,UAAU,4BAAhB,4FACA,yBAAKA,UAAU,2BACb,kBAAC,KAAKpL,KAAN,CAAWmG,KAAM,CAAC,QAAS,iBACzB,kBAAC,KAAD,CACErF,IAAK,EAAK9B,MAAMsd,KAAKhQ,MAAMoO,gBAC3B7Z,KAAME,KAAKC,MAAM,EAAKhC,MAAMsd,KAAKhQ,MAAMoO,gBAAkB,GACzDva,UAAW8R,KALjB,IASE,kBAAC,KAAKjS,KAAN,CAAWmG,KAAM,CAAC,QAAS,oBACzB,kBAAC,IAAD,CACEgM,UAAQ,EACRhS,UAAW8R,OAKnB,yBAAK7G,UAAU,8BACb,yBAAKA,UAAU,sBACb,kBAAC,IAAD,CAASC,MAAM,gFACb,yBAAKD,UAAU,4BAAf,iBAIF,yBAAKA,UAAU,6BAAf,OAGA,yBAAKA,UAAU,2BAAf,SAIF,yBAAKA,UAAU,sBACb,kBAAC,KAAKpL,KAAN,CAAWmG,KAAM,CAAC,QAAS,aAAc,UACvC,kBAAC,IAAD,CACEiF,UAAU,2BACV+G,UAAQ,EACRhS,UAAW8R,KAGf,kBAAC,KAAKjS,KAAN,CAAWmG,KAAM,CAAC,QAAS,aAAc,WACvC,kBAAC,KAAD,CACEiF,UAAU,4BACVvK,IAAK,EACLC,IAAK,GACLX,UAAW8R,KAGf,kBAAC,KAAKjS,KAAN,CAAWmG,KAAM,CAAC,QAAS,aAAc,SACvC,kBAAC,IAAD,CACEiF,UAAU,0BACV+G,UAAQ,EACRhS,UAAW8R,QAMrB,yBAAK7G,UAAU,wBACZ2R,GAAeC,MAAM,GAAGld,KAAI,gBAAGW,EAAH,EAAGA,MAAO6a,EAAV,EAAUA,KAAMjS,EAAhB,EAAgBA,MAAhB,OAC3B,yBACEpJ,IAAKoJ,EACL+B,UAAU,wBAEV,kBAAC,IAAD,CAASC,MAAOiQ,GACd,0BAAMlQ,UAAU,8BAA8B3K,IAEhD,kBAAC,KAAKT,KAAN,CAAWmG,KAAM,CAAC,QAASkD,IACzB,kBAAC,IAAD,CACE+B,UAAU,6BACV+G,UAAQ,EACRhS,UAAW8R,Y,EAU3BjB,SAAwC,SAACjR,EAAOuc,GAC9C,EAAKtR,SAAS,CAAEsR,KAAM,EAAKW,YAAYld,EAAOuc,M,EAIhDW,YAAc,SAACld,EAAcuc,GAAiB,IACpCzD,EAAgCyD,EAAhCzD,QAASQ,EAAuBiD,EAAvBjD,OAAQ/M,EAAegQ,EAAfhQ,MAAO+O,EAAQiB,EAARjB,IAEhC,IAAKtb,EAAMsb,IAAK,CACd,IAAM6B,EAA0C,GAChDV,GAAcrY,SAAQ,YAAuB,IAApBkF,EAAmB,EAAnBA,MAAO5I,EAAY,EAAZA,MAExBV,EAAyB8Y,EAAQxP,GACjCsP,EAAQ5X,KAAKD,IAAI,EAAGC,KAAKF,IAAI,EAAGd,EAAM2Y,KAAO3Y,EAAM0Y,SAEzDI,EAAQxP,GAAR,2BACKtJ,GADL,IAEE4Y,UAEFuE,EAAazc,EAAMyJ,eAAiByO,KAGtCrM,EAAM8O,iBAAmB,EACzBuB,GAAaxY,SAAQ,YAAyB,IAAtBkF,EAAqB,EAArBA,MAAOmS,EAAc,EAAdA,QAEvBzb,EAAyBsZ,EAAOhQ,GAChCoP,EAAS1X,KAAKD,IAAI,EAAGf,EAAM0Y,QAC3BC,EAAO3X,KAAKD,IAAI,EAAG0a,EAAUA,EAAQ0B,EAAc5Q,GAAS,GAC5DqM,EAAQ5X,KAAKD,IAAI,EAAGC,KAAKF,IAAI,GAAI6X,EAAOD,IAE9CY,EAAOhQ,GAAS,CACdoP,SACAC,OACAC,SAEFrM,EAAM8O,kBAAqBrb,EAAM0Y,OAAS,KAG5C,sBAAImE,IAAJ,YAAoBG,KAAgB5Y,SAAQ,YAAyB,IAAtBkF,EAAqB,EAArBA,MAAOmS,EAAc,EAAdA,QACpD,GAAIA,EACF,GAAc,eAAVnS,EAAwB,CAC1B,IAAMqP,EAAO8C,EAAQ0B,EAAc5Q,GAC7BmM,EAASnM,EAAMjD,GAAOoP,OAC5BnM,EAAMjD,GAAS,CACboP,SACAC,OACAC,MAAOF,EAASC,QAGlBpM,EAAMjD,GAAStI,KAAKC,MAAMwa,EAAQ0B,EAAc5Q,OAMxD,MAAO,CACLuM,UACAQ,SACA/M,QACA+O,Q,EAIJhP,OAAS,WAAO,IAAD,EACmB,EAAKlN,MAA7BuI,EADK,EACLA,KAAMuK,EADD,EACCA,SAAUnK,EADX,EACWA,IAExB,OAAKJ,EASH,kBAAC,KAAD,CACEyV,cAAezV,EAAK0V,WAAaxE,GACjCyE,eAAgB,EAAKrM,UAErB,kBAAC,KAAD,CACE5F,UAAU,OACVC,MAAK,gGAAqB3D,EAAKgB,UAAYhB,EAAKI,KAChD2G,MACE,kBAAC,KAAD,CACEpD,MAAM,iHACN4B,OAAO,eACPC,WAAW,uCACXH,UAAW,kBAAM9I,GAAQ6N,QAAQ,CAC/BhK,MACAJ,KAAK,2BACAA,GADD,IAEF0V,UAAW,EAAKpe,MAAMsd,WAI5B,kBAAC,KAAD,+CAIF,yBAAKlR,UAAU,YACb,kBAAC,KAAKpL,KAAN,CAAWmG,KAAM,CAAC,QAClB,kBAAC,IAAMwK,SAAP,CACExQ,UAAW8R,EACXqL,UAAW,MAIf,6BACG,EAAKR,gBAER,6BACE,6BACG,EAAKP,aACL,EAAK1Q,YAER,6BACG,EAAK4Q,gBAhDZ,kBAAC,IAAD,CAAM/L,UAAQ,GACZ,kBAAC,KAAD,CAAOnK,YAAY,6I,YArULqF,aA+YT7M,gBAlBS,SAACC,EAAeG,GAA4B,IAC1D+I,EAAgClJ,EAAhCkJ,QAASC,EAAuBnJ,EAAvBmJ,MAAOC,EAAgBpJ,EAAhBoJ,YAElBN,EAAM,IAAI+K,gBAAgB1T,EAAMkC,MAAMiM,QAAQE,IAAI,QAAUxO,EAAM8I,KAAO,IACzEJ,EAAOS,EAAML,GAKnB,OAJIJ,IAASA,EAAKI,KAAOA,IACvBJ,EAAKI,IAAMA,GAGN,CACLI,UACAR,OACAI,MACAmK,WAAavK,KAAUU,IAAiBA,EAAYN,MAAQJ,EAAKI,OAASM,EAAYQ,SACtFR,iBAIWrJ,CAAyBsd,IClXzBkB,GAjDU,CACvB,CACErd,KAAM,sBACNsd,UAAW9O,IAEb,CACExO,KAAM,+BACNsd,UAAW9L,GACX+L,OAAO,GAET,CACEvd,KAAM,gCACNsd,UAAW9F,GACX+F,OAAO,GAET,CACEvd,KAAM,2BACNsd,UAAW9F,GACX+F,OAAO,GAET,CACEvd,KAAM,gCACNsd,UAAWnB,GACXoB,OAAO,GAET,CACEvd,KAAM,2BACNsd,UAAWnB,GACXoB,OAAO,GAET,CACEvd,KAAM,0BACNsd,UAAW9L,GACX+L,OAAO,GAET,CACEvd,KAAM,uBACNsd,UAAWrH,IAEb,CACEjW,KAAM,sBACNsd,UCtDW,kBACb,kBAAC,KAAD,CAAMpS,UAAU,QAAhB,odAEE,6BAAK,6BACL,kGACA,4aACwF,6BADxF,kHAEuB,6BAFvB,oFAGkB,6BAHlB,yLAIsD,6BAJtD,8EAKiB,6BALjB,wcAO8C,6BAP9C,yJAQqC,6BARrC,gQASiE,6BATjE,0EAU4B,6BAV5B,+RAWwD,6BAXxD,uUAYkE,6BAZlE,iVAakE,6BAblE,kbAcmF,6BAdnF,6OAemD,6BAfnD,uQAgBoD,6BAhBpD,qSAiByD,6BAjBzD,6QAkBqD,6BAlBrD,8RAmBuD,6BAnBvD,4IAoB6B,6BApB7B,2ZAqBgF,6BArBhF,sLAsBoC,6BAtBpC,sSAuB0D,6BAvB1D,iOAwB4C,6BAxB5C,gPAyBiD,6BAzBjD,+MA0ByC,6BA1BzC,+aA2BqF,6BA3BrF,gIA4B2B,6BA5B3B,qUA6BgE,6BA7BhE,gPA8BiD,6BA9BjD,qPA+BiD,6BA/BjD,yVAgCqE,6BAhCrE,6LAiCsC,6BAjCtC,seAkC+F,6BAlC/F,2DAmCa,6BAnCb,kQAoCoD,6BApCpD,2RAqCyD,6BArCzD,sTAsCgE,6BAtChE,6UAuCmE,6BAvCnE,sLAwCoC,6BAxCpC,uQAyCoD,6BAzCpD,KA0CI,8BAGJ,gKACA,2OACuD,6BADvD,4PAEmD,6BAFnD,iTAG2D,6BAH3D,wTAIuE,6BAJvE,2KAK6C,6BAL7C,uNAM4C,6BAN5C,mMAOuC,6BAPvC,6OAQ8C,6BAR9C,+MASyC,6BATzC,iWAUmE,6BAVnE,2IAWsC,6BAXtC,iTAYgE,6BAZhE,yRAauD,6BAbvD,0MAcyC,6BAdzC,kUAekE,6BAflE,gNAgB0C,6BAhB1C,iGAiBqB,6BAjBrB,uPAkBmD,6BAlBnD,KAmBI,8BAGJ,oCACA,gDACkB,6BADlB,kBAEiB,6BAFjB,gBAGe,6BAHf,iBAIgB,6BAJhB,YAKW,6BALX,KAMI,iCDxBN,CACElL,KAAM,wBACNsd,UAAW1K,K,UEIA/T,gBANS,SAACC,GAGvB,MAAO,CAAEkJ,QAFkBlJ,EAAnBkJ,QAEUpC,MAFS9G,EAAV8G,SAKJ/G,EA/CD,SAACI,GAAwB,IAC7B2G,EAAmB3G,EAAnB2G,MAAOoC,EAAY/I,EAAZ+I,QAEf,OACE,kBAAC,KAAD,CAAMA,QAASA,GACb,kBAAC,KAAD,CACEwV,SAAU,SAACxU,GAAD,OAAYjF,GAAQ0Z,MAAMzU,KAEpC,kBAAC,KAAKlJ,KAAN,CACES,MAAM,QACN0F,KAAK,QACLyX,MAAO,CAAC,CAAEC,UAAU,EAAMtY,QAAS,wDAEnC,kBAAC,IAAD,OAEF,kBAAC,KAAKvF,KAAN,CACES,MAAM,WACN0F,KAAK,WACLyX,MAAO,CAAC,CAAEC,UAAU,EAAMtY,QAAS,sFAEnC,kBAAC,IAAMuY,SAAP,OAEF,kBAAC,KAAK9d,KAAN,KACE,kBAAC,KAAD,CACEkG,KAAK,UACL6X,SAAS,UAFX,oCAQHjY,GACC,kBAAC,KAAD,CACEI,KAAK,QACLX,QAASO,EAAMP,cCPVxG,oBAAQ,SAACC,GAAD,MAAoB,CAAEC,WAAYD,EAAMC,cAAhDF,EA7Bf,SAAgBI,GACd,OAAKA,EAAMF,WAYT,kBAAC,IAAD,KAEIse,GAAOzd,KAAI,SAACC,GAAD,OACT,kBAAC,IAAD,CACEE,IAAKF,EAAMG,KACXA,KAAMH,EAAMG,KACZsd,UAAWzd,EAAMyd,UACjBC,MAAO1d,EAAM0d,QAAS,OAI5B,kBAAC,IAAD,CAAUjd,GAAG,yBArBb,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEN,KAAK,IACLsd,UAAWQ,SCLfC,I,qBAAa,yBAAK7S,UAAU,cAAf,cAAwC9L,OAAO2e,UAAU9T,QAAQ,IAAK,OAEnF+T,G,4MACJtP,kBAAoB7K,E,EAEpBkL,mBAAqB,WAAO,IAAD,EACI,EAAK9P,MAA1B0G,EADiB,EACjBA,OAAQuD,EADS,EACTA,SAEZvD,IACFN,IAAQ4Y,KAAKtY,GACb5B,GAAQma,cAAc,KAEpBhV,GACFnF,GAAQoa,gBAAgB,K,EAI5BC,YAAc,WAAO,IACXlV,EAAa,EAAKjK,MAAlBiK,SACR,OAAOA,GAAY,kBAAC,IAAD,CAAU5I,GAAI4I,K,EAGnCiD,OAAS,WACP,OACE,oCACG4R,GACD,kBAAC,IAAD,KACG,EAAKK,cACN,kBAAC,EAAD,MACA,yBAAKlT,UAAU,OACb,kBAAC,GAAD,U,YA5BMQ,aAqCH7M,gBADS,SAACC,GAAD,MAAoB,CAAEoK,SAAUpK,EAAMoK,SAAUvD,OAAQ7G,EAAM6G,UACvE9G,CAAyBmf,I,2ECjDlCK,GAAWC,KAAUC,cAAcC,IACnCC,GAAOJ,GAASI,OAChBC,GAAWL,GAASK,WAE1BD,GAAKE,oBAAmB,SAACnX,GACnBA,GACFzD,GAAQ6a,aAAa,CAAEpX,SACvBzD,GAAQkL,QAAQ,CAAErH,IAAKJ,EAAKI,IAAKM,aAAa,KAE9CnE,GAAQqG,OAAO,O,iBCVTqT,I,aAqBArT,I,aAOeyU,IA5BzB,SAAUpB,GAAM5U,GAAhB,8EAIiB,OAHPiW,EAAoBjW,EAApBiW,MAAOC,EAAalW,EAAbkW,SADjB,kBAIuBN,GAAKO,2BAA2BF,EAAOC,GAJ9D,OAIUvX,EAJV,OAKIzD,GAAQ6a,aAAa,CAAEpX,SACvBzE,aAAa4E,QAAQ,OAAQF,KAAKwX,UAAUzX,EAAKA,OACjDzE,aAAa4E,QAAQ,MAAOH,EAAKA,KAAKI,KAP1C,qDASI8M,QAAQ9O,MAAR,MACmB,wBAAf,KAAMsZ,KAVd,iBAWmB,OAXnB,UAWyBT,GAAKU,+BAA+BL,EAAOC,GAXpE,QAWYvX,EAXZ,OAYMzD,GAAQ6a,aAAa,CAAEpX,SACvBzE,aAAa4E,QAAQ,OAAQF,KAAKwX,UAAUzX,EAAKA,OACjDzE,aAAa4E,QAAQ,MAAOH,EAAKI,KAdvC,wBAgBM7D,GAAQqb,UAAU,CAAExZ,MAAK,OAhB/B,uDAqBA,SAAUwE,KAAV,kEAIE,OAHArH,aAAaiJ,WAAW,QACxBjJ,aAAaiJ,WAAW,OACxBjJ,aAAaiJ,WAAW,YAH1B,SAIQyS,GAAKY,UAJb,wCAOe,SAAUR,KAAV,kEACb,OADa,SACP5S,aAAI,CACRqT,aAAW,QAAS7B,IACpB6B,aAAW,SAAUlV,MAHV,wC,iBC7BLwH,I,aAgCA5N,I,aAkBAqT,I,aASewH,IA3DzB,SAAUjN,GAAQ/H,GAAlB,0EAGE,OAFQjC,EAAciC,EAAdjC,IAAKJ,EAASqC,EAATrC,KADf,SAGQkX,GACHa,IAAI,SACJC,MAAM5X,GACN6X,IAHG,2BAICjY,GAJD,IAKFe,YAAY,IAAItF,MAAOC,UACvB0E,SATN,OAYE7D,GAAQ2b,eAAe,IACvB3b,GAAQkL,QAAQ,CAAErH,QAbpB,wCAgBA,IAAM+X,GAA0C,GAEhD,SAAS1Q,GAAQpF,GAAoB,IAC3BjC,EAAqBiC,EAArBjC,IAAKM,EAAgB2B,EAAhB3B,YAETyX,GAAe/X,KAASM,IAC5ByX,GAAe/X,IAAO,EACtB8W,GACGa,IAAI,SACJC,MAAM5X,GACNgY,GAAG,SAAS,SAACC,GACZ,IAAMrY,EAAOqY,EAAQC,OAAS,GAC9B/b,GAAQgc,eAAe,CAAEvY,OAAMI,MAAKM,oBAI1C,SAAUlE,KAAV,8EACQ4D,EAAM7E,aAAaC,QAAQ,SACb,cAAR4E,EAFd,iDAME,OAHM9E,GAAO,IAAIG,MAAOC,UAExBH,aAAa4E,QAAQ,eAArB,UAAwC7E,IAL1C,SAMQ4b,GACHa,IAAI,SACJC,MAFG,UAEM5X,IACT4X,MAAM,cACNC,IAAI3c,GAVT,OAYE,OAZF,SAYQ4b,GACHa,IAAI,iBACJC,MAFG,UAEM5X,IACT6X,IAAI3c,GAfT,wCAkBA,SAAUuU,KAAV,0EACsB,OADtB,SAC4BqH,GACvBa,IAAI,iBACJS,KAAK,SAHV,OACQC,EADR,OAKQ7X,EAAiB6X,EAAYH,OAAS,GAC5C/b,GAAQmc,wBAAwB,CAAE9X,kBANpC,wCASe,SAAUyW,KAAV,kEACb,OADa,SACP5S,aAAI,CACRqT,aAAW,WAAYrQ,IACvBqQ,aAAW,WAAY1N,IACvB0N,aAAW,qBAAsBtb,IACjCsb,aAAW,qBAAsBjI,MALtB,wC,iBCzDL3H,I,aA2CAf,I,aAWAgB,I,aAuCOwQ,I,aAmBQtB,IAhHzB,SAAUnP,GAAY7F,GAAtB,kFAYI,OAXMjC,EAA4BiC,EAA5BjC,IAAKvC,EAAuBwE,EAAvBxE,QADf,EACsCwE,EAAd6C,YADxB,MAC+B,GAD/B,EAEQ5J,GAAO,IAAIG,MAAOC,UAElBkd,EAAahb,EAAc,CAC/BtC,OACAoC,OAAQ0C,EACRtC,KAAK,GAAD,OAAKD,EAAL,KACJqH,SARJ,kBAYUgS,GACHa,IAAI,YACJC,MAFG,UAEM1c,IACT2c,IAAIW,GAfX,OAgBIrd,aAAa4E,QAAQ,UAAW,IAChC5D,GAAQsc,mBAAmB,CAAEhb,QAAS+a,IAjB1C,kDAmBIrc,GAAQuc,gBAAgB,IACxB5L,QAAQ9O,MAAR,MACA7B,GAAQ4B,OAAO,CAAEN,QAAS,kSArB9B,uDAyBA,SAASuJ,KACP8P,GACGa,IAAI,YACJgB,aACAC,YAAY,GACZZ,GAAG,SAAS,SAACa,GACZ,IAAMjc,EAAWuE,OAAOC,OAAOyX,EAAYX,OAAS,IACpD/b,GAAQ2c,mBAAmB,CACzBlc,WACAsE,QAAQ,OAKhB,SAASgG,KACP4P,GAASa,IAAI,YAAYoB,MAG3B,SAAUhS,KAAV,0EACsB,OADtB,SAC4B+P,GACvBa,IAAI,YACJgB,aACAC,YAAY,KACZR,KAAK,SALV,OACQS,EADR,OAOQjc,EAAWuE,OAAOC,OAAOyX,EAAYX,OAAS,IACpD/b,GAAQ2c,mBAAmB,CAAElc,aAR/B,wCAWA,SAAUmL,GAAgB9F,GAA1B,4EAGsB,OAFZ+F,EAAiB/F,EAAjB+F,aADV,SAG4B8O,GACvBa,IAAI,YACJgB,aACAK,MAHuB,UAGdhR,EAAa9M,OACtB0d,YAAY,IACZR,KAAK,SARV,OAGQS,EAHR,OAUQjc,EAAWuE,OAAOC,OAAOyX,EAAYX,OAAS,IACpD/b,GAAQ2c,mBAAmB,CAAElc,WAAUsE,QAAQ,IAXjD,wCAcA,SAASiH,GAAWlG,GAAoB,IAC9BmG,EAAcnG,EAAdmG,KAAMpI,EAAQiC,EAARjC,IAERiZ,EAAU,IAAIC,eACdC,EAAW,IAAIC,SAErBD,EAASE,OAAO,QAASjR,GAEzB6Q,EAAQK,KAAK,OAAQ,kCACrBL,EAAQM,iBAAiB,gBAAzB,6BACAN,EAAQO,mBAAqB,WAC3B,GAAuB,MAAnBP,EAAQQ,QAAyC,IAAvBR,EAAQS,WAAkB,CACtD,IAAIC,EAAM9Z,KAAKC,MAAMmZ,EAAQW,cAE7Bzd,GAAQ2L,YAAY,CAClB9H,MACAvC,QAASkc,EAAI7U,KAAKxM,OAEpB6D,GAAQ4B,OAAO,CAAEN,QAAS,4HAI9Bwb,EAAQY,KAAKV,GAGR,SAAUZ,GAActW,GAAxB,0EAUL,OATQxE,EAAYwE,EAAZxE,QAEF+a,EAAahb,EAAc,CAC/BtC,KAAMuC,EAAQvC,KACdoC,OAAQG,EAAQH,OAChBI,KAAMD,EAAQC,KACdoH,KAAMrH,EAAQqH,OAPX,SAUCgS,GACHa,IAAI,YACJC,MAFG,UAEMna,EAAQvC,OACjB2c,IAAIW,GAbF,cAeLrc,GAAQ2d,qBAAqB,CAAErc,QAAS+a,IAfnC,kBAgBEA,GAhBF,wCAmBQ,SAAUvB,KAAV,kEACb,OADa,SACP5S,aAAI,CACRqT,aAAW,eAAgB5P,IAC3B4P,aAAW,eAAgB3Q,IAC3B2Q,aAAW,oBAAqB3P,IAChC2P,aAAW,YAAa1Q,IACxB0Q,aAAW,cAAexQ,IAC1BwQ,aAAW,cAAevP,IAC1BuP,aAAW,iBAAkBa,MARlB,wC,2BC9GLxY,I,aAsBA0O,I,aAWA7J,I,aAaA0K,I,aAeAF,I,aAwEe6H,IArIzB,SAAUlX,GAAQkC,GAAlB,gFAaE,OAZQnF,EAASmF,EAATnF,KACF5B,GAAO,IAAIG,MAAOC,UAClB6C,EAAKrB,EAAKqB,InC6IhB,IAAMlF,KAAKE,SAAS4B,SAAS,IAAIC,OAAO,EAAG,GmC5IrCsC,EAASnC,aAAaC,QAAQ,OAE9B2e,EANR,2BAOOjd,GAPP,IAQIqB,KACAjD,OACAoC,WAVJ,SAaQwZ,GACHa,IAAI,SACJC,MAFG,UAEMzZ,IACT0Z,IAAIkC,GAhBT,OAkBE5d,GAAQ6d,eAAe,CAAED,aACzB5d,GAAQyI,YAAY,CAAEzG,OAnBxB,wCAsBA,SAAUsQ,KAAV,0EACmB,OADnB,SACyBqI,GACpBa,IAAI,SACJgB,aACAsB,aAAa,IACb7B,KAAK,SALV,OACQ8B,EADR,OAOQ3Z,EAAQY,OAAOC,OAAO8Y,EAAShC,OAAS,IAC9C/b,GAAQge,gBAAgB,CAAE5Z,UAR5B,wCAWA,SAAUqE,GAAY3C,GAAtB,4EAGkB,OAFR9D,EAAO8D,EAAP9D,GADV,SAGwB2Y,GACnBa,IAAI,SACJC,MAAMzZ,GACNia,KAAK,SANV,cAGQgC,EAHR,OAQQtd,EAAOsd,EAAQlC,OAASha,EAAcC,GAC5ChC,GAAQge,gBAAgB,CAAE5Z,MAAO,CAACzD,KATpC,mBAUS,GAVT,wCAaA,SAAUwS,GAAarN,GAAvB,kFAGmB,OAHnB,EACmCA,EAAzBtI,cADV,MACmB,EADnB,EACsB4V,EAAatN,EAAbsN,SADtB,SAGyBuH,GACpBa,IAAI,SACJgB,aACA0B,QAHoB,UAGT9K,EAASpR,KACpB8b,aAAatgB,EAAS,GACtBye,KAAK,SARV,OAGQ8B,EAHR,OAUQ5f,EAAI4f,EAAShC,MACb3X,EAAQY,OAAOC,OAAO9G,GAAK,IAAIE,OAAO,GAC5C2B,GAAQge,gBAAgB,CAAE5Z,UAZ5B,wCAeA,SAAU6O,GAAWnN,GAArB,cAgBiBqY,EAhBjB,MAyCiBC,EAzCjB,oEAIE,OAJF,8CAyCE,WAA0Bld,GAA1B,oBAAA/C,EAAA,yDACQsF,EAAcS,EAAMhD,GAD5B,oDAGQmd,EAAaC,IAEnBC,YAAW,kBAAMve,GAAQoG,mBAAmB,CAC1ChB,MAAO,eACPtJ,MAAOoF,EAAQ,MACbmd,IACA5a,EAAKmB,UATX,sBAUUjE,EAAOqE,OAAOC,OAAOxB,EAAKmB,WAAW2D,MAAK,SAAC5H,GAAD,OAA0BA,EAAKqB,KAAOA,MAV1F,kCAYY2Y,GAASa,IAAT,gBAAsB/X,EAAKI,IAA3B,sBAA4C7B,EAA5C,YAAkDrB,EAAK5B,OAAQ2c,IAAI,IAZ/E,QAaM6C,YAAW,kBAAMve,GAAQoG,mBAAmB,CAC1ChB,MAAO,eACPtJ,QAAS0iB,MACPH,GAhBV,yBAmBQD,EAAWld,EAAQ,GAnB3B,6CAzCF,uBAyCiBkd,EAzCjB,0FAgBE,WAA6Bld,GAA7B,kBAAA/C,EAAA,yDACQmD,EAAoBb,EAASS,GADrC,oDAGQmd,EAAaC,IAEnBC,YAAW,kBAAMve,GAAQoG,mBAAmB,CAC1ChB,MAAO,kBACPtJ,MAAOoF,EAAQ,MACbmd,IACA/c,EAAQqH,OAAQrH,EAAQqH,KAAKzF,QAAU5B,EAAQqH,KAAKzF,SAAWlB,EATrE,gCAUU2Y,GAASa,IAAT,mBAAyBla,EAAQvC,KAAjC,UAA8C2c,IAAI,IAV5D,OAWI6C,YAAW,kBAAMve,GAAQoG,mBAAmB,CAC1ChB,MAAO,kBACPtJ,QAAS2iB,MACPJ,GAdR,wBAgBQF,EAAcjd,EAAQ,GAhB9B,6CAhBF,uBAgBiBid,EAhBjB,4CACUnc,EAAO8D,EAAP9D,GADV,SAIQ2Y,GAASa,IAAT,gBAAsBxZ,IAAM0Z,IAAI,IAJxC,OAa8C,OAR5C1b,GAAQoG,mBAAmB,CAAEhB,MAAO,UAAWtJ,OAAO,IAClD4iB,EAAc,EACZJ,EAAU,WAEd,OADAI,GAAe/hB,EAAa,GAAI,MARpC,KAa+BqI,OAb/B,UAaoD2V,GAASa,IAAT,YAAyBS,KAAK,SAblF,uBAa4FF,MAb5F,2BAaqG,GAbrG,QAmCE,OAnCF,UAaQtb,EAbR,KAasCwE,OAbtC,gBAcMwZ,EAAkB,EAdxB,UAmCQN,EAAc,GAnCtB,QAsCwC,OAtCxC,KAsCyBnZ,OAtCzB,UAsC8C2V,GAASa,IAAT,SAAsBS,KAAK,SAtCzE,uBAsCmFF,MAtCnF,2BAsC4F,GAtC5F,QA+DE,OA/DF,UAsCQ7X,EAtCR,KAsCgCe,OAtChC,gBAuCMuZ,EAAe,EAvCrB,UA+DQJ,EAAW,GA/DnB,QAiEEG,YACE,kBAAMve,GAAQoG,mBAAmB,CAAEhB,MAAO,OAAQtJ,OAAO,MACzDwiB,KAEFte,GAAQ2e,kBAAkB,CAAE3c,OArE9B,yCAwEe,SAAU8Y,KAAV,kEACb,OADa,SACP5S,aAAI,CACRqT,aAAW,cAAetI,IAC1BsI,aAAW,WAAY3X,IACvB2X,aAAW,YAAajJ,IACxBiJ,aAAW,iBAAkBpI,IAC7ByL,aAAU,iBAAkBnW,MANjB,wC,iBCrILiL,I,aA4DAzL,I,aA+BA4W,I,aAkBAlM,I,aA+BA5J,I,aA6Be+R,IAzKzB,SAAUpH,GAAS5N,GAAnB,yFACU9D,EAAwC8D,EAAxC9D,GAAI6B,EAAoCiC,EAApCjC,IAAKwQ,EAA+BvO,EAA/BuO,YAAaC,EAAkBxO,EAAlBwO,IAAK3T,EAAamF,EAAbnF,KAAMpE,EAAOuJ,EAAPvJ,KAErCyF,GAAM6B,GAAOlD,GAHnB,oBAIUuB,EAAOY,EAAYnC,IACrB0T,EALR,uBAMMrU,GAAQ2L,YAAY,CAClB9H,MACAvC,QAAQ,iEAAD,OAAiBY,GACxByG,KAAM,CAAEzF,OAAQlB,EAAIxE,OAAQmD,EAAKnD,UAEnCwC,GAAQ8e,gBAAgB,IACxB9e,GAAQ4B,OAAO,CAAEN,QAAQ,iEAAD,OAAiBY,KACzClC,GAAQmF,SAAS,CAAE5I,GAAI,wBAb7B,mBAca,GAdb,OAiBoB,OAjBpB,UAiB0B0L,GAAW,CAAEjG,KAAI6B,MAAKrG,OAAQmD,EAAKnD,SAjB7D,0CAmBMmT,QAAQ9O,MAAR,kBAAiCiE,GACjC9F,GAAQ+e,aAAa,CAAE/c,KAAI6B,QApBjC,mBAqBa,GArBb,YAwBQyQ,EAxBR,wBAyBYpS,EAAOY,EAAYnC,GAAM,GAC/BX,GAAQ2L,YAAY,CAClB9H,MACAvC,QAAQ,uEAAD,OAAkBY,GACzByG,KAAM,CAAEzF,OAAQlB,KAElBhC,GAAQ4B,OAAO,CAAEN,QAAQ,yFAAD,OAAqBY,KAC7ClC,GAAQmF,SAAS,CAAE5I,GAAI,wBACvByD,GAAQ8e,gBAAgB,IAjC9B,mBAkCa,GAlCb,YAqCQviB,EArCR,wBAsCMyD,GAAQ2S,SAAS,CAAE9O,IAAKtH,EAAGsH,IAAK7B,KAAI4Q,SAAUjS,EAAKsB,KAAMzE,OAAQmD,EAAKnD,SACtEwC,GAAQ4B,OAAO,CAAEN,QAAQ,iEAAD,OAAiBX,EAAKuB,KAAtB,kDAAsC3F,EAAGkI,SAAzC,OACxBzE,GAAQ8e,gBAAgB,IAxC9B,kCA4CI9e,GAAQ2L,YAAY,CAClB9H,MACAvC,QAAQ,qDAAD,OAAeY,GACtByG,KAAM,CAAEzF,OAAQlB,EAAIxE,OAAQmD,EAAKnD,OAAQyE,KAAMtB,EAAKsB,QAEtDjC,GAAQ4B,OAAO,CAAEN,QAAQ,uEAAD,OAAkBY,KAC1ClC,GAAQmF,SAAS,CAAE5I,GAAI,wBACvByD,GAAQ8e,gBAAgB,IAnD5B,mBAoDW,GApDX,eAuDE9e,GAAQ+e,aAAa,CAAE/c,KAAI6B,QAC3B8M,QAAQ9O,MAAR,mDAAkEiE,GAxDpE,mBAyDS,GAzDT,yCA4DA,SAAUmC,GAAWnC,GAArB,oFAOmB,OANT9D,EAAwB8D,EAAxB9D,GAAI6B,EAAoBiC,EAApBjC,IADd,EACkCiC,EAAftI,cADnB,MAC4B,EAD5B,EAEQge,EAAMb,GACTa,IADS,SAETC,MAAM5X,GACN4X,MAAM,aALX,SAOyBoD,GAAiB,CAAE7c,KAAI6B,QAPhD,YAOQmb,EAPR,8BASQA,EAASxhB,OAASA,GAAU,GATpC,iBAeM,OALMmD,EAVZ,2BAWWqe,GAXX,IAYQxhB,OAAQwhB,EAASxhB,OAASA,IAZlC,UAeYge,EAAIC,MAAJ,UAAazZ,EAAb,YAAmBgd,EAASjgB,OAAQ2c,IAAI/a,GAfpD,eAgBMX,GAAQif,kBAAkB,CAAEjd,KAAI6B,QAhBtC,mBAiBa,GAjBb,QAoBI,OApBJ,UAoBU2X,EAAIC,MAAJ,UAAazZ,EAAb,YAAmBgd,EAASjgB,OAAQ2c,IAAI,IApBlD,eAqBI1b,GAAQif,kBAAkB,CAAEjd,KAAI6B,QArBpC,mBAsBW,GAtBX,eAyBE8M,QAAQ9O,MAAR,kCAAyCgC,EAAzC,gCAAoE7B,EAApE,MACAhC,GAAQ4B,OAAO,CAAEN,QAAQ,sIACzBtB,GAAQkf,eAAe,CAAEld,KAAI6B,MAAKhC,MAAO,gBA3B3C,mBA4BS,GA5BT,yCA+BA,SAAUgd,GAAiB/Y,GAA3B,gFAGmB,OAFT9D,EAAY8D,EAAZ9D,GAAI6B,EAAQiC,EAARjC,IADd,SAGyB8W,GACpBa,IAAI,SACJC,MAAM5X,GACN4X,MAAM,aACNQ,KAAK,SAPV,UAGQ8B,EAHR,SAQQ3Z,EAA0BY,OAAOC,OAAO8Y,EAAShC,OAAS,KACtDtd,OATZ,qBAWUkC,EAAcyD,EAAMmE,MAAK,SAAA5H,GAAI,OAAIA,EAAKqB,KAAOA,MAXvD,yCAaarB,GAbb,0EAkBA,SAAUgS,GAAS7M,GAAnB,2FACU9D,EAAkC8D,EAAlC9D,GAAI6B,EAA8BiC,EAA9BjC,IAAK+O,EAAyB9M,EAAzB8M,SADnB,EAC4C9M,EAAftI,cAD7B,MACsC,EADtC,EAEOwE,GAAO6B,GAAQ+O,EAFtB,uBAGIjC,QAAQ9O,MAAM,wDAAyDG,EAAI6B,EAAK+O,GAChF5S,GAAQmf,aAAa,IAJzB,6BAQQpgB,GAAO,IAAIG,MAAOC,UACpBwB,EAAuB,CAAEqB,KAAIjD,OAAMkD,KAAM2Q,EAAUpV,OAAQA,GAE9C,WAAboV,GAAsC,aAAbA,EAX/B,iBAYqB,OAZrB,UAY2BiM,GAAiB,CAAE7c,KAAI6B,QAZlD,SAYUmb,EAZV,UAcMre,EAAKnD,QAAUwhB,EAASxhB,QAAU,GAAKA,EACvCmD,EAAK5B,KAAOigB,EAASjgB,MAf3B,QAoBE,OADMqgB,EAnBR,UAmBoBze,EAAKqB,GAnBzB,YAmB+BrB,EAAK5B,MAnBpC,UAoBQ4b,GACHa,IAAI,SACJC,MAAM5X,GACN4X,MAAM,aACNA,MAAM2D,GACN1D,IAAI/a,GAzBT,eA2BEX,GAAQqf,gBAAgB,CAAErd,KAAI6B,QA3BhC,mBA4BS,GA5BT,yCA+BA,SAAUkF,GAASjD,GAAnB,kFAMe,OALLjC,EAAiBiC,EAAjBjC,IAAKvC,EAAYwE,EAAZxE,QADf,EAEmCA,EAAQqH,KAAjCzF,EAFV,EAEUA,OAAQ1F,EAFlB,EAEkBA,OAAQyE,EAF1B,EAE0BA,KAExBX,EAAQqH,KAAKC,OAAQ,EAJvB,SAMqBwT,GAAc,CAAEvY,MAAKvC,YAN1C,oBAOcW,EAPd,iBAQiB,OARjB,SAQuB0Q,GAAS,CAC1B3Q,GAAIkB,EACJW,MACArG,OAAQA,GAAU,EAClBoV,SAAU3Q,IAZhB,0CAeMjC,GAAQ2L,YAAY,CAClB9H,MACAvC,QAAQ,iGAEVtB,GAAQsf,gBAAgB,IAnB9B,mBAoBa,GApBb,eAwBE3O,QAAQ9O,MAAM,uCAAwCiE,GACtD9F,GAAQuf,aAAa,IAzBvB,mBA0BS,GA1BT,yCA6Be,SAAUzE,KAAV,kEACb,OADa,SACP5S,aAAI,CACRqT,aAAW,YAAa5I,IACxB4I,aAAW,cAAetT,IAC1BsT,aAAW,YAAa7H,IACxB6H,aAAW,YAAaxS,MALb,wC,iBC1KUyW,IAAV,SAAUA,KAAV,kEACb,OADa,SACPtX,aAAI,CACRwS,KACAxW,KACAzD,KACA2D,KACAQ,OANW,wCCIKkL,QACW,cAA7BzU,OAAOG,SAASikB,UAEe,UAA7BpkB,OAAOG,SAASikB,UAEhBpkB,OAAOG,SAASikB,SAASriB,MACvB,2DCRNiI,EAAeqa,IAAIC,IACnBC,IAASxX,OACP,kBAAC,IAAD,CAAU7C,MAAOA,GACf,kBAAC,GAAD,OAEFnF,SAASyf,eAAe,SD4HpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAAve,GACL8O,QAAQ9O,MAAMA,EAAMP,c","file":"static/js/main.cfab8aee.chunk.js","sourcesContent":["import React from 'react';\nimport { Menu as AntdMenu } from 'antd';\nimport { Link, withRouter, RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport '../styles/menu.scss';\nimport menu from '../configs/menu.json';\nimport { IState } from '../reducers/interfaces';\n\ninterface IMenuProps extends RouteComponentProps {\n  isLoggedIn: boolean;\n}\n\ninterface IMenuConfig {\n  label: string;\n  path: string;\n  link?: boolean;\n}\n\nfunction Menu(props: IMenuProps) {\n  if (!props.isLoggedIn) {\n    return <React.Fragment/>;\n  }\n\n  const mode = window.innerWidth < 767\n    ? 'horizontal'\n    : 'inline';\n\n  return (\n    <AntdMenu\n      mode={mode}\n      selectedKeys={[props.location.pathname.split('/').pop() || '']}\n    >\n      {menu.map((value: IMenuConfig) => (\n        <AntdMenu.Item\n          key={value.path.split('/').pop()}\n          disabled={value.path === props.location.pathname}\n        >\n          {\n            value.link\n              ? (\n\n                <a\n                  href={value.path}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  Помощь\n                </a>\n              ) : (\n                <Link to={value.path}>\n                  {value.label}\n                </Link>\n              )\n          }\n        </AntdMenu.Item>\n      ))}\n    </AntdMenu>\n  );\n}\n\nexport default connect((state: IState) => ({ isLoggedIn: state.isLoggedIn }))(withRouter(Menu));\n","import React from 'react';\nimport { Tooltip } from 'antd';\n\nexport interface IRoll {\n  roll: string;\n  results: number[];\n  amount: number;\n  size: number;\n  maxResult: number;\n  minResult: number;\n  sum: number;\n}\n\nexport const diceRegex = /([1-9]|10)[dд]((10|12|20)|[468])/miu;\nexport const diceRegexG = /([1-9]|10)[dд]((10|12|20)|[468])/miug;\n\nexport const getRandomInt = (min: number, max: number) =>\n  Math.floor(Math.random() * ((max + 1) - min) + min);\n\nexport const hasDice = (str: string) =>\n  /\\d+[dд]\\d+/imu.test(str);\n\nexport const rollDice = (amount: number, size: number) => {\n  return new Array(amount).fill(amount + size).map(() => getRandomInt(1, size));\n};\n\nexport const exportRolls = (str: string) => {\n  const rolls = str.match(diceRegexG);\n  if (rolls) {\n    return rolls.map((roll: string): IRoll => {\n      const [_amount, _size] = roll.split(/[dд]/);\n      const amount = parseInt(_amount);\n      const size = parseInt(_size);\n      const results = rollDice(amount, size);\n\n      return ({\n        maxResult: size * amount,\n        minResult: amount,\n        sum: results.reduce((a, b) => a + b, 0),\n        roll,\n        results,\n        amount,\n        size,\n      })\n    }).splice(0, 10);\n  }\n  return [];\n};\n\nexport const importRolls = (body: string, _rolls: IRoll[]) => {\n  const rolls = [..._rolls]; // Avoid mutations\n  return body.split(' ').map((word: string, index: number) => {\n    const rollIndex = rolls.findIndex(({ roll }) => roll === word);\n    if (rollIndex > -1) {\n      const {\n        results,\n        maxResult,\n        minResult,\n        sum\n      } = rolls.splice(rollIndex, 1)[0];\n\n      const summing = results.length > 1\n        ? `${sum} = ${results.join(' + ')}`\n        : `${results.join(' + ')}`;\n\n      const className = (sum === maxResult && 'critHit') || (sum === minResult && 'critMiss') || '';\n\n      return (\n        <React.Fragment key={word + index}>\n          {' '}\n          <Tooltip title={summing}>\n            <b className={className}>\n              {word}({sum})\n            </b>\n          </Tooltip>\n        </React.Fragment>\n      )\n    }\n    return ` ${word}`;\n  });\n};\n","import { message as notify } from 'antd';\n\nimport actions from '../reducers/actions';\nimport { IItem, IMessage } from '../reducers/interfaces';\nimport { diceRegex, exportRolls, hasDice } from './dice';\n\nexport const camelize = (str: string) => {\n  return str\n    .toLowerCase()\n    .replace(/_./g, (m) => m.toUpperCase())\n    .replace(/_/g, '')\n};\n\nexport const colorFromString = (str: string) => {\n  if (!str) return '#000';\n\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    let value = (hash >> (i * 8)) & 0xFF;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n\n  return color;\n};\n\nexport const isOnline = (time?: number) => {\n  if (!time) return false;\n  const lastActivity = time || parseInt(localStorage.getItem('lastActivity') || '0');\n  return (lastActivity + 180000) > new Date().getTime();\n};\n\nexport const doubleDigit = (str: number) => `${str}`.length === 1\n  ? `0${str}`\n  : str;\n\nexport const getTime = (time: number) => {\n  const date = new Date(time);\n  return [date.getHours(), date.getMinutes(), date.getSeconds()].map(doubleDigit).join(':');\n};\n\nexport const getDate = (time: number) => {\n  const date = new Date(time);\n  return [date.getDate(), date.getMonth() + 1, date.getFullYear()].map(doubleDigit).join('.');\n};\n\nexport const getFullTime = (time: number) => {\n  const date = new Date(time);\n  const messageTime = [date.getHours(), date.getMinutes(), date.getSeconds()].map(doubleDigit).join(':');\n  const messageDate = [date.getDate(), date.getMonth() + 1, date.getFullYear()].map(doubleDigit).join('.');\n\n  return [messageTime, messageDate].join(' ');\n};\n\nexport const listenForActivity = () => {\n  const callback = () => {\n    if (!isOnline(parseInt(localStorage.getItem('lastActivity') || '0') - 60000))\n      actions.updateLastOnline({});\n  };\n\n  [\n    'mousedown',\n    'mousemove',\n    'keydown',\n    'scroll',\n    'touchstart'\n  ].forEach((eventName) => {\n    document.addEventListener(eventName, callback, true);\n  });\n  callback();\n};\n\nexport const isURL = (str: string) =>\n  /[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/igm.test(str);\n\nexport const processMessages = (messages: IMessage[]) => {\n  return messages\n    .filter((item: IMessage, pos: number, self: IMessage[]) =>\n      self.findIndex((_i: IMessage) => _i.time === item.time) === pos\n    )\n    .sort((a: IMessage, b: IMessage) => b.time - a.time)\n    .map((m: IMessage, index: number, messages: IMessage[]) => {\n      if (index < messages.length - 2) {\n        if (m.author === messages[index + 1].author) {\n          return {\n            ...m,\n            grouped: true,\n          }\n        }\n      }\n      return m;\n    })\n};\n\nexport const formatMessage = (message: IMessage) => {\n  const { body } = message;\n\n  if (diceRegex.test(body)) {\n    message.rolls = exportRolls(body);\n  }\n\n  if (body.indexOf('*') > -1) {\n    message.isRP = true;\n  }\n\n  if (/(@[a-zа-яё]*)/mui.test(body)) {\n    message.mentioned = true;\n  }\n\n  return message;\n};\n\nexport const validateMessage = (message: string) => {\n\n  if (!message) {\n    notify.error('Сообщение пустое');\n    return false;\n  }\n\n  if (hasDice(message)) {\n    const rolls: string[] | null = message.match(/(( |^)[a-zа-я]+\\d+[dд]\\d+)|(\\d+[dд]\\d+[a-zа-я]+( |$))|(\\d+[dд]\\d+)/miug);\n    if (rolls) {\n      const wasError = rolls.some((roll: string) => {\n        if (/(([a-zа-яё])\\d+[dд]\\d+)|(\\d+[dд]\\d+([a-zа-яё]))/miug.test(roll)) {\n          notify.error(`Ошибка в дайсе ${roll}. Рядом не должно быть символов`);\n          return true;\n        }\n\n        const [amount, size] = roll.split(/[dд]/u);\n\n        if (parseInt(amount) > 10) {\n          notify.error(`Ошибка в дайсе ${roll}. Нельзя бросать больше 10-ти дайсов`);\n          return true;\n        }\n\n        if ([2,4,6,8,10,12,20].indexOf(parseInt(size)) === -1) {\n          notify.error(`Ошибка в дайсе ${roll}. Можно бросать только дайсы размеров 4 6 8 10 12 20`);\n          return true;\n        }\n\n        return false;\n      });\n      if (wasError) return false;\n    }\n  }\n  return true;\n};\n\nexport const generateID = () =>\n  '_' + Math.random().toString(36).substr(2, 9);\n\nexport const getFailedItem: ((id: string) => IItem) = (id: string) => ({\n  id: id,\n  type: 'misc',\n  name: 'Ошибка',\n  weight: 0,\n  time: 0,\n  effect: id,\n  image: '',\n  description: 'Такого предмета не существует',\n  price: 0,\n  capacity: 0,\n  armor: 0,\n  approved: true,\n  failed: true,\n  amount: Number.MAX_VALUE,\n});\n\nexport const getItemName = (item: IItem, showAmount: boolean = true) =>\n  `${item ? `'${item.name}'` : 'предмет'}` + (showAmount && item.amount && item.amount >= 2 ? ` (${item.amount}шт)` : '');\n","import { IRoll } from '../helpers/dice';\nimport { ICharacter } from \"../containers/Character/config\";\n\nexport interface IAction {\n  type: string;\n\n  [key: string]: any; // Payload could be any type or size\n}\n\nexport interface IMessage {\n  author: string;\n  time: number;\n  body: string;\n  grouped?: boolean; // Remove header and top margin of message, because author is the same\n  isRP?: boolean;\n  mentioned?: boolean;\n  rolls?: IRoll[];\n  data?: { [key: string]: any }; // Extra data for special purposes\n}\n\nexport interface IState {\n  userData: IUser | null;\n  isLoggedIn: boolean;\n  settings: IUser | false;\n  loading: boolean;\n  messages: IMessage[];\n  users: IUsers;\n  uid: string;\n  currentUser: IUser | null;\n  items: IItem[];\n  error: Error | false;\n  notify?: string;\n  redirect?: string;\n  usersActivity: { [key: string]: string };\n  deletingItemData: IDeletedItemData;\n}\n\nexport interface IInventoryItem {\n  id: string;\n  time: number;\n  type: ItemType;\n  amount: number;\n}\n\nexport interface IInventory {\n  [key: string]: IInventoryItem;\n}\n\nexport interface IUser {\n  nickname: string;\n  avatar: string;\n  uid: string,\n  lastOnline: number;\n  isAdmin?: boolean;\n  inventory: IInventory,\n  character?: ICharacter,\n}\n\nexport interface IUsers {\n  [key: string]: IUser;\n}\n\nexport type ItemType = 'weapon' | 'usable' | 'wearable' | 'junk' | 'ammo' | 'note' | 'key' | 'misc';\n\nexport interface IItem {\n  id: string;\n  name: string;\n  weight: number;\n  time: number;\n  effect: string;\n  image: string;\n  description: string;\n  price: number;\n  capacity: number;\n  armor: number;\n  amount?: number;\n  approved: boolean;\n  author?: string;\n  type: ItemType;\n  failed?: boolean;\n}\n\nexport const defaultItem: IItem = {\n  id: '',\n  type: 'junk',\n  name: '',\n  effect: '',\n  image: '',\n  weight: 0,\n  price: 0,\n  description: '',\n  capacity: 0,\n  approved: false,\n  armor: 0,\n  time: 0,\n  amount: 0,\n};\n\nexport interface IDeletedItemData {\n  itemId?: string;\n  deleted?: boolean;\n  messagesChecked?: number;\n  messagesCleared?: number;\n  usersChecked?: number;\n  usersCleared?: number;\n  done?: boolean;\n}\n\nexport const defaultDeletedItemData: IDeletedItemData = {\n  itemId: '',\n  deleted: false,\n  messagesChecked: 0,\n  messagesCleared: 0,\n  usersChecked: 0,\n  usersCleared: 0,\n  done: false,\n};\n","import { processMessages } from '../helpers/utils';\nimport { defaultDeletedItemData, IAction, IItem, IState, IUser } from './interfaces';\n\nconst user = JSON.parse(localStorage.getItem('user') || 'null');\nif (user) localStorage.setItem('uid', user.uid);\nexport const initialState: IState = {\n  userData: user,\n  isLoggedIn: user !== null,\n  settings: false,\n  loading: false,\n  messages: [],\n  users: {},\n  uid: user ? user.uid : '',\n  currentUser: null,\n  items: [],\n  error: false,\n  usersActivity: {},\n  deletingItemData: defaultDeletedItemData,\n};\n\nexport const defaultUser: IUser = {\n  lastOnline: 0,\n\n  nickname: '',\n  avatar: '',\n\n  isAdmin: false,\n  uid: '',\n  inventory: {},\n};\n\nconst reducer = (state = initialState, action: IAction) => {\n  switch (action.type) {\n    case 'LOGIN':\n    case 'GET_MESSAGES':\n    case 'GET_MORE_MESSAGES':\n    case 'SEND_MESSAGE':\n    case 'SET_USER':\n    case 'GET_ITEMS':\n    case 'GET_MORE_ITEMS':\n    case 'GET_ITEMS_BY_ID':\n    case 'CREATE_ITEM':\n    case 'GIVE_ITEM':\n    case 'REMOVE_ITEM':\n    case 'PASS_ITEM':\n    case 'GET_USERS_ACTIVITY':\n    case 'UPLOAD_FILE': {\n      return {\n        ...state,\n        loading: true,\n      }\n    }\n    case 'SET_USER_SUCCESS':\n    case 'SET_USER_FAIL':\n    case 'GET_MESSAGES_FAIL':\n    case 'GET_MORE_MESSAGES_SUCCESS':\n    case 'GET_MORE_MESSAGES_FAIL':\n    case 'GIVE_ITEM_SUCCESS':\n    case 'REMOVE_ITEM_SUCCESS':\n    case 'REMOVE_ITEM_FAIL':\n    case 'PASS_ITEM_SUCCESS':\n    case 'PASS_ITEM_FAIL':\n    case 'GET_USERS_ACTIVITY_FAIL':\n    case \"DELETE_ITEM_FAIL\":\n    case 'SEND_MESSAGE_FAIL': {\n      return {\n        ...state,\n        loading: false,\n      }\n    }\n    case 'LOGIN_SUCCESS': {\n      return {\n        ...state,\n        uid: action.user.uid,\n        userData: action.user,\n        isLoggedIn: action.user !== null,\n        currentUser: {\n          ...defaultUser,\n          uid: action.user.uid,\n        },\n        loading: false,\n      }\n    }\n    case 'LOGIN_FAIL': {\n      return {\n        ...state,\n        loading: false,\n        error: action.error,\n      }\n    }\n    case 'LOGOUT': {\n      return {\n        ...state,\n        userData: null,\n        isLoggedIn: false,\n      }\n    }\n    case 'GET_MESSAGES_SUCCESS': {\n      const messages = action.concat\n        ? [...state.messages, ...action.messages]\n        : action.messages;\n\n      return {\n        ...state,\n        messages: processMessages(messages),\n        loading: false,\n      }\n    }\n    case 'GET_USER_SUCCESS': {\n      const currentUser = action.user.uid === state.uid\n        ? action.user\n        : state.currentUser;\n\n      return {\n        ...state,\n        currentUser,\n        users: {\n          ...state.users,\n          [action.uid]: action.user,\n        },\n      }\n    }\n    case 'GET_ITEMS_SUCCESS': {\n      const items: { [key: string]: IItem } = {};\n      [...state.items, ...action.items]\n        .forEach((item: IItem) => items[item.id] = item);\n\n      return {\n        ...state,\n        loading: false,\n        items: Object.values(items),\n      }\n    }\n    case 'NOTIFY': {\n      return {\n        ...state,\n        notify: action.message,\n      }\n    }\n    case 'NOTIFY_SUCCESS': {\n      return {\n        ...state,\n        notify: undefined,\n      }\n    }\n    case 'REDIRECT': {\n      return {\n        ...state,\n        redirect: action.to,\n      }\n    }\n    case 'REDIRECT_SUCCESS': {\n      return {\n        ...state,\n        redirect: undefined,\n      }\n    }\n    case 'GET_USERS_ACTIVITY_SUCCESS': {\n      return {\n        ...state,\n        loading: false,\n        usersActivity: action.usersActivity,\n      }\n    }\n    case 'DELETE_ITEM': {\n      return {\n        ...state,\n        loading: true,\n        deletingItemData: {\n          itemId: action.id,\n          defaultDeletedItemData,\n        },\n      }\n    }\n    case 'DELETE_ITEM_PROGRESS': {\n      return {\n        ...state,\n        deletingItemData: {\n          ...state.deletingItemData,\n          [action.field]: action.value\n        },\n      }\n    }\n    case 'DELETE_ITEM_SUCCESS': {\n      return {\n        ...state,\n        loading: false,\n        items: state.items.filter((item: IItem) => item.id !== action.id),\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","import { createStore, applyMiddleware } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport { composeWithDevTools } from 'redux-devtools-extension';\n\nimport { initialState } from '../reducers';\nimport reducers from '../reducers'\n\nexport const sagaMiddleware = createSagaMiddleware();\nconst store = createStore(\n  reducers,\n  initialState,\n  composeWithDevTools(applyMiddleware(sagaMiddleware)),\n);\n\nexport default store;\n","import store from '../helpers/store';\nimport { camelize } from '../helpers/utils';\n\nconst dispatch = store.dispatch;\n\nexport interface IPayload {\n  [key: string]: any;\n}\n\ninterface IActions {\n  [key: string]: (payload: IPayload) => void;\n}\n\nconst createAction =\n  (type: string) =>\n    (payload?: IPayload) =>\n      dispatch({ type, ...payload });\n\nconst createAsyncAction = (type: string) => {\n  const typeName = camelize(type);\n  return {\n    [typeName]: createAction(type),\n    [`${typeName}Success`]: createAction(`${type}_SUCCESS`),\n    [`${typeName}Fail`]: createAction(`${type}_FAIL`),\n  }\n};\n\nconst actions: IActions = {\n  ...createAsyncAction('LOGIN'),\n  ...createAsyncAction('GET_USER'),\n  ...createAsyncAction('GET_MESSAGES'),\n  ...createAsyncAction('GET_MORE_MESSAGES'),\n  ...createAsyncAction('SET_USER'),\n  ...createAsyncAction('SEND_MESSAGE'),\n  ...createAsyncAction('CHANGE_MESSAGE'),\n  ...createAsyncAction('SUBSCRIBE'),\n  ...createAsyncAction('UNSUBSCRIBE'),\n  ...createAsyncAction('UPLOAD_FILE'),\n  ...createAsyncAction('SET_ITEM'),\n  ...createAsyncAction('DELETE_ITEM'),\n  ...createAsyncAction('GET_ITEMS'),\n  ...createAsyncAction('GET_ITEM_BY_ID'),\n  ...createAsyncAction('GET_MORE_ITEMS'),\n  ...createAsyncAction('GIVE_ITEM'),\n  ...createAsyncAction('REMOVE_ITEM'),\n  ...createAsyncAction('PASS_ITEM'),\n  ...createAsyncAction('TAKE_ITEM'),\n  ...createAsyncAction('NOTIFY'),\n  ...createAsyncAction('REDIRECT'),\n  ...createAsyncAction('GET_USERS_ACTIVITY'),\n  ...createAsyncAction('DELETE_ITEM'),\n  deleteItemProgress: createAction('DELETE_ITEM_PROGRESS'),\n  updateLastOnline: createAction('UPDATE_LAST_ONLINE'),\n  logout: createAction('LOGOUT'),\n};\n\nexport default actions;\n","import React from 'react';\nimport { Avatar as AntdAvatar } from 'antd';\nimport { AvatarProps } from 'antd/es/avatar';\n\nimport { colorFromString, isURL } from '../helpers/utils';\n\ninterface IAvatarProps extends AvatarProps {\n  avatar: string;\n  nickname: string;\n}\n\nconst Avatar = (props: IAvatarProps) => {\n  const { avatar, nickname, style, ...rest } = props;\n\n  const _avatar = isURL(avatar) ? avatar : '';\n  return (\n    <AntdAvatar\n      src={_avatar}\n      style={{ ...style, backgroundColor: _avatar ? 'transparent' : colorFromString(nickname) }}\n      {...rest}\n    >\n      {nickname}\n    </AntdAvatar>\n  )\n};\n\nexport default Avatar;\n","import React, { Component } from 'react';\nimport { Modal } from 'antd';\nimport { CloseOutlined } from '@ant-design/icons';\n\nclass Image extends Component<{ src: string }, { visible: boolean }> {\n  state = { visible: false };\n\n  toggleModal = () => {\n    this.setState({\n      visible: !this.state.visible,\n    });\n  };\n\n  render() {\n    const { src } = this.props;\n\n    return (\n      <React.Fragment>\n        <img\n          onClick={this.toggleModal}\n          src={src}\n          alt=\"\"\n          className=\"chat-image\"\n        />\n        <Modal\n          title={\n            <div>\n              <a\n                href={src}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {src}\n              </a>\n              <CloseOutlined onClick={this.toggleModal}/>\n            </div>\n          }\n          className=\"image-modal\"\n          closable={false}\n          footer={null}\n          visible={this.state.visible}\n          onCancel={this.toggleModal}\n          width=\"fit-content\"\n        >\n          <img\n            style={{\n              maxWidth: '90vw',\n            }}\n            src={src}\n            alt=\"\"\n          />\n        </Modal>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Image;\n","import React, { Component } from 'react';\nimport { Card, Button } from 'antd';\nimport { DeleteOutlined } from '@ant-design/icons';\n\nimport '../styles/item.scss';\nimport { IItem } from '../reducers/interfaces';\nimport Avatar from './Avatar';\nimport actions from '../reducers/actions';\n\ninterface IItemProps {\n  item: IItem,\n  footer?: JSX.Element,\n  disabled?: boolean;\n  uid?: string;\n  amount?: number;\n}\n\nclass Item extends Component<IItemProps> {\n  getStats = () => {\n    const { type, armor, capacity } = this.props.item;\n\n    switch (type) {\n      case 'wearable':\n        return armor;\n\n      case 'weapon':\n        return capacity;\n\n      default:\n        const amount = this.props.amount || this.props.item.amount;\n        return (amount && amount >= 2) ? `${amount}шт` : false;\n    }\n  };\n\n  labels = {\n    wearable: 'Защита',\n    weapon: 'Магазин',\n  };\n\n  getFooter = () => {\n    const { footer, uid } = this.props;\n    const { failed, id } = this.props.item;\n\n    if (failed) {\n      return (\n        <div className=\"item-footer\">\n          <Button\n            disabled={!uid}\n            onClick={() => actions.removeItem({ uid, id, all: true })}\n          >\n            <DeleteOutlined/>\n          </Button>\n        </div>\n      )\n    }\n\n    if (footer)\n      return (\n        <div className=\"item-footer\">\n          {footer}\n        </div>\n      )\n  };\n\n  render = () => {\n    const { disabled, item } = this.props;\n    const {\n      name = item.id,\n      price = 0,\n      description,\n      image,\n      effect,\n      weight = 0,\n      type,\n      approved,\n    } = item;\n\n    const stats = this.getStats();\n    return (\n      <Card className={`item ${(approved && !disabled) ? '' : 'disabled'}`}>\n        <div className=\"item-info\">\n          <div className=\"item-name\">{name}</div>\n          <div className=\"item-subinfo\">\n            <div className=\"item-price\">\n              {price > 0 && `Цена: ${price}`}\n            </div>\n            <div className=\"item-weight\">\n              {weight > 0 && `Вес: ${weight}lb`}\n            </div>\n          </div>\n        </div>\n        {(image || description) && (\n          <div className=\"item-body\">\n            {image && <div className=\"item-image\">\n              <Avatar avatar={image} nickname={name} shape=\"square\"/>\n            </div>}\n            {description}\n          </div>\n        )}\n\n        {(stats || effect) && (\n          <div className=\"item-prefooter\">\n            <div className=\"item-ammo\">\n              {\n                // @ts-ignore\n                stats ? `${this.labels[type] || 'Кол-во'}: ${stats}` : ''\n              }\n            </div>\n            <div className=\"item-effect\">{effect}</div>\n          </div>\n        )}\n        {this.getFooter()}\n      </Card>\n    )\n  }\n}\n\nexport default Item;\n","import React from 'react';\nimport { connect } from 'react-redux';\n\nimport Item from './Item';\nimport { IItem, IState } from '../reducers/interfaces';\nimport actions from '../reducers/actions';\n\ninterface IItemByIdProps {\n  id: string;\n  item?: IItem;\n  disabled?: boolean;\n  footer?: JSX.Element;\n  messageId?: number;\n  amount?: number;\n}\n\nconst ItemById = (props: IItemByIdProps) => {\n  const { id, item, ...itemProps } = props;\n\n  if (!item) {\n    actions.getItemById({ id });\n    return <React.Fragment/>;\n  }\n\n  return (\n    <Item\n      item={item}\n      {...itemProps}\n    />\n  );\n};\n\nconst mapStateToProps = (state: IState, props: IItemByIdProps) => {\n  const { items } = state;\n  const item = items.find((item: IItem) => item.id === props.id);\n\n  return { item }\n};\n\nexport default connect(mapStateToProps)(ItemById);\n","import React from 'react';\nimport { Button, Popconfirm } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\n\nimport { isURL } from '../../helpers/utils';\nimport { IMessage } from '../../reducers/interfaces';\nimport { importRolls } from '../../helpers/dice';\nimport Image from '../../components/Image';\nimport ItemById from '../../components/ItemById';\nimport actions from '../../reducers/actions';\n\ninterface IMessageBodyProps {\n  message: IMessage;\n  uid?: string;\n}\n\nconst MessageBody = (props: IMessageBodyProps) => {\n    const { uid, message } = props;\n    const {\n      body,\n      isRP,\n      rolls,\n      data,\n    } = message;\n\n    if (data) {\n      const { itemId, taken, amount, type } = data;\n\n      if (itemId) {\n        return (\n          <>\n            <i className=\"rp-message\">\n              {body}\n            </i>\n            <div className={taken ? '' : 'rp-message'}>\n              <ItemById\n                id={itemId.trim()}\n                amount={amount}\n                disabled={taken}\n                footer={uid && type ? (\n                  <Popconfirm\n                    title=\"Подобрать предмет?\"\n                    onConfirm={() => actions.takeItem({ uid, message, data })}\n                    okText=\"Подобрать\"\n                    cancelText=\"Отмена\"\n                    disabled={taken}\n                  >\n                    <Button className=\"take-button\" disabled={taken}>\n                      <UploadOutlined/>\n                    </Button>\n                  </Popconfirm>\n                ) : undefined}\n              />\n            </div>\n          </>\n        )\n      }\n    }\n\n    if (isURL(body)) {\n      if (/\\.(gif|jpe?g|tiff|png|webp|bmp)/ig.test(body)) {\n        return (\n          <Image src={body}/>\n        )\n      }\n\n      const link = (\n        <a\n          href={body}\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          {body}\n        </a>\n      );\n\n      // https://youtu.be/afeWQn4DFKQ\n      if (body.indexOf('youtu') > -1) {\n        const getVideoId = (body: string) => {\n          if (body.indexOf('youtu.be') > -1) {\n            const regExMatch = body.match(/youtu\\.be\\/.* /i);\n            if (regExMatch) {\n              const lastMatch = regExMatch.pop();\n              if (lastMatch) {\n                return lastMatch.split('/').pop() || '';\n              }\n            }\n          } else {\n            return new URL(body).searchParams.get('v') || '';\n          }\n          return ''\n        };\n\n        const searchParams = new URL(body).searchParams;\n        let params = 'listType=playlist';\n        const videoId = getVideoId(body);\n\n        if (videoId) {\n          const listId = searchParams.get('list');\n          if (listId)\n            params += '&list=' + listId;\n\n          const time = searchParams.get('t');\n          if (time)\n            params += '&start=' + time;\n\n          return (\n            <>\n              {link}\n              <iframe\n                title={videoId}\n                id=\"ytplayer\"\n                width=\"100%\"\n                height=\"360\"\n                src={`http://www.youtube.com/embed/${videoId}?${params}`}\n                frameBorder=\"0\"\n                allow=\"accelerometer; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n              />\n            </>\n          )\n        }\n      }\n\n      return link;\n    }\n\n    const _body = rolls\n      ? importRolls(body, rolls)\n      : body;\n\n    if (isRP) {\n      return (\n        <i className=\"rp-message\">\n          {_body}\n        </i>\n      )\n    }\n\n    return <span>{_body}</span>;\n  }\n;\n\nexport default MessageBody;\n","import React from 'react';\nimport { Card, Tooltip } from 'antd';\nimport { Link } from 'react-router-dom';\n\nimport { IMessage, IUser } from '../../reducers/interfaces';\nimport Avatar from '../../components/Avatar';\nimport MessageBody from './MessageBody';\nimport {\n  getDate,\n  getFullTime,\n  getTime,\n  isOnline\n} from '../../helpers/utils';\n\ninterface IMessageProps {\n  message: IMessage,\n  user: IUser,\n  uid: string;\n}\n\nconst Message = (props: IMessageProps) => {\n  const {\n    message: {\n      time,\n      grouped,\n      body,\n      mentioned,\n    },\n    user,\n    uid,\n  } = props;\n\n  const title = user && (\n    <Link to={`./${user.uid}/settings`}>\n      <Tooltip\n        title={user.lastOnline ? `Последняя активность: ${getFullTime(user.lastOnline)}` : undefined}\n        placement=\"left\"\n      >\n        <div className={`chat-message__title ${isOnline(user.lastOnline) ? 'online' : ''}`}>\n          <Avatar\n            avatar={user.avatar}\n            nickname={user.nickname}\n          />\n          <div className=\"chat-message__nickname\">\n            {user.nickname || user.uid}\n          </div>\n        </div>\n      </Tooltip>\n    </Link>\n  );\n\n  return (\n    <Card\n      className={`chat-message ${grouped ? 'grouped' : ''} ${mentioned && user && (body.indexOf(`@${user.nickname} `) > -1) ? 'mentioned' : ''}`}\n      title={title}\n      key={time}\n      extra={(\n        <Tooltip title={getDate(time)}>\n          <div className=\"chat-time\">{getTime(time)}</div>\n        </Tooltip>\n      )}\n    >\n      <MessageBody message={props.message} uid={uid}/>\n    </Card>\n  );\n};\n\nexport default Message;\n","import React, {\n  ChangeEvent,\n  Component,\n  KeyboardEvent,\n  ClipboardEvent,\n  DragEvent,\n} from 'react';\nimport { connect } from 'react-redux';\nimport { SendOutlined } from '@ant-design/icons';\nimport {\n  Input,\n  message as notify,\n  Spin,\n} from 'antd';\n\nimport '../../styles/chat.scss';\nimport actions from '../../reducers/actions';\nimport { IMessage, IState, IUser, IUsers } from '../../reducers/interfaces';\nimport Message from './Message';\nimport { validateMessage } from '../../helpers/utils';\n\ninterface IChatProps {\n  messages: IMessage[],\n  uid: string,\n  loading: boolean,\n  users: IUsers;\n  user: IUser;\n}\n\ninterface IChatState {\n  message: string;\n  sending: boolean;\n}\n\nclass Chat extends Component<IChatProps, IChatState> {\n  state = {\n    message: '',\n    sending: false,\n  };\n\n  componentDidMount = () => {\n    actions.getMessages({});\n    actions.subscribe({});\n    this.setState({ message: localStorage.getItem('message') || '' });\n  };\n\n  componentWillUnmount = () => {\n    actions.unsubscribe({});\n  };\n\n  componentDidUpdate = (prevProps: IChatProps) => {\n    const { messages, users } = this.props;\n\n    if (this.state.sending && prevProps.messages !== messages) {\n      localStorage.setItem('message', '');\n      this.setState({\n        message: '',\n        sending: false,\n      });\n    }\n\n    messages.forEach((m: IMessage) => {\n      if (!users[m.author]) {\n        actions.getUser({ uid: m.author });\n      }\n    });\n  };\n\n  onChangeMessage = (event: ChangeEvent<HTMLTextAreaElement>) => {\n    const message = event.target.value;\n    localStorage.setItem('message', message);\n    this.setState({ message });\n  };\n\n  onKeyDown = (event: KeyboardEvent<HTMLTextAreaElement>) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n\n      this.onSendMessage();\n    }\n\n    const { uid } = this.props;\n    if (event.key === 'Up' || event.key === 'ArrowUp') {\n      const message = this.props.messages.find((m: IMessage) => m.author === uid);\n      if (message) {\n        const { currentTarget: { value, selectionStart } } = event;\n        if (value.substr(0, selectionStart).split('\\n').length === 1) {\n          const { body } = message;\n          localStorage.setItem('message', body);\n          this.setState({ message: body });\n        }\n      }\n    }\n  };\n\n  onSendMessage = () => {\n    const { message } = this.state;\n    const { user, loading, uid } = this.props;\n\n    if (loading) {\n      return;\n    }\n\n    if (!user) {\n      notify.error('Данные о пользователе отсутствуют');\n      return;\n    }\n\n    if (!user.nickname) {\n      notify.error('Никнейм не установлен. Пройдите в настройки и назовите себя');\n      return;\n    }\n\n    if (!validateMessage(message)) {\n      return;\n    }\n\n    this.setState({ sending: true });\n    actions.sendMessage({\n      uid,\n      message,\n    });\n  };\n\n  getMoreMessages = () => {\n    actions.getMoreMessages({ firstMessage: this.props.messages[this.props.messages.length - 1] })\n  };\n\n  onScroll = (event: React.UIEvent<HTMLDivElement, UIEvent>) => {\n    if (event.currentTarget.scrollTop <= 50) {\n      event.preventDefault();\n      this.getMoreMessages();\n    }\n  };\n\n  uploadFile = (file: File, event: ClipboardEvent<HTMLTextAreaElement> | DragEvent<HTMLTextAreaElement>) => {\n    const { uid } = this.props;\n    if (file) {\n      if (file.type.indexOf('image') > -1) {\n        actions.uploadFile({ uid: uid, file });\n      } else {\n        notify.error('Только картинки могут быть загружены');\n      }\n      event.preventDefault();\n    }\n  };\n\n  onPaste = (e: ClipboardEvent<HTMLTextAreaElement>) => {\n    this.uploadFile(e.clipboardData.files[0], e)\n  };\n\n  onDrop = (e: DragEvent<HTMLTextAreaElement>) => {\n    const file = e.dataTransfer.items[0].getAsFile();\n    if (file)\n      this.uploadFile(file, e)\n  };\n\n  render = () => {\n    const { messages, loading, users, uid } = this.props;\n\n    return (\n      <Spin spinning={loading}>\n        <div className={`chat-wrapper`}>\n          <div\n            className=\"chat-body\"\n            onScroll={this.onScroll}\n          >\n            {messages.map((m: IMessage) => (\n              <Message\n                key={m.time}\n                message={m}\n                user={users[m.author]}\n                uid={uid}\n              />\n            ))}\n          </div>\n          <div className=\"chat-controls\">\n            <Input.TextArea\n              placeholder=\"Введите сообщение\"\n              autoSize={{ minRows: 1, maxRows: 10 }}\n              onChange={this.onChangeMessage}\n              onKeyDown={this.onKeyDown}\n              value={this.state.message}\n              onPaste={this.onPaste}\n              onDrop={this.onDrop}\n            />\n            <SendOutlined\n              onClick={this.onSendMessage}\n            />\n          </div>\n        </div>\n      </Spin>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { messages, uid, loading, users } = state;\n\n  return {\n    messages,\n    uid,\n    loading,\n    users,\n    user: users[uid]\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n","import React from 'react';\n\nexport default () => (\n  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"anticon-spin\" data-icon=\"sync\" width=\"1em\" height=\"1em\"\n       fill=\"#ff4d4f\" aria-hidden=\"true\">\n    <path d=\"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z\"/>\n  </svg>\n);\n","import React from 'react';\n\nexport default () => (\n  <svg viewBox=\"64 64 896 896\" focusable=\"false\" className=\"\" data-icon=\"check-circle\" width=\"1em\" height=\"1em\"\n       fill=\"currentColor\" aria-hidden=\"true\">\n    <path\n      d=\"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\"\n      fill=\"#52c41a\"/>\n    <path\n      d=\"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z\"\n      fill=\"transparent\"/>\n    <path\n      d=\"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z\"\n      fill=\"#52c41a\"/>\n  </svg>\n);\n","import React from 'react';\n\nimport LoadIcon from './LoadIcon';\nimport CheckIcon from './CheckIcon';\n\nconst Loader = (props: { loading: boolean }) => {\n  const { loading } = props;\n\n  return (\n    <div className=\"loader\">\n      {loading\n        ? (\n          <LoadIcon/>\n        ) : (\n          <CheckIcon/>\n        )\n      }\n    </div>\n  )\n};\n\nexport default Loader;\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Card,\n  Input,\n  Button,\n  Popconfirm, Switch,\n} from 'antd';\nimport { RouteComponentProps } from 'react-router';\n\nimport { ClearOutlined } from '@ant-design/icons';\n\nimport actions from '../../reducers/actions';\nimport { defaultUser } from '../../reducers';\nimport { IState, IUser } from '../../reducers/interfaces';\nimport Avatar from '../../components/Avatar';\nimport Loader from '../../components/Loader/index';\nimport { getFullTime } from '../../helpers/utils';\n\ninterface ISettingsProps extends RouteComponentProps {\n  loading: boolean;\n  user: IUser | null;\n  hasRight: boolean;\n  uid: string;\n  currentUser: IUser | null;\n}\n\nexport class Settings extends React.Component<ISettingsProps> {\n  componentDidMount = () => {\n    const { user, uid } = this.props;\n    if (!user) {\n      actions.getUser({ uid });\n    }\n  };\n\n  rawOnChange = (field: string, value: string | boolean) => {\n    const { user } = this.props;\n    if (!user) return;\n\n    const newSettings = {\n      ...user,\n      [field]: value,\n    };\n\n    this.setSettings(newSettings);\n  };\n\n  onChange = (field: string) =>\n    (event: ChangeEvent<HTMLInputElement>) =>\n      this.rawOnChange(field, event.target.value);\n\n  setSettings = (newSettings: {}) => {\n    const { user } = this.props;\n    if (user) {\n      actions.setUser({\n        uid: user.uid,\n        user: newSettings,\n      });\n    }\n  };\n\n  clearAvatar = () => this.setSettings({\n    ...this.props.user,\n    avatar: '',\n  });\n\n  getField = (key: string, value: string, user: IUser) => {\n    const { nickname = '' } = user;\n    const { hasRight, currentUser, uid } = this.props;\n    const disabled = !hasRight;\n\n    switch (key) {\n      case 'avatar':\n        return (\n          <div>\n            <div style={{ display: 'flex' }}>\n              <Input\n                value={value}\n                onChange={this.onChange(key)}\n                readOnly={disabled}\n              />\n              <Popconfirm\n                title=\"Очистить аватар?\"\n                onConfirm={this.clearAvatar}\n                okText=\"Да\"\n                cancelText=\"Нет\"\n                icon={<ClearOutlined style={{ color: '#ff4d4f' }}/>}\n                disabled={!value}\n              >\n                <Button\n                  disabled={disabled || !value}\n                  danger\n                >\n                  <ClearOutlined/>\n                </Button>\n              </Popconfirm>\n            </div>\n            <Avatar\n              avatar={value}\n              nickname={nickname}\n              size={128}\n              style={{ margin: '8px auto', display: 'block' }}\n            />\n          </div>\n        );\n\n      case 'uid':\n        return (\n          <Input\n            value={value}\n            readOnly\n          />\n        );\n\n      case 'lastOnline':\n        return value\n          ? (\n            <Input\n              value={getFullTime(parseInt(value))}\n              readOnly\n            />\n          ) : (\n            'Пользователь ещё не был активен'\n          );\n\n      case 'isAdmin':\n        return <>\n          {\n            (hasRight && (currentUser && currentUser.uid !== uid)) &&\n            <>\n              <Switch\n                checked={!!value}\n                onChange={(isAdmin: boolean) => this.rawOnChange(key, isAdmin)}\n              />\n            </>\n          }\n          {value ? 'Имеются' : 'Отсутствуют'}\n        </>;\n\n      default:\n        return (\n          <Input\n            defaultValue={value}\n            onChange={this.onChange(key)}\n            readOnly={disabled}\n          />\n        )\n    }\n  };\n\n  labels: { [key: string]: string } = {\n    'avatar': 'Аватар',\n    'nickname': 'Никнейм',\n    'lastOnline': 'Последняя активность',\n    'isAdmin': 'Права админа',\n    'uid': 'UID',\n  };\n\n  render = () => {\n    const { user, loading } = this.props;\n\n    return (\n      <Card\n        className=\"settings\"\n        bordered={false}\n        loading={user === undefined}\n        title={user && `Настройки игрока ${user.nickname || user.uid}`}\n      >\n        <Loader loading={loading}/>\n        {user && Object\n          .keys(defaultUser)\n          .map((key: string) => {\n            const label = this.labels[key];\n            return label && (\n              <Card\n                className={key}\n                key={key}\n                title={label}\n              >\n                {\n                  // @ts-ignore\n                  this.getField(key, `${user[key] || ''}`, user)\n                }\n              </Card>\n            )\n          })\n        }\n      </Card>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState, props: ISettingsProps) => {\n  const { loading, users, currentUser } = state;\n\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  return {\n    loading,\n    user,\n    uid,\n    hasRight: (!!user && !!currentUser) && (currentUser.uid === user.uid || !!currentUser.isAdmin),\n    currentUser,\n  };\n};\n\nexport default connect(mapStateToProps)(Settings);\n","import React from 'react';\nimport { Button, Avatar, Card } from 'antd';\n\nimport actions from '../reducers/actions';\n\nconst byeLink = 'https://cdn.lowgif.com/full/fc3d7d9abd06a92e-hi-bear-gifs-get-the-best-gif-on-giphy.gif';\n\nconst Logout = () => {\n  return (\n    <Card>\n      <Avatar\n        src={byeLink}\n        size={256}\n        style={{ margin: '0 auto', display: 'block' }}\n      />\n      <br/>\n      <br/>\n      <Button\n        type=\"primary\"\n        size=\"large\"\n        onClick={() => actions.logout({ })}\n        style={{ width: '100%' }}\n      >\n        Выйти\n      </Button>\n    </Card>\n  )\n};\n\nexport default Logout;\n","import React, { ChangeEvent, Component } from 'react';\nimport {\n  Card,\n  Input,\n  InputNumber,\n  Button,\n  Popconfirm,\n  message as notify,\n  Modal,\n  Select,\n  Switch,\n} from 'antd';\nimport { ClearOutlined, CloseOutlined } from '@ant-design/icons';\n\nimport { defaultItem, IItem } from '../../reducers/interfaces';\nimport Avatar from '../../components/Avatar';\n\ninterface IItemCreatorProps {\n  onSubmit: (item: IItem) => void;\n  onClose: () => void;\n  visible: boolean;\n  item?: IItem;\n  isAdmin?: boolean;\n}\n\nclass ItemCreator extends Component<IItemCreatorProps, IItem> {\n  state = defaultItem;\n\n  labels = {\n    id: 'ID',\n    type: 'Тип*',\n    name: 'Название*',\n    weight: 'Вес',\n    effect: 'Эффект',\n    image: 'Картинка',\n    description: 'Описание',\n    price: 'Цена',\n    capacity: 'Размер магазина',\n    armor: 'Защита',\n    approved: 'Подтверждён',\n  };\n\n  types = [\n    {\n      key: 'weapon',\n      value: 'Оружие',\n    },\n    {\n      key: 'wearable',\n      value: 'Одежда/Броня',\n    },\n    {\n      key: 'usable',\n      value: 'Используемое',\n    },\n    {\n      key: 'ammo',\n      value: 'Патроны',\n    },\n    {\n      key: 'misc',\n      value: 'Прочее',\n    },\n    {\n      key: 'note',\n      value: 'Записка',\n    },\n    {\n      key: 'key',\n      value: 'Ключ',\n    },\n    {\n      key: 'junk',\n      value: 'Мусор',\n    },\n  ];\n\n  onChange = (key: string, value: string | boolean | number) =>\n    // @ts-ignore\n    this.setState({ [key]: value });\n\n  clearImage = () =>\n    this.setState({ image: '' });\n\n  fields = {\n    id: () => false,\n    type: (value: string, key: string) => (\n      <Select\n        value={value}\n        onChange={(value: string) => this.onChange(key, value)}\n      >\n        {this.types.map(({ key, value }) => (\n          <Select.Option value={key} key={key}>\n            {value}\n          </Select.Option>\n        ))}\n      </Select>\n    ),\n    name: (value: string, key: string) => (\n      <Input\n        value={value}\n        onChange={(e: ChangeEvent<HTMLInputElement>) => this.onChange(key, e.currentTarget.value)}\n      />\n    ),\n    weight: (value: number, key: string) => (\n      <InputNumber\n        value={value}\n        min={0}\n        precision={2}\n        onChange={(value?: number) => this.onChange(key, value || 0)}\n        step={0.01}\n      />\n    ),\n    effect: (value: string, key: string) => (\n      <Input\n        value={value}\n        onChange={(e: ChangeEvent<HTMLInputElement>) => this.onChange(key, e.currentTarget.value)}\n      />\n    ),\n    image: (value: string, key: string) => (\n      <div>\n        <div style={{ display: 'flex' }}>\n          <Input\n            value={value}\n            onChange={(e: ChangeEvent<HTMLInputElement>) => this.onChange(key, e.currentTarget.value)}\n          />\n          <Popconfirm\n            title=\"Очистить картинку?\"\n            onConfirm={this.clearImage}\n            okText=\"Да\"\n            cancelText=\"Нет\"\n            icon={<ClearOutlined style={{ color: '#ff4d4f' }}/>}\n          >\n            <Button\n              disabled={!value}\n              danger\n            >\n              <ClearOutlined/>\n            </Button>\n          </Popconfirm>\n        </div>\n        <Avatar\n          shape=\"square\"\n          avatar={value}\n          nickname={value}\n          size={128}\n          style={{ margin: '8px auto', display: 'block' }}\n        />\n      </div>\n    ),\n    description: (value: string, key: string) => (\n      <Input.TextArea\n        value={value}\n        onChange={(e: ChangeEvent<HTMLTextAreaElement>) => this.onChange(key, e.currentTarget.value)}\n      />\n    ),\n    price: (value: number, key: string) => (\n      <InputNumber\n        value={value}\n        min={0}\n        step={1}\n        onChange={(value?: number) => this.onChange(key, value || 0)}\n      />\n    ),\n    capacity: (value: number, key: string, item: IItem) => (\n      item.type === 'weapon' && <InputNumber\n        value={value}\n        min={1}\n        step={1}\n        onChange={(value?: number) => this.onChange(key, value || 1)}\n      />\n    ),\n    armor: (value: number, key: string, item: IItem) => (\n      item.type === 'wearable' && <InputNumber\n        value={value}\n        min={0}\n        step={1}\n        onChange={(value?: number) => this.onChange(key, value || 0)}\n      />\n    ),\n    approved: (value: boolean, key: string) => (\n      this.props.isAdmin && <Switch\n        checked={value}\n        disabled={!this.props.isAdmin}\n        onChange={(checked: boolean) => this.onChange(key, checked)}\n      />\n    ),\n  };\n\n  getField = (key: string, value: string | number | boolean, item: IItem) => {\n    // @ts-ignore\n    const field = this.fields[key];\n    return field && field(value, key, item);\n  };\n\n  onSubmit = () => {\n    const { state } = this;\n    const { onSubmit, item = {} } = this.props;\n\n    const newItem: IItem = { ...state };\n    Object.keys(state).forEach((key: string) =>\n      // @ts-ignore\n      // eslint-disable-next-line\n      newItem[key] = newItem[key] === defaultItem[key] && item[key] || (newItem[key])\n    );\n\n    if (!newItem.name) {\n      notify.error('Имя не может быть пустым');\n      return;\n    }\n\n    onSubmit(newItem);\n    this.setState(defaultItem);\n  };\n\n  content = () => {\n    const { state } = this;\n    const { item = {} } = this.props;\n\n    return (\n      <div className=\"item-creator\">\n        <div className=\"item-creator__body\">\n          {Object\n            .keys(defaultItem)\n            .map((key: string) => {\n                // @ts-ignore\n                // eslint-disable-next-line\n                const value = state[key] === defaultItem[key] && item[key] || (state[key]);\n                const field = this.getField(key, value, state);\n                return field && (\n                  <Card\n                    className={key}\n                    key={key}\n                    // @ts-ignore\n                    title={this.labels[key]}\n                  >\n                    {field}\n                  </Card>\n                )\n              }\n            )\n          }\n        </div>\n        <div className=\"item-creator__controls\">\n          <Popconfirm\n            title=\"Все данные будут обнулены\"\n            onConfirm={() => this.setState(defaultItem)}\n            okText=\"Очистить\"\n            cancelText=\"Отмена\"\n            icon={<ClearOutlined style={{ color: '#ff4d4f' }}/>}\n          >\n            <Button>\n              Очистить\n            </Button>\n          </Popconfirm>\n          <Popconfirm\n            title=\"Подтвердить изменения?\"\n            onConfirm={this.onSubmit}\n            okText=\"Готово\"\n            cancelText=\"Отмена\"\n            icon={<ClearOutlined style={{ color: '#15395b' }}/>}\n          >\n            <Button>\n              Готово\n            </Button>\n          </Popconfirm>\n        </div>\n      </div>\n    )\n  };\n\n  render = () => {\n    const { onClose, visible } = this.props;\n\n    return (\n      <Modal\n        className=\"item-creator-modal\"\n        centered\n        closable={false}\n        onCancel={onClose}\n        footer={null}\n        visible={visible}\n        title={\n          <CloseOutlined onClick={onClose}/>\n        }\n      >\n        {this.content()}\n      </Modal>\n    )\n  }\n}\n\nexport default ItemCreator;\n","import React, { Component } from 'react';\nimport {\n  Dropdown,\n  Menu,\n  Button,\n  Empty,\n} from 'antd';\nimport { InsertRowBelowOutlined } from '@ant-design/icons';\n\nimport { IItem, IUser } from '../../reducers/interfaces';\nimport Item from '../../components/Item';\n\nexport interface IControl {\n  label: string,\n  onClick: (item: IItem) => void;\n  condition?: (item: IItem) => boolean;\n  isAdmin?: boolean;\n}\n\ninterface IItemsListProps {\n  items: IItem[];\n  uid?: string;\n  currentUser: IUser | null;\n  controls?: IControl[];\n}\n\nclass ItemsList extends Component<IItemsListProps> {\n  getFooter = (item: IItem) => {\n    const { controls } = this.props;\n    if (!controls) return;\n\n    const controlButtons = controls\n      .map(({ label, onClick, isAdmin, condition }: IControl) => {\n        if (condition && !condition(item)) return false;\n\n        return (\n          <Menu.Item key={label}>\n            <Button onClick={() => onClick && onClick(item)}>\n              {label}\n            </Button>\n          </Menu.Item>\n        );\n      }).filter(Boolean);\n    if (controlButtons.length === 0) return;\n\n    return (\n      <Dropdown\n        overlay={<Menu>{controlButtons}</Menu>}\n        trigger={['click']}\n      >\n        <Button>\n          <InsertRowBelowOutlined/>\n        </Button>\n      </Dropdown>\n    )\n  };\n\n  render = () => {\n    const { items, uid } = this.props;\n\n    if (!items || items.length === 0) {\n      return (\n        <Empty description=\"Нет предметов\"/>\n      )\n    }\n\n    return (\n      <div className=\"items-body\">\n        {items.map((item: IItem) => (\n          <Item\n            key={item.id + item.time}\n            item={item}\n            footer={this.getFooter(item)}\n            uid={uid}\n          />\n        ))}\n      </div>\n    )\n  }\n}\n\nexport default ItemsList;\n","import React, { Component } from 'react';\nimport {\n  Switch,\n  Radio,\n  Card,\n} from 'antd';\n\nimport Loader from '../../components/Loader';\nimport { RouteComponentProps } from \"react-router\";\nimport { IItem, ItemType } from \"../../reducers/interfaces\";\n\nexport interface IItemsTableProps extends RouteComponentProps {\n  loading: boolean;\n  items: IItem[];\n}\n\nexport interface IItemsTableState {\n  searchString: string;\n  filters: { [key: string]: boolean };\n  showApproved: boolean;\n  showNotApproved: boolean;\n}\n\nclass ItemsTable<P extends IItemsTableProps, S extends IItemsTableState> extends Component<P, S> {\n  defaultState = {\n    searchString: '',\n    showApproved: true,\n    showNotApproved: false,\n    filters: {\n      'weapon': true,\n      'usable': true,\n      'wearable': true,\n      'junk': true,\n      'ammo': true,\n      'note': true,\n      'key': true,\n      'misc': true,\n    },\n  };\n\n  get items() {\n    const { searchString, filters, showApproved, showNotApproved } = this.state;\n\n    const _searchString = searchString.toLowerCase();\n    return this\n      .props\n      .items\n      .filter((item: IItem) => {\n        const { name, description, effect, type, approved } = item;\n        return (\n          (name && name.toLowerCase().indexOf(_searchString) > -1)\n          || (description && description.toLowerCase().indexOf(_searchString) > -1)\n          || (effect && effect.toLowerCase().indexOf(_searchString) > -1)\n        ) && (\n          // @ts-ignore\n          filters[type]\n        ) && (\n          (showApproved && approved === true)\n          || (showNotApproved && approved === false)\n        )\n      })\n  }\n\n  getFilters = (state: IItemsTableState) => {\n    const { showNotApproved, showApproved, filters } = state;\n\n    const getButton = (name: ItemType, label: string) => (\n      <div\n        tabIndex={0}\n        className=\"items-approved-button\"\n        // @ts-ignore\n        onClick={() => {\n          console.log(name, filters[name]);\n          this.setState({ filters: { ...filters, [name]: !filters[name] } })\n        }}\n      >\n        <Switch\n          checked={\n            // @ts-ignore\n            filters[name]\n          }/>\n        {label}\n      </div>\n    );\n\n    return (\n      <Radio.Group\n        defaultValue={undefined}\n        style={{ display: 'flex', flexDirection: 'column' }}\n      >\n        {getButton('weapon', 'Оружие')}\n        {getButton('usable', 'Используемое')}\n        {getButton('wearable', 'Одежда/Броня')}\n        {getButton('ammo', 'Патроны')}\n        {getButton('junk', 'Мусор')}\n        {getButton('note', 'Записки')}\n        {getButton('key', 'Ключи')}\n        {getButton('misc', 'Прочее')}\n        <div tabIndex={0} className=\"items-approved-button\"\n             onClick={() => this.setState({ showApproved: !showApproved })}>\n          <Switch checked={showApproved}/>Подтвержденные\n        </div>\n        <div tabIndex={0} className=\"items-approved-button\"\n             onClick={() => this.setState({ showNotApproved: !showNotApproved })}>\n          <Switch checked={showNotApproved}/>Не Подтвержденные\n        </div>\n      </Radio.Group>\n    )\n  };\n\n  getPageControls: (() => JSX.Element[]) = () => [];\n  getHeader: ((items: IItem[]) => JSX.Element) = () => {\n    return (\n      <div className=\"items-controls\">\n        {this.getPageControls()}\n      </div>\n    )\n  };\n\n  getContent: ((items: IItem[]) => JSX.Element) = () => <React.Fragment/>;\n  getFooter: ((items: IItem[]) => JSX.Element) = () => <React.Fragment/>;\n  getTitle: () => string | undefined | false = () => undefined;\n\n  render = () => {\n    const { loading } = this.props;\n    const items = this.items;\n\n    return (\n      <Card className=\"items\" title={this.getTitle()}>\n        <Loader loading={loading}/>\n        {this.getHeader(items)}\n        {this.getContent(items)}\n        {this.getFooter(items)}\n      </Card>\n    )\n  }\n}\n\nexport default ItemsTable;\n","import React, { useState } from 'react';\nimport { InputNumber, Modal, Slider } from 'antd';\nimport { InputNumberProps } from 'antd/lib/input-number';\nimport { ModalFuncProps } from 'antd/lib/modal';\n\nimport { IItem } from '../reducers/interfaces';\n\ninterface IAmountModalProps {\n  item: IItem;\n  inputProps?: InputNumberProps;\n  modalProps?: ModalFuncProps;\n  onSubmit?: (value: number) => void;\n  onChange?: (value?: number | [number, number]) => void;\n  max?: number;\n}\n\nexport const AmountModal: (props: IAmountModalProps) => JSX.Element = (props) => {\n  const { item, inputProps, onChange, max } = props;\n\n  const [amount, setAmount] = useState(1);\n  const onInnerChange = (value?: number | [number, number]) => {\n    if (typeof value === 'number') {\n      setAmount(value || 1);\n      onChange && onChange(value || 1);\n    }\n  };\n\n  return (\n    <>\n      <InputNumber\n        defaultValue={1}\n        value={amount}\n        min={1}\n        max={max || item.amount}\n        onChange={onInnerChange}\n        {...(inputProps || {})}\n      />\n      <Slider\n        value={amount}\n        defaultValue={1}\n        min={1}\n        max={max || item.amount}\n        onChange={onInnerChange}\n        dots={(max || item.amount || 10) <= 12}\n      />\n    </>\n  )\n};\n\n/**\n * This function creates modal for choosing item quantity.\n * I didn't made a simple modal, because I would need to make\n * a lot of state actions in order to pass all needed data\n */\nconst amountModal: (props: IAmountModalProps) => void = (props) => {\n  const { item, onSubmit, modalProps, max } = props;\n  const enough = (max && max >= 2) || (!max && item.amount && item.amount >= 2);\n  const title = enough\n    ? `Сколько? (макс. ${max || item.amount}шт)`\n    : 'Уверены?';\n\n  let amount = 1;\n\n  Modal.confirm({\n    title: title,\n    className: 'amount-modal',\n    content: enough && (\n      <AmountModal\n        {...props}\n        onChange={(value?: number | [number, number]) => {\n          if (typeof value === 'number') amount = value;\n        }}\n      />\n    ),\n    onOk: (close) => {\n      onSubmit && onSubmit(amount);\n      close();\n    },\n    okText: 'Готово',\n    cancelText: 'Отмена',\n    maskClosable: true,\n    centered: true,\n    ...(modalProps || {}),\n  });\n};\n\nexport default amountModal;\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Button,\n  Input,\n  Dropdown,\n  InputNumber,\n  Tooltip,\n  Modal,\n} from 'antd';\nimport { FilterOutlined } from '@ant-design/icons';\n\nimport '../../styles/items.scss';\nimport actions from '../../reducers/actions';\nimport { IDeletedItemData, IItem, IState, IUser } from '../../reducers/interfaces';\nimport ItemCreator from './ItemCreator';\nimport ItemsList, { IControl } from '../ItemsTable/ItemsList';\nimport ItemsTable, { IItemsTableProps, IItemsTableState } from \"../ItemsTable\";\nimport amountModal from \"../../components/AmountModal\";\n\nexport interface IItemsProps extends IItemsTableProps {\n  user: IUser | null;\n  uid: string;\n  currentUser: IUser | null;\n  deletingItemData: IDeletedItemData;\n}\n\ninterface IItemsState extends IItemsTableState {\n  creatingItem: boolean;\n  editingItem: IItem | null;\n  itemsToLoad: number;\n}\n\nexport class Items extends ItemsTable<IItemsProps, IItemsState> {\n  state = {\n    ...this.defaultState,\n    creatingItem: false,\n    editingItem: null,\n    itemsToLoad: 99,\n  };\n\n  componentDidMount = () => {\n    actions.getItems({});\n  };\n\n  getPageControls = () => [\n    <Button\n      key=\"creator\"\n      onClick={() => this.toggleCreatingItem(true)}\n    >\n      Создать предмет\n    </Button>,\n    <Input\n      key=\"search\"\n      placeholder=\"Поиск предмета\"\n      onChange={(e: ChangeEvent<HTMLInputElement>) => this.setState({ searchString: e.currentTarget.value })}\n      allowClear\n    />,\n    <Dropdown\n      key=\"filters\"\n      overlay={this.getFilters(this.state)}\n      trigger={['click']}\n    >\n      <Button>\n        <FilterOutlined/>\n      </Button>\n    </Dropdown>,\n    <Tooltip\n      key=\"load-amount\"\n      title=\"Кол-во загружаемых предметов за раз\"\n    >\n      <InputNumber\n        value={this.state.itemsToLoad}\n        min={1}\n        max={99}\n        onChange={(itemsToLoad?: number) => this.setState({ itemsToLoad: itemsToLoad || 1 })}\n      />\n    </Tooltip>\n  ];\n\n  cardControls: IControl[] = [\n    {\n      label: 'Взять',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        max: 100,\n        onSubmit: (amount: number) =>\n          actions.giveItem({\n            id: item.id,\n            uid: this.props.uid,\n            itemType: item.type,\n            amount,\n          })\n      }),\n      condition: (item: IItem) => item.approved && Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n    {\n      label: 'Редактировать',\n      onClick: (item: IItem) => this.toggleEditingItem(item),\n      condition: (item: IItem) => Boolean((this.props.uid === item.author && !item.approved) || (this.props.currentUser && this.props.currentUser.isAdmin))\n    },\n    {\n      label: 'В консоль',\n      onClick: console.log,\n      condition: () => Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n    {\n      label: 'Удалить',\n      onClick: (item: IItem) => this.deleteModal(item),\n      condition: (item: IItem) => Boolean((this.props.uid === item.author && !item.approved) || (this.props.currentUser && this.props.currentUser.isAdmin))\n    },\n  ];\n\n  toggleCreatingItem = (creatingItem: boolean = !this.state.creatingItem) =>\n    this.setState({ creatingItem });\n\n  toggleEditingItem = (item?: IItem | null) =>\n    this.setState({ editingItem: item || null });\n\n  onCreateItem = (item: IItem) => {\n    actions.setItem({ item });\n    this.toggleCreatingItem(false);\n    this.toggleEditingItem(null);\n  };\n\n  getCreators = () => {\n    const { creatingItem, editingItem } = this.state;\n    const { currentUser } = this.props;\n    const isAdmin = !!(currentUser && currentUser.isAdmin);\n\n    return (\n      <>\n        <ItemCreator\n          visible={creatingItem}\n          onClose={() => this.toggleCreatingItem(false)}\n          onSubmit={this.onCreateItem}\n          isAdmin={isAdmin}\n        />\n        <ItemCreator\n          visible={!!editingItem}\n          onClose={() => this.toggleEditingItem(null)}\n          onSubmit={this.onCreateItem}\n          item={editingItem || undefined}\n          isAdmin={isAdmin}\n        />\n      </>\n    )\n  };\n\n  deleteModal: (item: IItem) => void = (item: IItem) => Modal.confirm({\n    title: 'Удалить',\n    content: 'Это действие невозможно отменить. Вы уверены?',\n    maskClosable: true,\n    okText: 'Удалить',\n    cancelText: 'Отмена',\n    onOk: (close) => {\n      actions.deleteItem({ id: item.id });\n      close();\n    }\n  });\n\n  getContent = (items: IItem[]) => {\n    const { currentUser } = this.props;\n    return (\n      <ItemsList\n        items={items}\n        currentUser={currentUser}\n        controls={this.cardControls}\n      />\n    )\n  };\n\n  getDeletingModal = () => {\n    const { deletingItemData, loading } = this.props;\n    const { itemId, usersChecked, messagesCleared, messagesChecked, deleted, usersCleared, done } = deletingItemData;\n    return itemId && (\n      <div className=\"item-deleting-modal\">\n        <div>ID предмета: {itemId}</div>\n        <div>Удалён из списка предметов: {deleted ? 'готово' : 'в процессе'}</div>\n        <div>Проверено сообщений: {messagesChecked}</div>\n        <div>Очищено сообщений: {messagesCleared}</div>\n        <div>Проверено пользователей: {usersChecked}</div>\n        <div>Очищено пользователей: {usersCleared}</div>\n        <Button\n          onClick={() => actions.deleteItemProgress({ field: 'itemId', value: '' })}\n          disabled={!done || loading}\n        >\n          Готово\n        </Button>\n        <button\n          className=\"secret\"\n          onClick={() => actions.deleteItemProgress({ field: 'itemId', value: '' })}\n          disabled={loading}\n        />\n      </div>\n    )\n  };\n\n  getTitle = () => !this.props.loading && `Список предметов. Количество: ${this.props.items.length}`;\n\n  getFooter = (items: IItem[]): JSX.Element => {\n    const { itemsToLoad } = this.state;\n    const { loading } = this.props;\n    return (\n      <>\n        {this.getCreators()}\n        {this.getDeletingModal()}\n        {!loading && (\n          <Button\n            className=\"items-load-button\"\n            onClick={() => actions.getMoreItems({ amount: itemsToLoad, lastItem: items[items.length - 1] })}\n          >\n            Загрузить {itemsToLoad}шт\n          </Button>\n        )}\n      </>\n    )\n  };\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { loading, currentUser, uid, items, deletingItemData } = state;\n\n  return {\n    loading,\n    currentUser,\n    uid,\n    items,\n    deletingItemData,\n  };\n};\n\nexport default connect(mapStateToProps)(Items);\n","import React, { Component } from 'react';\nimport { Menu } from 'antd';\nimport '../styles/active-users.scss';\n\nimport { IUsers, IUser, IState } from '../reducers/interfaces';\nimport { connect } from \"react-redux\";\nimport actions from \"../reducers/actions\";\nimport { getFullTime, isOnline } from \"../helpers/utils\";\nimport Avatar from './Avatar';\n\ninterface IActiveUsersListProps {\n  activeUsers: string[];\n  uid: string;\n  loading: boolean;\n  users: IUsers;\n  onClick: (user: IUser) => void;\n}\n\nclass ActiveUsersList extends Component<IActiveUsersListProps> {\n  componentDidMount = () => {\n    actions.getUsersActivity({});\n  };\n\n  componentDidUpdate = () => {\n    const { activeUsers, users, loading } = this.props;\n\n    if (!loading && activeUsers.length > 0) {\n      activeUsers.forEach((uid: string) => {\n        if (!users[uid])\n          actions.getUser({ uid });\n      });\n    }\n  };\n\n  render = () => {\n    const { activeUsers, users, onClick } = this.props;\n\n    const validUsers = activeUsers\n      .filter((uid: string) => users[uid] && users[uid].uid)\n      .map((uid: string) => users[uid]);\n\n    return (\n      <Menu className=\"active-users\">\n        {validUsers.map((user: IUser) => (\n          <div\n            className=\"active-users__item\"\n            key={user.uid}\n            onClick={() => onClick(user)}\n          >\n              <div className={`active-users__body ${isOnline(user.lastOnline) ? 'online' : ''}`}>\n                <Avatar\n                  avatar={user.avatar}\n                  nickname={user.nickname}\n                />\n                <div className=\"active-users__nickname\">\n                  {user.nickname || user.uid}\n                </div>\n              </div>\n              {user.lastOnline && (\n                <div className=\"active-users__online\">\n                  {getFullTime(user.lastOnline)}\n                </div>\n              )}\n          </div>\n        ))}\n      </Menu>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { usersActivity, uid, loading, users } = state;\n\n  return {\n    users,\n    activeUsers: Object.keys(usersActivity),\n    uid,\n    loading,\n  }\n};\n\nexport default connect(mapStateToProps)(ActiveUsersList);\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Input,\n  Dropdown,\n  Button,\n  message as notify,\n  Modal,\n} from 'antd';\nimport { FilterOutlined } from '@ant-design/icons';\n\nimport { IInventory, IItem, IState, IUser } from '../../reducers/interfaces';\nimport actions from '../../reducers/actions';\nimport ItemsList, { IControl } from '../ItemsTable/ItemsList';\nimport ActiveUsersList from '../../components/ActiveUsersList';\nimport ItemsTable, { IItemsTableProps, IItemsTableState } from '../ItemsTable';\nimport amountModal from '../../components/AmountModal';\nimport { getItemName } from \"../../helpers/utils\";\n\ninterface IInventoryProps extends IItemsTableProps {\n  inventory: IInventory;\n  loading: boolean;\n  user: IUser | null;\n  uid: string;\n  items: IItem[];\n  currentUser: IUser | null;\n}\n\ninterface IInventoryState extends IItemsTableState {\n  passItem: IItem | null;\n}\n\nclass Inventory extends ItemsTable<IInventoryProps, IInventoryState> {\n  state = {\n    ...this.defaultState,\n    editingItem: null,\n    passItem: null,\n  };\n\n  componentDidMount = () => {\n    const { user, uid } = this.props;\n    if (!user && uid) {\n      actions.getUser({ uid });\n    }\n  };\n\n  getPageControls = () => [\n    <Input\n      key=\"search\"\n      placeholder=\"Поиск предмета\"\n      onChange={(e: ChangeEvent<HTMLInputElement>) => this.setState({ searchString: e.currentTarget.value })}\n      allowClear\n    />,\n    <Dropdown\n      key=\"filters\"\n      overlay={this.getFilters(this.state)}\n      trigger={['click']}\n    >\n      <Button>\n        <FilterOutlined/>\n      </Button>\n    </Dropdown>,\n    this.getPassModal(),\n  ];\n\n  getInventoryItems = (items: IItem[]) => {\n    const { inventory, loading } = this.props;\n\n    if (inventory && !loading) {\n      const inventoryItems = Object.values(inventory);\n      const loadedItems: IItem[] = [];\n      const notLoadedItems: string[] = [];\n\n      inventoryItems\n        .forEach((inventoryItem) => {\n          const { id } = inventoryItem;\n          const item = items.find((item: IItem) => item.id === id);\n          if (item) {\n            loadedItems.push({\n              ...item,\n              ...inventoryItem,\n            });\n          } else {\n            notLoadedItems.push(id);\n          }\n        });\n\n      if (notLoadedItems.length > 0) {\n        actions.getItemById({ id: notLoadedItems.shift() });\n      }\n\n      return loadedItems;\n    }\n\n    return [];\n  };\n\n  passItem = (item?: IItem | null) =>\n    this.setState({ passItem: item || null });\n\n  getPassModal = () => {\n    const { passItem } = this.state;\n    return (\n      <Modal\n        key=\"pass-modal\"\n        visible={!!passItem}\n        closable={false}\n      >\n        <ActiveUsersList onClick={(user: IUser) => {\n          if (passItem !== null) {\n            actions.passItem({\n              uid: this.props.uid,\n              // @ts-ignore\n              id: passItem.id,\n              to: user,\n              item: passItem,\n            });\n            this.passItem(null);\n          }\n        }}/>\n      </Modal>\n    )\n  };\n\n  getDeleteModalContent = (item: IItem) => (\n    <div>\n      <span>Это действие невозможно отменить. Вы уверены?</span>\n      <br/> <br/> <br/>\n      <Button\n        style={{ width: '-webkit-fill-available' }}\n        onClick={() => {\n          actions.removeItem({ id: item.id, uid: this.props.uid });\n          notify.success('Удалено');\n        }}\n      >Удалить один</Button>\n    </div>\n  );\n\n  cardControls: IControl[] = [\n    {\n      label: 'Показать',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) => actions.passItem({\n          id: item.id,\n          uid: this.props.uid,\n          demonstrate: true,\n          item: {\n            ...item,\n            amount,\n          }\n        })\n      })\n    },\n    {\n      label: 'Использовать',\n      onClick: (item: IItem) => Modal.confirm({\n        title: `Использовать ${getItemName(item, false)}?`,\n        onOk: (close) => {\n          actions.passItem({\n            id: item.id,\n            uid: this.props.uid,\n            item: {\n              ...item,\n              amount: 1,\n            },\n            use: true,\n          });\n          close();\n        },\n        okText: 'Да',\n        cancelText: 'Отмена',\n      }),\n      condition: (item: IItem) => item.type === 'usable',\n    },\n    {\n      label: 'Выбросить',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) => actions.passItem({\n          id: item.id,\n          uid: this.props.uid,\n          item: {\n            ...item,\n            amount,\n          },\n        })\n      }),\n    },\n    {\n      label: 'Передать',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) => this.passItem({ ...item, amount })\n      })\n    },\n    {\n      label: 'В консоль',\n      onClick: console.log,\n      condition: () => Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n    {\n      label: 'Убрать',\n      onClick: (item: IItem) => amountModal({\n        item: item,\n        onSubmit: (amount: number) =>\n          actions.removeItem({ id: item.id, uid: this.props.uid, amount })\n      }),\n      condition: () => Boolean(this.props.currentUser && this.props.currentUser.isAdmin)\n    },\n  ];\n\n  getTitle = () => !!this.props.user && `Инвентарь игрока ${this.props.user.nickname || this.props.user.uid}`;\n\n  getContent = (items: IItem[]) => {\n    const { currentUser, uid } = this.props;\n\n    return (\n      <ItemsList\n        uid={uid}\n        currentUser={currentUser}\n        items={this.getInventoryItems(items)}\n        controls={(currentUser && (currentUser.uid === uid || currentUser.isAdmin))\n          ? this.cardControls\n          : undefined\n        }\n      />\n    )\n  };\n}\n\nconst mapStateToProps = (state: IState, props: IInventoryProps) => {\n  const { loading, users, currentUser, items, messages, usersActivity } = state;\n\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  const inventory = user ? user.inventory : {};\n\n  return {\n    loading,\n    uid,\n    items,\n    inventory,\n    user,\n    currentUser,\n    users,\n    messages,\n    usersActivity,\n  };\n};\n\nexport default connect(mapStateToProps)(Inventory);\n","export interface IField {\n  label: string;\n  full: string;\n  field: string;\n  formula?: string;\n  getBase?: (specials: { [key: string]: number }, stats: IStats) => number;\n\n}\n\nexport interface IStats {\n  level: number;\n  hpPerLevel: number;\n  exp: number;\n  carryWeight: number;\n  wounds: string;\n\n  healthPoints: number;\n  maxHealthPoints: number;\n  armorClass: ICharacteristic;\n  healingRate: number;\n  resistance: number;\n  actionPoints: number;\n  sequence: number;\n  meleeDamage: number;\n  criticalChance: number;\n  skillPoints: number;\n  spentSkillPoints: number;\n}\n\nexport interface ICharacteristic {\n  change: number;\n  base: number;\n  total: number;\n}\n\nexport interface ICharacter {\n  special: {\n    strength: ICharacteristic;\n    perception: ICharacteristic;\n    endurance: ICharacteristic;\n    charisma: ICharacteristic;\n    intelligence: ICharacteristic;\n    agility: ICharacteristic;\n    luck: ICharacteristic;\n  };\n  skills: {\n    smallGuns: ICharacteristic;\n    bigGuns: ICharacteristic;\n    energyGuns: ICharacteristic;\n    unarmed: ICharacteristic;\n    meleeWeapons: ICharacteristic;\n    medicine: ICharacteristic;\n    sneak: ICharacteristic;\n    lockpick: ICharacteristic;\n    steal: ICharacteristic;\n    traps: ICharacteristic;\n    science: ICharacteristic;\n    repair: ICharacteristic;\n    speech: ICharacteristic;\n    barter: ICharacteristic;\n    survival: ICharacteristic;\n  };\n  stats: IStats;\n  bio: string;\n}\n\nexport const initialCharacteristic = {\n  change: 0,\n  base: 0,\n  total: 0,\n};\n\nexport const initialCharacter: ICharacter = {\n  special: {\n    strength: initialCharacteristic,\n    perception: initialCharacteristic,\n    endurance: initialCharacteristic,\n    charisma: initialCharacteristic,\n    intelligence: initialCharacteristic,\n    agility: initialCharacteristic,\n    luck: initialCharacteristic,\n  },\n  skills: {\n    smallGuns: initialCharacteristic,\n    bigGuns: initialCharacteristic,\n    energyGuns: initialCharacteristic,\n    unarmed: initialCharacteristic,\n    meleeWeapons: initialCharacteristic,\n    medicine: initialCharacteristic,\n    sneak: initialCharacteristic,\n    lockpick: initialCharacteristic,\n    steal: initialCharacteristic,\n    traps: initialCharacteristic,\n    science: initialCharacteristic,\n    repair: initialCharacteristic,\n    speech: initialCharacteristic,\n    barter: initialCharacteristic,\n    survival: initialCharacteristic,\n  },\n  stats: {\n    level: 0,\n    hpPerLevel: 0,\n    exp: 0,\n    carryWeight: 0,\n    wounds: '',\n\n    maxHealthPoints: 0,\n    healthPoints: 0,\n    armorClass: initialCharacteristic,\n    healingRate: 0,\n    resistance: 0,\n    actionPoints: 0,\n    sequence: 0,\n    meleeDamage: 0,\n    criticalChance: 0,\n    skillPoints: 0,\n    spentSkillPoints: 0,\n  },\n  bio: '',\n};\n\nexport const special: IField[] = [\n  {\n    label: 'ST',\n    full: 'Сила',\n    field: 'strength',\n  },\n  {\n    label: 'PE',\n    full: 'Восприятие',\n    field: 'perception',\n  },\n  {\n    label: 'EN',\n    full: 'Выносливость',\n    field: 'endurance',\n  },\n  {\n    label: 'CH',\n    full: 'Харизма',\n    field: 'charisma',\n  },\n  {\n    label: 'IN',\n    full: 'Интеллект',\n    field: 'intelligence',\n  },\n  {\n    label: 'AG',\n    full: 'Ловкость',\n    field: 'agility',\n  },\n  {\n    label: 'LK',\n    full: 'Удача',\n    field: 'luck',\n  },\n];\n\nexport const skills: IField[] = [\n  {\n    label: 'Small Guns',\n    full: 'Оружие',\n    formula: '5+(4*AG)',\n    field: 'smallGuns',\n    getBase: (s) => 5 + (4 * s.ag),\n  },\n  {\n    label: 'Big Guns',\n    full: 'Большое оружие',\n    formula: '(2*AG)',\n    field: 'bigGuns',\n    getBase: (s) => (2 * s.ag),\n  },\n  {\n    label: 'Energy Guns',\n    full: 'Энергетическое оружие',\n    formula: '(2*AG)',\n    field: 'energyGuns',\n    getBase: (s) => (2 * s.ag),\n  },\n  {\n    label: 'Unarmed',\n    full: 'Без оружия',\n    formula: '(30+(2*(AG+ST)))',\n    field: 'unarmed',\n    getBase: (s) => 30 + (2 * (s.ag + s.st)),\n  },\n  {\n    label: 'Melee',\n    full: 'Холодное оружие',\n    formula: '20+(2*(AG+ST))',\n    field: 'meleeWeapons',\n    getBase: (s) => 20 + (2 * (s.ag + s.st)),\n  },\n  {\n    label: 'Medicine',\n    full: 'Медицина',\n    formula: '5+(PE+EN+(3*AG))',\n    field: 'medicine',\n    getBase: (s) => 5 + (s.pe + s.en + (3 * s.ag)),\n  },\n  {\n    label: 'Sneak',\n    full: 'Скрытность',\n    formula: '5+(3*AG)',\n    field: 'sneak',\n    getBase: (s) => 5 + (3 * s.ag),\n  },\n  {\n    label: 'Lockpick',\n    full: 'Взлом',\n    formula: '10+(PE+AG)',\n    field: 'lockpick',\n    getBase: (s) => 10 + (s.pe + s.ag),\n  },\n  {\n    label: 'Steal',\n    full: 'Кража',\n    formula: '(3+AG)',\n    field: 'steal',\n    getBase: (s) => 3 + s.ag,\n  },\n  {\n    label: 'Traps',\n    full: 'Ловушки',\n    formula: '10+(PE+AG)',\n    field: 'traps',\n    getBase: (s) => 10 + (s.pe + s.ag),\n  },\n  {\n    label: 'Science',\n    full: 'Наука',\n    formula: '(4*IN)',\n    field: 'science',\n    getBase: (s) => 4 * s.in,\n  },\n  {\n    label: 'Repair',\n    full: 'Ремонт',\n    formula: '(3*IN)',\n    field: 'repair',\n    getBase: (s) => 3 * s.in,\n  },\n  {\n    label: 'Speech',\n    full: 'Красноречие',\n    formula: '(5*CH)',\n    field: 'speech',\n    getBase: (s) => 5 * s.ch,\n  },\n  {\n    label: 'Barter',\n    full: 'Бартер',\n    formula: '(4*CH)',\n    field: 'barter',\n    getBase: (s) => 4 * s.ch,\n  },\n  {\n    label: 'Survival',\n    full: 'Выживание',\n    formula: '(2*(EN+IN))',\n    field: 'survival',\n    getBase: (s) => 2 * (s.en + s.in),\n  },\n];\n\nexport const stats: IField[] = [\n  {\n    label: 'Level',\n    full: 'Уровень',\n    field: 'level',\n    getBase: (_, stats) => (Math.sqrt(((stats.exp / 500) * 4) + 1) + 1) / 2,\n  },\n  {\n    label: 'HP/Level',\n    full: 'ОЗ/Уровень',\n    field: 'hpPerLevel',\n    getBase: (s) => 3 + Math.floor(s.en / 2),\n  },\n  {\n    label: 'Experience',\n    full: 'Опыт',\n    field: 'exp',\n  },\n  {\n    label: 'Carry Weight',\n    full: 'Переносимый вес',\n    field: 'carryWeight',\n    getBase: (s) => 25 + (25 * s.st),\n  },\n  {\n    label: 'Wounds',\n    full: 'Раны',\n    field: 'wounds',\n  },\n];\n\nexport const subStats: IField[] = [\n  {\n    label: 'Max HP',\n    full: 'Макс. Очки Здоровья (ОЗ)',\n    field: 'maxHealthPoints',\n    getBase: (s, stats) => (15 + (s.st + (2 * s.en))) + (stats.hpPerLevel * stats.level),\n  },\n  {\n    label: 'Health Points',\n    full: 'Очки Здоровья (ОЗ)',\n    field: 'healthPoints',\n  },\n  {\n    label: 'КБ',\n    full: 'Класс Брони',\n    field: 'armorClass',\n    getBase: (s) => s.ag,\n  },\n  {\n    label: 'СЛ',\n    full: 'СамоЛечение',\n    field: 'healingRate',\n    getBase: (s) => Math.floor(s.en / 3),\n  },\n  {\n    label: 'СП',\n    full: 'СоПротивление',\n    field: 'resistance',\n    getBase: (s) => 5 * s.en,\n  },\n  {\n    label: 'ОД',\n    full: 'Очки Действий',\n    field: 'actionPoints',\n    getBase: (s) => 5 + Math.ceil(s.ag / 2),\n  },\n  {\n    label: 'ИЦ',\n    full: 'ИниЦиатива',\n    field: 'sequence',\n    getBase: (s) => 2 * s.pe,\n  },\n  {\n    label: 'РУ',\n    full: 'Рукопашный Урон',\n    field: 'meleeDamage',\n    getBase: (s) => Math.max(1, s.st - 5),\n  },\n  {\n    label: 'ШК',\n    full: 'Шанс Крита',\n    field: 'criticalChance',\n    getBase: (s) => s.lk,\n  },\n  {\n    label: 'ОН',\n    full: 'Очки Навыков',\n    field: 'skillPoints',\n    getBase: (s, stats) => ((stats.level - 1) * (5 + (2 * s.in)) - stats.spentSkillPoints),\n  },\n];\n\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Form,\n  Card,\n  Input,\n  InputNumber,\n  Tooltip,\n  Empty,\n  Spin,\n  Button,\n  Popconfirm,\n} from 'antd';\nimport { Callbacks, Store } from 'rc-field-form/lib/interface';\nimport { RouteComponentProps } from 'react-router';\n\nimport '../../styles/character.scss';\nimport { IState, IUser } from '../../reducers/interfaces';\nimport {\n  initialCharacter,\n  special as configSpecial,\n  skills as configSkills,\n  stats as configStats,\n  subStats as configSubStats,\n  ICharacteristic,\n} from './config';\nimport actions from '../../reducers/actions';\n\ninterface ICharacterProps extends RouteComponentProps {\n  loading: boolean;\n  user: IUser | null;\n  hasRight: boolean;\n  uid: string;\n  currentUser: IUser | null;\n}\n\nclass Character extends Component<ICharacterProps> {\n  state = { char: initialCharacter };\n\n  componentDidMount = () => {\n    const { user, uid } = this.props;\n    if (!user) {\n      actions.getUser({ uid });\n    }\n  };\n\n  getSpecial = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-special\">\n        <div className=\"char-special-item\">\n          <span className=\"char-special-label\"/>\n          <div className=\"char-special-input total\">\n            Total\n          </div>\n          <div className=\"char-special-input\">\n            +/-\n          </div>\n          <div className=\"char-special-input\">\n            Base\n          </div>\n        </div>\n        {configSpecial.map(({ label, full, field }) => (\n          <div\n            key={label}\n            className=\"char-special-item\"\n          >\n            <Tooltip title={full}>\n              <span className=\"char-special-label\">{label}</span>\n            </Tooltip>\n            <Form.Item name={['special', field, 'total']}>\n              <Input\n                className=\"char-special-input total\"\n                readOnly\n                min={0}\n                max={9}\n                disabled={!hasRight}\n              />\n            </Form.Item>\n            <Form.Item name={['special', field, 'change']}>\n              <InputNumber\n                className=\"char-special-input\"\n                min={0}\n                max={9}\n                disabled={!hasRight}\n              />\n            </Form.Item>\n            <Form.Item name={['special', field, 'base']}>\n              <InputNumber\n                className=\"char-special-input\"\n                min={0}\n                max={9}\n                disabled={!hasRight}\n              />\n            </Form.Item>\n          </div>\n        ))}\n      </Card>\n    )\n  };\n\n\n  getSkills = () => {\n    const { hasRight } = this.props;\n    const { stats } = this.state.char;\n\n    const disableChange = stats.skillPoints <= 0;\n    return (\n      <Card className=\"char-skills\">\n        <div className=\"char-skills-item\">\n          <span className=\"char-skills-label\"/>\n          <div className=\"char-skills-input total\">\n            Total\n          </div>\n          <div className=\"char-skills-input\">\n            +/-\n          </div>\n          <div className=\"char-skills-input\">\n            Base\n          </div>\n        </div>\n        {configSkills.map(({ label, full, formula, field }) => (\n          <div\n            key={field}\n            className=\"char-skills-item\"\n          >\n            <Tooltip title={full}>\n              <span className=\"char-skills-label\">{label}</span>\n            </Tooltip>\n            <Form.Item name={['skills', field, 'total']}>\n              <Input\n                className=\"char-skills-input\"\n                readOnly\n                disabled={!hasRight}\n              />\n            </Form.Item>\n            <Form.Item name={['skills', field, 'change']}>\n              <InputNumber\n                className=\"char-skills-input\"\n                disabled={!hasRight}\n                min={1}\n                max={95}\n                readOnly={disableChange}\n              />\n            </Form.Item>\n            <Tooltip title={formula}>\n              <Form.Item name={['skills', field, 'base']}>\n                <Input\n                  className=\"char-skills-input\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </Tooltip>\n          </div>\n        ))}\n      </Card>\n    )\n  };\n\n  getStats = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-stats\">\n        {configStats.map(({ label, full, field, getBase }) => (\n          <div\n            key={field}\n            className=\"char-stats-item\"\n          >\n            <Tooltip title={full}>\n              <span className=\"char-stats-label\">{label}</span>\n            </Tooltip>\n            <Form.Item name={['stats', field]}>\n              {field === 'wounds'\n                ? (\n                  <Input.TextArea\n                    className=\"char-stats-input\"\n                    disabled={!hasRight}\n                  />\n                ) : (\n                  !!getBase\n                    ? (\n                      <Input\n                        className=\"char-stats-input\"\n                        readOnly\n                        disabled={!hasRight}\n                      />\n                    ) : (\n                      <InputNumber\n                        className=\"char-stats-input\"\n                        min={1}\n                        max={Number.MAX_SAFE_INTEGER}\n                        disabled={!hasRight}\n                      />\n                    )\n                )}\n            </Form.Item>\n          </div>))}\n      </Card>\n    )\n  };\n\n  getMainStats = () => {\n    const { hasRight } = this.props;\n\n    return (\n      <Card className=\"char-main-stats\">\n        <div className=\"char-main-stats-health\">\n          <div className=\"char-main-stats-hp\">\n            <span className=\"char-main-stats-hp-label\">Очки Здоровья (ОЗ)</span>\n            <div className=\"char-main-stats-hp-body\">\n              <Form.Item name={['stats', 'healthPoints']}>\n                <InputNumber\n                  max={this.state.char.stats.maxHealthPoints}\n                  min={-Math.floor(this.state.char.stats.maxHealthPoints / 2)}\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n              /\n              <Form.Item name={['stats', 'maxHealthPoints']}>\n                <Input\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </div>\n          </div>\n          <div className=\"char-main-stats-ap-wrapper\">\n            <div className=\"char-main-stats-ap\">\n              <Tooltip title=\"Класс Брони (КБ)\">\n                <div className=\"char-main-stats-ap-total\">\n                  КБ\n                </div>\n              </Tooltip>\n              <div className=\"char-main-stats-ap-change\">\n                +/-\n              </div>\n              <div className=\"char-main-stats-ap-base\">\n                Base\n              </div>\n            </div>\n            <div className=\"char-main-stats-ap\">\n              <Form.Item name={['stats', 'armorClass', 'total']}>\n                <Input\n                  className=\"char-main-stats-ap-total\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n              <Form.Item name={['stats', 'armorClass', 'change']}>\n                <InputNumber\n                  className=\"char-main-stats-ap-change\"\n                  min={1}\n                  max={95}\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n              <Form.Item name={['stats', 'armorClass', 'base']}>\n                <Input\n                  className=\"char-main-stats-ap-base\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </div>\n          </div>\n        </div>\n        <div className=\"char-main-stats-info\">\n          {configSubStats.slice(3).map(({ label, full, field }) => (\n            <div\n              key={field}\n              className=\"char-main-stats-item\"\n            >\n              <Tooltip title={full}>\n                <span className=\"char-main-stats-item-label\">{label}</span>\n              </Tooltip>\n              <Form.Item name={['stats', field]}>\n                <Input\n                  className=\"char-main-stats-item-input\"\n                  readOnly\n                  disabled={!hasRight}\n                />\n              </Form.Item>\n            </div>\n          ))}\n        </div>\n      </Card>\n    )\n  };\n\n  onChange: Callbacks['onValuesChange'] = (value, char) => {\n    this.setState({ char: this.processChar(value, char) });\n  };\n\n  // TODO Needs refactor for sure\n  processChar = (value: Store, char: Store) => {\n    const { special, skills, stats, bio } = char;\n\n    if (!value.bio) {\n      const specialTotal: { [key: string]: number } = {};\n      configSpecial.forEach(({ field, label }) => {\n        // @ts-ignore\n        const value: ICharacteristic = special[field];\n        const total = Math.max(0, Math.min(9, value.base + value.change));\n        // @ts-ignore\n        special[field] = {\n          ...value,\n          total,\n        };\n        specialTotal[label.toLowerCase()] = total;\n      });\n\n      stats.spentSkillPoints = 0;\n      configSkills.forEach(({ field, getBase }) => {\n        // @ts-ignore\n        const value: ICharacteristic = skills[field];\n        const change = Math.max(1, value.change);\n        const base = Math.max(1, getBase ? getBase(specialTotal, stats) : 1);\n        const total = Math.max(1, Math.min(95, base + change));\n        // @ts-ignore\n        skills[field] = {\n          change,\n          base,\n          total,\n        };\n        stats.spentSkillPoints += (value.change - 1);\n      });\n\n      [...configStats, ...configSubStats].forEach(({ field, getBase }) => {\n        if (getBase) {\n          if (field === 'armorClass') {\n            const base = getBase(specialTotal, stats);\n            const change = stats[field].change;\n            stats[field] = {\n              change,\n              base,\n              total: change + base,\n            }\n          } else {\n            stats[field] = Math.floor(getBase(specialTotal, stats));\n          }\n        }\n      });\n    }\n\n    return {\n      special,\n      skills,\n      stats,\n      bio,\n    };\n  };\n\n  render = () => {\n    const { user, hasRight, uid } = this.props;\n\n    if (!user) {\n      return (\n        <Spin spinning>\n          <Empty description=\"Пользователь не загружен\"/>\n        </Spin>\n      );\n    }\n\n    return (\n      <Form\n        initialValues={user.character || initialCharacter}\n        onValuesChange={this.onChange}\n      >\n        <Card\n          className=\"char\"\n          title={`Персонаж игрока ${user.nickname || user.uid}`}\n          extra={\n            <Popconfirm\n              title=\"Применить изменения?\"\n              okText=\"Да\"\n              cancelText=\"Отмена\"\n              onConfirm={() => actions.setUser({\n                uid,\n                user: {\n                  ...user,\n                  character: this.state.char,\n                }\n              })}\n            >\n            <Button>Готово</Button>\n          </Popconfirm>\n          }\n        >\n          <div className=\"char-bio\">\n            <Form.Item name={['bio']}>\n            <Input.TextArea\n              disabled={!hasRight}\n              minLength={3}\n            />\n            </Form.Item>\n          </div>\n          <div>\n            {this.getMainStats()}\n          </div>\n          <div>\n            <div>\n              {this.getSpecial()}\n              {this.getStats()}\n            </div>\n            <div>\n              {this.getSkills()}\n            </div>\n          </div>\n        </Card>\n      </Form>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState, props: ICharacterProps) => {\n  const { loading, users, currentUser } = state;\n\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  return {\n    loading,\n    user,\n    uid,\n    hasRight: (!!user && !!currentUser) && (currentUser.uid === user.uid || !!currentUser.isAdmin),\n    currentUser,\n  };\n};\n\nexport default connect(mapStateToProps)(Character);\n","import { ConnectedComponent } from 'react-redux';\n\nimport Chat from '../containers/Chat/index';\nimport Settings from '../containers/Settings';\nimport Logout from '../components/Logout';\nimport Items from '../containers/Items';\nimport Help from '../components/Help';\nimport Inventory from '../containers/Inventory';\nimport Character from '../containers/Character';\n\nexport interface IRoute {\n  path: string;\n  component: ConnectedComponent<any, any> | (() => JSX.Element);\n  exact?: boolean;\n}\n\nconst routes: IRoute[] = [\n  {\n    path: '/text-roleplay/chat',\n    component: Chat,\n  },\n  {\n    path: '/text-roleplay/:uid/settings',\n    component: Settings,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/:uid/inventory',\n    component: Inventory,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/inventory',\n    component: Inventory,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/:uid/character',\n    component: Character,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/character',\n    component: Character,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/settings',\n    component: Settings,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/items',\n    component: Items,\n  },\n  {\n    path: '/text-roleplay/help',\n    component: Help,\n  },\n  {\n    path: '/text-roleplay/logout',\n    component: Logout,\n  },\n];\n\nexport default routes;\n","import React from 'react';\nimport { Card } from 'antd';\n\nexport default () => (\n  <Card className=\"help\">\n    Чат для текстовой ролевой игры. Инвентарь, управление чатом, настройки персонажа, профиля.\n    <br/><br/>\n    <h1>Возможности</h1>\n    <pre>\n      - Отправлять в чат картинки из буфера обмена (ctrl + v) либо перетаскивая в поле ввода<br/>\n      - Увеличение картинки<br/>\n      - Вставка ссылок<br/>\n      - Вставка YouTube видео (полная ссылка, не youtu.be)<br/>\n      - Броски дайсов<br/>\n      - В одном сообщении может быть не больше 10-ти дайсов\n      - Кол-во дайсов в первой цифре. Не больше 10<br/>\n      - Буква \"д\" или \"d\" вторым символом<br/>\n      - Размер дайса во второй цифре. Только размера 4 6 8 10 12 и 20<br/>\n      - Примеры: 1д10, 2д20, 9d4<br/>\n      - При неправильном дайсе сообщение не будет отправлено<br/>\n      - Дайс можно писать в любом месте сообщения и сколько угодно раз<br/>\n      - При наведении на брошенный дайс можно увидеть полный результат<br/>\n      - Крит попадания и промахи слегка подсвечиваются зеленым и красным соответственно<br/>\n      - РП сообщение, если первым символом написать \"*\"<br/>\n      - Игроки онлайн имеют синюю обводку вокруг аватара<br/>\n      - При наведении на игрока показывается последний онлайн<br/>\n      - При клике на игрока открывается страница настроек<br/>\n      - Админы могут редактировать настройки других игроков<br/>\n      - Настройки имени и аватара<br/>\n      - Настройки применяются сразу после изменения (даже в процессе редактирования)<br/>\n      - Все пользователи видят изменения<br/>\n      - При наведении на время сообщения показывается его дата<br/>\n      - Сообщения от одного автора сгруппированы<br/>\n      - Предметы (создание, удаление, редактирование)<br/>\n      - Только админ может создавать предметы<br/>\n      - Удалять и редактировать можно только предметы созданные тобой же, либо если админ<br/>\n      - Фильтр по типу предмета<br/>\n      - Поиск одновременно по названию, описанию и эффекту предметов<br/>\n      - Вес и стоимость не показываются, если нулевая<br/>\n      - Количество не показывается, если предмет один<br/>\n      - Загрузка больше предметов по нажатию на кнопку (не сортированных)<br/>\n      - Выбор кол-во загружаемых предметов<br/>\n      - В верхнем левом углу дата последнего билда проекта. Появляется только при наведении курсора<br/>\n      - Инвентарь<br/>\n      - Админ может взять в инвентарь предметы из списка<br/>\n      - Предмет из инвентаря может быть показан другим в чате<br/>\n      - Предмет может быть использован, чем будет израсходован (1шт)<br/>\n      - Предмет можно выбросить в чат и любой игрок может его подобрать<br/>\n      - Передача предмета другим игрокам<br/>\n      - Можно зайти в чужой инвентарь без редактирования<br/>\n      - <br/>\n    </pre>\n\n    <h1>Баги/ошибки/исправления</h1>\n    <pre>\n      - Ссылки на гугл дают SameSite cookies предупреждение<br/>\n      - Решить, как попасть на чужую страницу инвентаря<br/>\n      - Сделать регистрацию с подтверждением аккаунта от админа<br/>\n      - Сделать lazy loading для подгрузки проекта только после регистрации<br/>\n      - Lazy loading для каждой основной страницы<br/>\n      - Нужна кнопка быстрого скролла в низ чата<br/>\n      - Загрузка аватара через буфер обмена<br/>\n      - Добавить подтверждение к отправке картинки<br/>\n      - Порезать контейнеры на файлы поменьше<br/>\n      - У подтвержденного предмета нельзя убрать статус подтвержденного<br/>\n      - Отрефакторить ItemCreator на форму<br/>\n      - Показывать дату и автора, даже если они сгруппированы (как?)<br/>\n      - При подтверждении персонажа белая стрелка на попапе<br/>\n      - Не давать фокуситься на инпуте скилла<br/>\n      - Оповещения в чат о том, что персонаж проадейтился и какие поля<br/>\n      - Пофиксить плохой ФПС при написании био<br/>\n      - ОЗ не сохраняется<br/>\n      - Не давать сохранить персонажа, если ОН в минусе<br/>\n      - <br/>\n    </pre>\n\n    <h1>Todo</h1>\n    <pre>\n      - Character page<br/>\n      - Effect cards?<br/>\n      - Local Notes<br/>\n      - Global notes<br/>\n      - Drawing<br/>\n      - <br/>\n    </pre>\n  </Card>\n)\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Form,\n  Input,\n  Button,\n  Card,\n  Alert,\n} from 'antd';\n\nimport actions from '../reducers/actions';\nimport { IState } from '../reducers/interfaces';\n\ninterface ILoginProps {\n  loading: boolean;\n  error: Error | false;\n}\n\nconst Login = (props: ILoginProps) => {\n  const { error, loading } = props;\n\n  return (\n    <Card loading={loading}>\n      <Form\n        onFinish={(values) => actions.login(values)}\n      >\n        <Form.Item\n          label=\"Email\"\n          name=\"email\"\n          rules={[{ required: true, message: 'Введите e-mail!' }]}\n        >\n          <Input/>\n        </Form.Item>\n        <Form.Item\n          label=\"Password\"\n          name=\"password\"\n          rules={[{ required: true, message: 'Введите пароль!' }]}\n        >\n          <Input.Password/>\n        </Form.Item>\n        <Form.Item>\n          <Button\n            type=\"primary\"\n            htmlType=\"submit\"\n          >\n            Войти\n          </Button>\n        </Form.Item>\n      </Form>\n      {error && (\n        <Alert\n          type=\"error\"\n          message={error.message}\n        />\n      )}\n    </Card>\n  );\n};\n\nconst mapStateToProps = (state: IState) => {\n  const { loading, error } = state;\n\n  return { loading, error };\n};\n\nexport default connect(mapStateToProps)(Login);\n","import React from 'react';\nimport {\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport routes, { IRoute } from '../configs/routes';\nimport Login from './Login';\nimport { IState } from '../reducers/interfaces';\n\ninterface IRouterProps {\n  isLoggedIn: boolean;\n}\n\nfunction Router(props: IRouterProps) {\n  if (!props.isLoggedIn) {\n    return (\n      <Switch>\n        <Route\n          path=\"*\"\n          component={Login}\n        />\n      </Switch>\n    )\n  }\n\n  return (\n    <Switch>\n      {\n        routes.map((value: IRoute) =>\n          <Route\n            key={value.path}\n            path={value.path}\n            component={value.component}\n            exact={value.exact || false}\n          />\n        )\n      }\n      <Redirect to=\"/text-roleplay/chat\"/>\n    </Switch>\n  );\n}\n\nexport default connect((state: IState) => ({ isLoggedIn: state.isLoggedIn }))(Router);\n","import React, { Component } from 'react';\nimport { BrowserRouter, Redirect } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { message } from 'antd';\nimport 'antd/dist/antd.css';\n\nimport Menu from './components/Menu';\nimport Router from './components/Router';\n\nimport './App.css';\nimport './styles/antd-dark.scss';\nimport './styles/components.scss';\nimport { listenForActivity } from './helpers/utils';\nimport { IState } from './reducers/interfaces';\nimport actions from \"./reducers/actions\";\n\n// @ts-ignore\nconst buildDate = (<div className=\"build-date\">build date {window.buildDate.replace('_', ' ')}</div>);\n\nclass App extends Component<{ redirect?: string; notify?: string }> {\n  componentDidMount = listenForActivity;\n\n  componentDidUpdate = () => {\n    const { notify, redirect } = this.props;\n\n    if (notify) {\n      message.info(notify);\n      actions.notifySuccess({});\n    }\n    if (redirect) {\n      actions.redirectSuccess({});\n    }\n  };\n\n  getRedirect = () => {\n    const { redirect } = this.props;\n    return redirect && <Redirect to={redirect}/>;\n  };\n\n  render = () => {\n    return (\n      <>\n        {buildDate}\n        <BrowserRouter>\n          {this.getRedirect()}\n          <Menu/>\n          <div className=\"app\">\n            <Router/>\n          </div>\n        </BrowserRouter>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (state: IState) => ({ redirect: state.redirect, notify: state.notify });\nexport default connect(mapStateToProps)(App);\n","import _firebase from 'firebase/app';\nimport 'firebase/auth';\nimport 'firebase/database';\n\nimport firebaseConfig from '../configs/firebase.json';\nimport actions from '../reducers/actions';\n\nconst firebase = _firebase.initializeApp(firebaseConfig);\nconst auth = firebase.auth();\nconst database = firebase.database();\n\nauth.onAuthStateChanged((user) => {\n  if (user) {\n    actions.loginSuccess({ user });\n    actions.getUser({ uid: user.uid, currentUser: true });\n  } else {\n    actions.logout({});\n  }\n});\n\nexport {\n  auth,\n  database,\n  firebase,\n}\n","import { AnyAction } from 'redux';\nimport { all, takeLatest } from 'redux-saga/effects';\n\nimport { auth } from '../helpers/firebase';\nimport actions from '../reducers/actions';\n\nfunction* login(action: AnyAction) {\n  const { email, password } = action;\n\n  try {\n    const user = yield auth.signInWithEmailAndPassword(email, password);\n    actions.loginSuccess({ user });\n    localStorage.setItem('user', JSON.stringify(user.user));\n    localStorage.setItem('uid', user.user.uid);\n  } catch (error) {\n    console.error(error);\n    if (error.code === 'auth/user-not-found') {\n      const user = yield auth.createUserWithEmailAndPassword(email, password);\n      actions.loginSuccess({ user });\n      localStorage.setItem('user', JSON.stringify(user.user));\n      localStorage.setItem('uid', user.uid);\n    } else {\n      actions.loginFail({ error });\n    }\n  }\n}\n\nfunction* logout() {\n  localStorage.removeItem('user');\n  localStorage.removeItem('uid');\n  localStorage.removeItem('loggedIn');\n  yield auth.signOut();\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('LOGIN', login),\n    takeLatest('LOGOUT', logout),\n  ])\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { database } from '../helpers/firebase';\nimport actions, { IPayload } from '../reducers/actions';\n\nfunction* setUser(payload: IPayload) {\n  const { uid, user } = payload;\n\n  yield database\n    .ref('users')\n    .child(uid)\n    .set({\n      ...user,\n      lastOnline: new Date().getTime(),\n      uid,\n    });\n\n  actions.setUserSuccess({});\n  actions.getUser({ uid });\n}\n\nconst requestedUsers: { [key: string]: true } = {};\n\nfunction getUser(payload: IPayload) {\n  const { uid, currentUser } = payload;\n\n  if (requestedUsers[uid] && !currentUser) return;\n  requestedUsers[uid] = true;\n  database\n    .ref('users')\n    .child(uid)\n    .on('value', (rawUser) => {\n      const user = rawUser.val() || {};\n      actions.getUserSuccess({ user, uid, currentUser });\n    });\n}\n\nfunction* updateLastOnline() {\n  const uid = localStorage.getItem('uid');\n  if (!uid || uid === 'undefined') return;\n  const time = new Date().getTime();\n\n  localStorage.setItem('lastActivity', `${time}`);\n  yield database\n    .ref('users')\n    .child(`${uid}`)\n    .child('lastOnline')\n    .set(time);\n\n  yield database\n    .ref('usersActivity')\n    .child(`${uid}`)\n    .set(time);\n}\n\nfunction* getUsersActivity() {\n  const rawActivity = yield database\n    .ref('usersActivity')\n    .once('value');\n\n  const usersActivity = (rawActivity.val() || {});\n  actions.getUsersActivitySuccess({ usersActivity });\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('GET_USER', getUser),\n    takeLatest('SET_USER', setUser),\n    takeLatest('UPDATE_LAST_ONLINE', updateLastOnline),\n    takeLatest('GET_USERS_ACTIVITY', getUsersActivity),\n  ]);\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { IPayload } from '../reducers/actions';\nimport actions from '../reducers/actions';\nimport { database } from '../helpers/firebase';\nimport { formatMessage } from '../helpers/utils';\n\nfunction* sendMessage(payload: IPayload) {\n  const { uid, message, data = {} } = payload;\n  const time = new Date().getTime();\n\n  const newMessage = formatMessage({\n    time,\n    author: uid,\n    body: `${message} `,\n    data,\n  });\n\n  try {\n    yield database\n      .ref('messages')\n      .child(`${time}`)\n      .set(newMessage);\n    localStorage.setItem('message', '');\n    actions.sendMessageSuccess({ message: newMessage });\n  } catch (e) {\n    actions.sendMessageFail({});\n    console.error(e);\n    actions.notify({ message: 'Сообщение не было отправлено. Для деталей ctrl + shift + i, вкладка Console' });\n  }\n}\n\nfunction subscribe() {\n  database\n    .ref('messages')\n    .orderByKey()\n    .limitToLast(1)\n    .on('value', (rawMessages) => {\n      const messages = Object.values(rawMessages.val() || {});\n      actions.getMessagesSuccess({\n        messages,\n        concat: true\n      });\n    });\n}\n\nfunction unsubscribe() {\n  database.ref('messages').off();\n}\n\nfunction* getMessages() {\n  const rawMessages = yield database\n    .ref('messages')\n    .orderByKey()\n    .limitToLast(100)\n    .once('value');\n\n  const messages = Object.values(rawMessages.val() || {});\n  actions.getMessagesSuccess({ messages });\n}\n\nfunction* getMoreMessages(payload: IPayload) {\n  const { firstMessage } = payload;\n\n  const rawMessages = yield database\n    .ref('messages')\n    .orderByKey()\n    .endAt(`${firstMessage.time}`)\n    .limitToLast(30)\n    .once('value');\n\n  const messages = Object.values(rawMessages.val() || {});\n  actions.getMessagesSuccess({ messages, concat: true });\n}\n\nfunction uploadFile(payload: IPayload) {\n  const { file, uid } = payload;\n\n  const request = new XMLHttpRequest();\n  const formData = new FormData();\n\n  formData.append('image', file);\n\n  request.open('POST', 'https://api.imgur.com/3/image/');\n  request.setRequestHeader('Authorization', `Client-ID ea2c833b74d4583`);\n  request.onreadystatechange = () => {\n    if (request.status === 200 && request.readyState === 4) {\n      let res = JSON.parse(request.responseText);\n\n      actions.sendMessage({\n        uid,\n        message: res.data.link,\n      });\n      actions.notify({ message: 'Файл успешно загружен!' });\n    }\n  };\n\n  request.send(formData);\n}\n\nexport function* changeMessage(payload: IPayload) {\n  const { message } = payload;\n\n  const newMessage = formatMessage({\n    time: message.time,\n    author: message.author,\n    body: message.body,\n    data: message.data,\n  });\n\n  yield database\n    .ref('messages')\n    .child(`${message.time}`)\n    .set(newMessage);\n\n  actions.changeMessageSuccess({ message: newMessage });\n  return newMessage;\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('SEND_MESSAGE', sendMessage),\n    takeLatest('GET_MESSAGES', getMessages),\n    takeLatest('GET_MORE_MESSAGES', getMoreMessages),\n    takeLatest('SUBSCRIBE', subscribe),\n    takeLatest('UNSUBSCRIBE', unsubscribe),\n    takeLatest('UPLOAD_FILE', uploadFile),\n    takeLatest('CHANGE_MESSAGE', changeMessage),\n  ]);\n}\n","import { all, takeLatest, takeEvery } from 'redux-saga/effects';\n\nimport { IPayload } from '../reducers/actions';\nimport actions from '../reducers/actions';\nimport { database } from '../helpers/firebase';\nimport { generateID, getFailedItem } from '../helpers/utils';\nimport { IInventoryItem, IMessage, IUser } from \"../reducers/interfaces\";\nimport { getRandomInt } from '../helpers/dice';\n\nfunction* setItem(payload: IPayload) {\n  const { item } = payload;\n  const time = new Date().getTime();\n  const id = item.id || generateID();\n  const author = localStorage.getItem('uid');\n\n  const itemData = {\n    ...item,\n    id,\n    time,\n    author,\n  };\n\n  yield database\n    .ref('items')\n    .child(`${id}`)\n    .set(itemData);\n\n  actions.setItemSuccess({ itemData });\n  actions.getItemById({ id });\n}\n\nfunction* getItems() {\n  const rawItems = yield database\n    .ref('items')\n    .orderByKey()\n    .limitToFirst(30)\n    .once('value');\n\n  const items = Object.values(rawItems.val() || {});\n  actions.getItemsSuccess({ items });\n}\n\nfunction* getItemById(payload: IPayload) {\n  const { id } = payload;\n\n  const rawItem = yield database\n    .ref('items')\n    .child(id)\n    .once('value');\n\n  const item = rawItem.val() || getFailedItem(id);\n  actions.getItemsSuccess({ items: [item] });\n  return true;\n}\n\nfunction* getMoreItems(payload: IPayload) {\n  const { amount = 1, lastItem } = payload;\n\n  const rawItems = yield database\n    .ref('items')\n    .orderByKey()\n    .startAt(`${lastItem.id}`)\n    .limitToFirst(amount + 1)\n    .once('value');\n\n  const a = rawItems.val();\n  const items = Object.values(a || {}).splice(1);\n  actions.getItemsSuccess({ items });\n}\n\nfunction* deleteItem(payload: IPayload) {\n  const { id } = payload;\n\n  // Delete items from items list\n  yield database.ref(`items/${id}`).set({});\n  actions.deleteItemProgress({ field: 'deleted', value: true });\n  let waitCounter = 0;\n  const getWait = () => {\n    waitCounter += getRandomInt(10, 500);\n    return waitCounter;\n  };\n\n  // Delete item from all messages\n  const messages: IMessage[] = Object.values((yield database.ref(`messages`).once('value')).val() || {});\n  let clearedMessages = 0;\n\n  async function checkMessages(index: number) {\n    const message: IMessage = messages[index];\n    if (!message) return;\n    const randomWait = getWait();\n\n    setTimeout(() => actions.deleteItemProgress({\n      field: 'messagesChecked',\n      value: index + 1\n    }), randomWait);\n    if (message.data && message.data.itemId && message.data.itemId === id) {\n      await database.ref(`messages/${message.time}/data`).set({});\n      setTimeout(() => actions.deleteItemProgress({\n        field: 'messagesCleared',\n        value: ++clearedMessages\n      }), randomWait);\n    }\n    await checkMessages(index + 1);\n  }\n\n  yield checkMessages(0);\n\n  // Delete item from all users\n  const users: IUser[] = Object.values((yield database.ref(`users`).once('value')).val() || {});\n  let clearedUsers = 0;\n\n  async function checkUsers(index: number) {\n    const user: IUser = users[index];\n    if (!user) return;\n    const randomWait = getWait();\n\n    setTimeout(() => actions.deleteItemProgress({\n      field: 'usersChecked',\n      value: index + 1\n    }), randomWait);\n    if (user.inventory) {\n      const item = Object.values(user.inventory).find((item: IInventoryItem) => item.id === id);\n      if (item) {\n        await database.ref(`users/${user.uid}/inventory/${id}|${item.time}`).set({});\n        setTimeout(() => actions.deleteItemProgress({\n          field: 'usersCleared',\n          value: ++clearedUsers\n        }), randomWait);\n      }\n    }\n    await checkUsers(index + 1);\n  }\n\n  yield checkUsers(0);\n\n  setTimeout(\n    () => actions.deleteItemProgress({ field: 'done', value: true }),\n    getWait()\n  );\n  actions.deleteItemSuccess({ id });\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('DELETE_ITEM', deleteItem),\n    takeLatest('SET_ITEM', setItem),\n    takeLatest('GET_ITEMS', getItems),\n    takeLatest('GET_MORE_ITEMS', getMoreItems),\n    takeEvery('GET_ITEM_BY_ID', getItemById),\n  ]);\n}\n","import { all, takeLatest } from 'redux-saga/effects';\n\nimport { IInventoryItem, IItem } from '../reducers/interfaces';\nimport { database } from '../helpers/firebase';\nimport { IPayload } from '../reducers/actions';\nimport actions from '../reducers/actions';\nimport { changeMessage } from './messages';\nimport { getItemName } from \"../helpers/utils\";\n\nfunction* passItem(payload: IPayload) {\n  const { id, uid, demonstrate, use, item, to } = payload;\n\n  if (id && uid && item) {\n    const name = getItemName(item);\n    if (demonstrate) {\n      actions.sendMessage({\n        uid,\n        message: `*показывает ${name}`,\n        data: { itemId: id, amount: item.amount },\n      });\n      actions.passItemSuccess({});\n      actions.notify({ message: `Вы показали ${name}`});\n      actions.redirect({ to: '/text-roleplay/chat' });\n      return true;\n    }\n\n    const removed = yield removeItem({ id, uid, amount: item.amount });\n    if (!removed) {\n      console.error(`passItem error:`, payload);\n      actions.passItemFail({ id, uid });\n      return false;\n    }\n\n    if (use) {\n      const name = getItemName(item, false);\n      actions.sendMessage({\n        uid,\n        message: `*использовал ${name}`,\n        data: { itemId: id },\n      });\n      actions.notify({ message: `Вы использовали ${name}` });\n      actions.redirect({ to: '/text-roleplay/chat' });\n      actions.passItemSuccess({});\n      return true;\n    }\n\n    if (to) {\n      actions.giveItem({ uid: to.uid, id, itemType: item.type, amount: item.amount });\n      actions.notify({ message: `Вы передали ${item.name} игроку '${to.nickname}'` });\n      actions.passItemSuccess({});\n      return;\n    }\n\n    actions.sendMessage({\n      uid,\n      message: `*выбросил ${name}`,\n      data: { itemId: id, amount: item.amount, type: item.type },\n    });\n    actions.notify({ message: `Вы выбросили ${name}` });\n    actions.redirect({ to: '/text-roleplay/chat' });\n    actions.passItemSuccess({});\n    return true;\n  }\n\n  actions.passItemFail({ id, uid });\n  console.error(`passItem error: id, uid, or item are not defined`, payload);\n  return false;\n}\n\nfunction* removeItem(payload: IPayload) {\n  const { id, uid, amount = 1 } = payload;\n  const ref = database\n    .ref(`users`)\n    .child(uid)\n    .child('inventory');\n\n  const sameItem = yield getInventoryItem({ id, uid });\n  if (sameItem) {\n    if (sameItem.amount - amount >= 1) {\n      const item = {\n        ...sameItem,\n        amount: sameItem.amount - amount,\n      };\n\n      yield ref.child(`${id}|${sameItem.time}`).set(item);\n      actions.removeItemSuccess({ id, uid });\n      return true;\n    }\n\n    yield ref.child(`${id}|${sameItem.time}`).set({});\n    actions.removeItemSuccess({ id, uid });\n    return true;\n  }\n\n  console.error(`removeItem error: User '${uid}' doesn't have item '${id}'`);\n  actions.notify({ message: `Предмета нет в инвентаре` });\n  actions.removeItemFail({ id, uid, error: 'has-no-item' });\n  return false;\n}\n\nfunction* getInventoryItem(payload: IPayload) {\n  const { id, uid } = payload;\n\n  const rawItems = yield database\n    .ref('users')\n    .child(uid)\n    .child('inventory')\n    .once('value');\n  const items: IInventoryItem[] = Object.values(rawItems.val() || {});\n  if (items.length) {\n    // @ts-ignore\n    const item: IItem = items.find(item => item.id === id);\n    if (item)\n      return item;\n  }\n  return;\n}\n\nfunction* giveItem(payload: IPayload) {\n  const { id, uid, itemType, amount = 1 } = payload;\n  if (!id || !uid || !itemType) {\n    console.error('giveItem error. One of the properties are not defined', id, uid, itemType);\n    actions.giveItemFail({});\n    return;\n  }\n\n  const time = new Date().getTime();\n  let item: IInventoryItem = { id, time, type: itemType, amount: amount };\n\n  if (itemType !== 'weapon' && itemType !== 'wearable') {\n    const sameItem = yield getInventoryItem({ id, uid });\n    if (sameItem) {\n      item.amount = (sameItem.amount || 1) + amount;\n      item.time = sameItem.time;\n    }\n  }\n\n  const fullId = `${item.id}|${item.time}`;\n  yield database\n    .ref('users')\n    .child(uid)\n    .child('inventory')\n    .child(fullId)\n    .set(item);\n\n  actions.giveItemSuccess({ id, uid });\n  return true;\n}\n\nfunction* takeItem(payload: IPayload) {\n  const { uid, message } = payload;\n  const { itemId, amount, type } = message.data;\n\n  message.data.taken = true;\n\n  const took = yield changeMessage({ uid, message });\n  if (took && type) {\n    const item = yield giveItem({\n      id: itemId,\n      uid,\n      amount: amount || 1,\n      itemType: type,\n    });\n    if (item) {\n      actions.sendMessage({\n        uid,\n        message: `*подобрал предмет`,\n      });\n      actions.takeItemSuccess({});\n      return true;\n    }\n  }\n\n  console.error('takeItem error. Cant take or no item', payload);\n  actions.takeItemFail({});\n  return false;\n}\n\nexport default function* watchForActions() {\n  yield all([\n    takeLatest('GIVE_ITEM', giveItem),\n    takeLatest('REMOVE_ITEM', removeItem),\n    takeLatest('PASS_ITEM', passItem),\n    takeLatest('TAKE_ITEM', takeItem),\n  ]);\n}\n","import { all } from 'redux-saga/effects';\n\nimport auth from './auth';\nimport users from './users';\nimport messages from './messages';\nimport items from './items';\nimport inventory from './inventory';\n\nexport default function* watchAll() {\n  yield all([\n    auth(),\n    users(),\n    messages(),\n    items(),\n    inventory(),\n  ])\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './index.css';\nimport App from './App';\nimport saga from './sagas/index';\nimport store, { sagaMiddleware } from './helpers/store';\nimport * as serviceWorker from './serviceWorker';\n\nsagaMiddleware.run(saga);\nReactDOM.render(\n  <Provider store={store}>\n    <App/>\n  </Provider>,\n  document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}