{"version":3,"sources":["components/Menu/index.tsx","helpers/dice.tsx","helpers/utils.tsx","reducers/index.ts","helpers/store.tsx","actions/index.tsx","components/Avatar.tsx","components/Image.tsx","components/Chat/MessageBody.tsx","components/Chat/Message.tsx","components/Chat/index.tsx","components/Loader.tsx","components/Settings/index.tsx","components/Logout/index.tsx","components/Inventory/index.tsx","configs/routes.tsx","components/Login/index.tsx","components/Router/index.tsx","App.tsx","helpers/firebase.tsx","sagas/index.tsx","serviceWorker.ts","index.tsx"],"names":["connect","state","isLoggedIn","withRouter","props","Fragment","mode","window","innerWidth","selectedKeys","location","pathname","split","pop","menu","map","value","Item","key","path","disabled","to","label","diceRegex","diceRegexG","rollDice","amount","size","Array","fill","min","max","Math","floor","random","colorFromString","str","hash","i","length","charCodeAt","color","toString","substr","isOnline","time","parseInt","localStorage","getItem","Date","getTime","doubleDigit","date","getHours","getMinutes","getSeconds","join","getDate","getMonth","getFullYear","getFullTime","isURL","test","processMessages","messages","filter","item","pos","self","findIndex","_i","sort","a","b","m","index","author","grouped","formatMessage","message","body","rolls","match","roll","_amount","_size","results","maxResult","minResult","sum","reduce","exportRolls","isRP","mentioned","validateMessage","notify","error","some","console","log","indexOf","user","JSON","parse","setItem","uid","initialState","userData","settings","loading","users","defaultUser","lastOnline","nickname","avatar","reducer","action","type","concat","sagaMiddleware","createSagaMiddleware","store","createStore","reducers","composeWithDevTools","applyMiddleware","dispatch","createAction","payload","createAsyncAction","typeName","toLowerCase","replace","toUpperCase","actions","updateLastOnline","logout","Avatar","style","rest","_avatar","src","backgroundColor","Image","visible","showModal","setState","this","onClick","alt","className","title","href","target","rel","closable","footer","onCancel","width","maxWidth","Component","MessageBody","videoId","URL","searchParams","get","id","height","frameBorder","_body","_rolls","word","rollIndex","splice","summing","importRolls","Message","undefined","placement","extra","Chat","sending","componentDidMount","getMessages","subscribe","componentWillUnmount","unsubscribe","componentDidUpdate","prevProps","forEach","getUser","onChangeMessage","event","onKeyDown","shiftKey","preventDefault","onSendMessage","find","currentTarget","selectionStart","sendMessage","getMoreMessages","firstMessage","onScroll","scrollTop","uploadFile","file","onPaste","e","clipboardData","files","onDrop","dataTransfer","items","getAsFile","render","spinning","TextArea","placeholder","autoSize","minRows","maxRows","onChange","SendOutlined","Loader","SyncOutlined","spin","CheckCircleTwoTone","twoToneColor","Settings","field","newSettings","setSettings","setUser","clearAvatar","getField","display","onConfirm","okText","cancelText","icon","ClearOutlined","danger","margin","readOnly","defaultValue","labels","bordered","Object","keys","React","URLSearchParams","params","Inventory","routes","component","exact","Logout","onFinish","values","login","name","rules","required","Password","htmlType","Login","App","callback","eventName","document","addEventListener","listenForActivity","auth","initializeApp","firebaseConfig","fbAuth","database","fbDatabase","onAuthStateChanged","loginSuccess","watchForActions","email","password","signInWithEmailAndPassword","stringify","code","createUserWithEmailAndPassword","loginFail","removeItem","signOut","ref","child","set","setUserSuccess","sendMessageSuccess","sendMessageFail","orderByKey","limitToLast","on","rawMessages","val","getMessagesSuccess","off","once","endAt","requestedUsers","rawUser","getUserSuccess","request","XMLHttpRequest","formData","FormData","append","open","setRequestHeader","onreadystatechange","status","readyState","res","responseText","data","link","send","takeLatest","Boolean","hostname","run","saga","ReactDOM","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.e9b37e67.chunk.js","sourcesContent":["import React from 'react';\nimport { Menu as AntdMenu } from 'antd';\nimport { Link, withRouter, RouteComponentProps } from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport './menu.scss';\nimport menu from '../../configs/menu.json';\nimport { IState } from '../../reducers';\n\ninterface IMenuProps extends RouteComponentProps {\n  isLoggedIn: boolean;\n}\n\nfunction Menu(props: IMenuProps) {\n  if (!props.isLoggedIn) {\n    return <React.Fragment/>;\n  }\n\n  const mode = window.innerWidth < 767\n    ? 'horizontal'\n    : 'inline';\n\n  return (\n    <AntdMenu\n      mode={mode}\n      selectedKeys={[props.location.pathname.split('/').pop() || '']}\n    >\n      {menu.map((value) => (\n        <AntdMenu.Item\n          key={value.path.split('/').pop()}\n          disabled={value.path === props.location.pathname}\n        >\n          <Link to={value.path}>\n            {value.label}\n          </Link>\n        </AntdMenu.Item>\n      ))}\n    </AntdMenu>\n  );\n}\n\nexport default connect((state: IState) => ({ isLoggedIn: state.isLoggedIn }))(withRouter(Menu));\n","import React from 'react';\nimport { Tooltip } from 'antd';\n\nexport interface IRoll {\n  roll: string;\n  results: number[];\n  amount: number;\n  size: number;\n  maxResult: number;\n  minResult: number;\n  sum: number;\n}\n\nexport const diceRegex = /([1-9]|10)[dд]((10|12|20)|[468])/miu;\nexport const diceRegexG = /([1-9]|10)[dд]((10|12|20)|[468])/miug;\n\nexport const getRandomInt = (min: number, max: number) =>\n  Math.floor(Math.random() * ((max + 1) - min) + min);\n\nexport const hasDice = (str: string) =>\n  /\\d+[dд]\\d+/imu.test(str);\n\nexport const rollDice = (amount: number, size: number) => {\n  return new Array(amount).fill(amount + size).map(() => getRandomInt(1, size));\n};\n\nexport const exportRolls = (str: string) => {\n  const rolls = str.match(diceRegexG);\n  if (rolls) {\n    return rolls.map((roll: string): IRoll => {\n      const [_amount,_size] = roll.split(/[dд]/);\n      const amount = parseInt(_amount);\n      const size = parseInt(_size);\n      const results = rollDice(amount, size);\n\n      return ({\n        maxResult: size * amount,\n        minResult: amount,\n        sum: results.reduce((a, b) => a + b, 0),\n        roll,\n        results,\n        amount,\n        size,\n      })\n    });\n  }\n  return [];\n};\n\nexport const importRolls = (body: string, _rolls: IRoll[]) => {\n  const rolls = [..._rolls]; // Avoid mutations\n  return body.split(' ').map((word: string, index: number) => {\n    const rollIndex = rolls.findIndex(({ roll }) => roll === word);\n    if (rollIndex > -1) {\n      const {\n        results,\n        maxResult,\n        minResult,\n        sum\n      } = rolls.splice(rollIndex, 1)[0];\n\n      const summing = `${sum} = ${results.join(' + ')}`;\n      const className = (sum === maxResult && 'critHit') || (sum === minResult && 'critMiss') || '';\n      return (\n        <React.Fragment key={word + index}>\n          {' '}\n          <Tooltip title={summing}>\n            <b className={className}>\n              {word}({sum})\n            </b>\n          </Tooltip>\n        </React.Fragment>\n      )\n    }\n    return ` ${word}`;\n  });\n};\n","import { message as notify } from 'antd';\n\nimport actions from '../actions';\nimport { IMessage } from '../reducers';\nimport { diceRegex, exportRolls, hasDice } from './dice';\n\nexport const camelize = (str: string) => {\n  return str\n    .toLowerCase()\n    .replace(/_./g, (m) => m.toUpperCase())\n    .replace(/_/g, '')\n};\n\nexport const colorFromString = (str: string) => {\n  if (!str) return '#000';\n\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n\n  let color = '#';\n  for (let i = 0; i < 3; i++) {\n    let value = (hash >> (i * 8)) & 0xFF;\n    color += ('00' + value.toString(16)).substr(-2);\n  }\n\n  return color;\n};\n\nexport const isOnline = (time?: number) => {\n  if (!time) return false;\n  const lastActivity = time || parseInt(localStorage.getItem('lastActivity') || '0');\n  return (lastActivity + 180000) > new Date().getTime();\n};\n\nexport const doubleDigit = (str: number) => `${str}`.length === 1\n  ? `0${str}`\n  : str;\n\nexport const getTime = (time: number) => {\n  const date = new Date(time);\n  return [date.getHours(), date.getMinutes(), date.getSeconds()].map(doubleDigit).join(':');\n};\n\nexport const getDate = (time: number) => {\n  const date = new Date(time);\n  return [date.getDate(), date.getMonth() + 1, date.getFullYear()].map(doubleDigit).join('.');\n};\n\nexport const getFullTime = (time: number) => {\n  const date = new Date(time);\n  const messageTime = [date.getHours(), date.getMinutes(), date.getSeconds()].map(doubleDigit).join(':');\n  const messageDate = [date.getDate(), date.getMonth() + 1, date.getFullYear()].map(doubleDigit).join('.');\n\n  return [messageTime, messageDate].join(' ');\n};\n\nexport const listenForActivity = () => {\n  const callback = () => {\n    if (!isOnline(parseInt(localStorage.getItem('lastActivity') || '0') - 60000))\n      actions.updateLastOnline({});\n  };\n\n  [\n    'mousedown',\n    'mousemove',\n    'keydown',\n    'scroll',\n    'touchstart'\n  ].forEach((eventName) => {\n    document.addEventListener(eventName, callback, true);\n  });\n  callback();\n};\n\nexport const isURL = (str: string) =>\n  /[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/igm.test(str);\n\nexport const processMessages = (messages: IMessage[]) => {\n  return messages\n    .filter((item: IMessage, pos: number, self: IMessage[]) =>\n      self.findIndex((_i: IMessage) => _i.time === item.time) === pos\n    )\n    .sort((a: IMessage, b: IMessage) => b.time - a.time)\n    .map((m: IMessage, index: number, messages: IMessage[]) => {\n      if (index < messages.length - 2) {\n        if (m.author === messages[index + 1].author) {\n          return {\n            ...m,\n            grouped: true,\n          }\n        }\n      }\n      return m;\n    })\n};\n\nexport const formatMessage = (message: IMessage) => {\n  const { body } = message;\n\n  if (diceRegex.test(body)) {\n    message.rolls = exportRolls(body);\n  }\n\n  if (/\\*/.test(body)) {\n    message.isRP = true;\n  }\n\n  if (/(@[a-zа-яё]*)/mui.test(body)) {\n    message.mentioned = true;\n  }\n\n  return message;\n};\n\nexport const validateMessage = (message: string) => {\n\n  if (!message) {\n    notify.error('Сообщение пустое');\n    return false;\n  }\n\n  if (hasDice(message)) {\n    const rolls: string[] | null = message.match(/(( |^)[a-zа-я]+\\d+[dд]\\d+)|(\\d+[dд]\\d+[a-zа-я]+( |$))|(\\d+[dд]\\d+)/miug);\n    if (rolls) {\n      const wasError = rolls.some((roll: string) => {\n        console.log(roll);\n        if (/(([a-zа-яё])\\d+[dд]\\d+)|(\\d+[dд]\\d+([a-zа-яё]))/miug.test(roll)) {\n          notify.error(`Ошибка в дайсе ${roll}. Рядом не должно быть символов`);\n          return true;\n        }\n\n        const [amount, size] = roll.split(/[dд]/u);\n\n        console.log(amount, size, parseInt(amount) > 10, !/((10|12|20)|[468])/gu.test(size));\n        if (parseInt(amount) > 10) {\n          notify.error(`Ошибка в дайсе ${roll}. Нельзя бросать больше 10-ти дайсов`);\n          return true;\n        }\n\n        if ([2,4,6,8,10,12,20].indexOf(parseInt(size)) === -1) {\n          notify.error(`Ошибка в дайсе ${roll}. Можно бросать только дайсы размеров 4 6 8 10 12 20`);\n          return true;\n        }\n\n        return false;\n      });\n      if (wasError) return false;\n    }\n  }\n  return true;\n};\n","import { processMessages } from '../helpers/utils';\nimport { IRoll } from \"../helpers/dice\";\n\nexport interface IAction {\n  type: string;\n\n  [key: string]: any; // Payload could be any type or size\n}\n\nexport interface IMessage {\n  author: string;\n  time: number;\n  body: string;\n  // Remove header and top margin of message, because author is the same\n  grouped?: boolean;\n  isCommand?: boolean;\n  isRP?: boolean;\n  commandResult?: string;\n  mentioned?: boolean;\n  rolls?: IRoll[];\n}\n\nexport interface IUsers {\n  [key: string]: IUser;\n}\n\nexport interface IState {\n  userData: IUser | null;\n  isLoggedIn: boolean;\n  settings: IUser | false;\n  loading: boolean;\n  messages: IMessage[];\n  users: IUsers;\n  uid: string;\n}\n\nconst user = JSON.parse(localStorage.getItem('user') || 'null');\nif (user) localStorage.setItem('uid', user.uid);\nexport const initialState: IState = {\n  userData: user,\n  isLoggedIn: user !== null,\n  settings: false,\n  loading: false,\n  messages: [],\n  users: {},\n  uid: user ? user.uid : '',\n};\n\nexport interface IUser {\n  nickname: string;\n  avatar: string;\n  uid: string,\n  lastOnline: number;\n}\n\nexport const defaultUser = {\n  lastOnline: 0,\n\n  nickname: '',\n  avatar: '',\n\n  uid: '',\n};\n\nconst reducer = (state = initialState, action: IAction) => {\n  switch (action.type) {\n    case 'LOGIN':\n    case 'GET_MESSAGES':\n    case 'GET_MORE_MESSAGES':\n    case 'SEND_MESSAGE':\n    case 'SET_USER':\n    case 'UPLOAD_FILE': {\n      return {\n        ...state,\n        loading: true,\n      }\n    }\n    case 'LOGIN_FAIL':\n    case 'SET_USER_SUCCESS':\n    case 'SET_USER_FAIL':\n    case 'GET_MESSAGES_FAIL':\n    case 'GET_MORE_MESSAGES_SUCCESS':\n    case 'GET_MORE_MESSAGES_FAIL':\n    case 'SEND_MESSAGE_FAIL': {\n      return {\n        ...state,\n        loading: false,\n      }\n    }\n    case 'LOGIN_SUCCESS': {\n      return {\n        ...state,\n        uid: action.user.uid,\n        userData: action.user,\n        isLoggedIn: action.user !== null,\n      }\n    }\n    case 'LOGOUT': {\n      return {\n        ...state,\n        userData: null,\n        isLoggedIn: false,\n      }\n    }\n    case 'GET_MESSAGES_SUCCESS': {\n      const messages = action.concat\n        ? [...state.messages, ...action.messages]\n        : action.messages;\n\n      return {\n        ...state,\n        messages: processMessages(messages),\n        loading: false,\n      }\n    }\n    case 'GET_USER_SUCCESS': {\n      return {\n        ...state,\n        users: {\n          ...state.users,\n          [action.uid]: action.user,\n        },\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport default reducer;\n","import { createStore, applyMiddleware } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport { composeWithDevTools } from 'redux-devtools-extension';\n\nimport { initialState } from '../reducers';\nimport reducers from '../reducers'\n\nexport const sagaMiddleware = createSagaMiddleware();\nconst store = createStore(\n  reducers,\n  initialState,\n  composeWithDevTools(applyMiddleware(sagaMiddleware)),\n);\n\nexport default store;\n","import store from '../helpers/store';\nimport { camelize } from '../helpers/utils';\n\nconst dispatch = store.dispatch;\n\nexport interface IPayload {\n  [key: string]: any;\n}\n\ninterface IActions {\n  [key: string]: (payload: IPayload) => void;\n}\n\nconst createAction =\n  (type: string) =>\n    (payload?: IPayload) =>\n      dispatch({ type, ...payload });\n\nconst createAsyncAction = (type: string) => {\n  const typeName = camelize(type);\n  return {\n    [typeName]: createAction(type),\n    [`${typeName}Success`]: createAction(`${type}_SUCCESS`),\n    [`${typeName}Fail`]: createAction(`${type}_FAIL`),\n  }\n};\n\nconst actions: IActions = {\n  ...createAsyncAction('LOGIN'),\n  ...createAsyncAction('GET_USER'),\n  ...createAsyncAction('GET_MESSAGES'),\n  ...createAsyncAction('GET_MORE_MESSAGES'),\n  ...createAsyncAction('SET_USER'),\n  ...createAsyncAction('SEND_MESSAGE'),\n  ...createAsyncAction('SUBSCRIBE'),\n  ...createAsyncAction('UNSUBSCRIBE'),\n  ...createAsyncAction('UPLOAD_FILE'),\n  updateLastOnline: createAction('UPDATE_LAST_ONLINE'),\n  logout: createAction('LOGOUT'),\n};\n\nexport default actions;\n","import React from 'react';\nimport { Avatar as AntdAvatar } from 'antd';\nimport { AvatarProps } from 'antd/es/avatar';\nimport { colorFromString, isURL } from \"../helpers/utils\";\n\ninterface IAvatarProps extends AvatarProps {\n  avatar: string;\n  nickname: string;\n}\n\nconst Avatar = (props: IAvatarProps) => {\n  const { avatar, nickname, style, ...rest } = props;\n\n  const _avatar = isURL(avatar) ? avatar : '';\n  return (\n    <AntdAvatar\n      src={_avatar}\n      style={{ ...style, backgroundColor: _avatar ? 'transparent' : colorFromString(nickname) }}\n      {...rest}\n    >\n      {nickname}\n    </AntdAvatar>\n  )\n};\n\nexport default Avatar;\n","import React, { Component, MouseEvent } from 'react';\nimport { Modal } from 'antd';\n\n\nclass Image extends Component<{ src: string }, { visible: boolean }> {\n  state = { visible: false };\n\n  showModal = () => {\n    this.setState({\n      visible: !this.state.visible,\n    });\n  };\n\n  render() {\n    const { src } = this.props;\n\n    return (\n      <React.Fragment>\n        <img\n          onClick={this.showModal}\n          src={src}\n          alt=\"\"\n          className=\"chat-image\"\n        />\n        <Modal\n          title={\n            <a\n              href={src}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              {src}\n            </a>\n          }\n          closable\n          footer={null}\n          visible={this.state.visible}\n          onCancel={this.showModal}\n          width=\"fit-content\"\n        >\n          <img\n            style={{\n              maxWidth: '90vw',\n            }}\n            src={src}\n            alt=\"\"\n          />\n        </Modal>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default Image;\n","import React from 'react';\nimport { isURL } from '../../helpers/utils';\nimport { IMessage } from '../../reducers';\nimport { importRolls } from '../../helpers/dice';\nimport Image from \"../Image\";\n\ninterface IMessageBodyProps {\n  message: IMessage;\n}\n\nconst MessageBody = (props: IMessageBodyProps) => {\n  const {\n    body,\n    isRP,\n    rolls,\n  } = props.message;\n\n  if (isURL(body)) {\n    if (/\\.(gif|jpe?g|tiff|png|webp|bmp)/ig.test(body)) {\n      return (\n        <Image src={body}/>\n      )\n    }\n\n    if (/youtu/.test(body)) {\n      const videoId = new URL(body).searchParams.get('v') || '';\n\n      return (\n        <iframe\n          title={videoId}\n          id=\"ytplayer\"\n          width=\"100%\"\n          height=\"360\"\n          src={`http://www.youtube.com/embed/${videoId}`}\n          frameBorder=\"0\"\n        />\n      )\n    }\n\n    return (\n      <a\n        href={body}\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        {body}\n      </a>\n    )\n  }\n\n  const _body = rolls\n    ? importRolls(body, rolls)\n    : body;\n\n  if (isRP) {\n    return (\n      <i className=\"rp-message\">\n        {_body}\n      </i>\n    )\n  }\n\n  return <span>{_body}</span>;\n};\n\nexport default MessageBody;\n","import React from 'react';\nimport { Card, Tooltip } from 'antd';\nimport { Link } from 'react-router-dom';\n\nimport { IMessage, IUser } from '../../reducers';\nimport Avatar from '../Avatar';\nimport MessageBody from './MessageBody';\nimport {\n  getDate,\n  getFullTime,\n  getTime,\n  isOnline\n} from '../../helpers/utils';\n\ninterface IMessageProps {\n  message: IMessage,\n  user: IUser,\n}\n\nconst Message = (props: IMessageProps) => {\n  const {\n    message: {\n      time,\n      grouped,\n      body,\n      mentioned,\n    },\n    user,\n  } = props;\n\n  const title = user && (\n    <Link to={`./${user.uid}/settings`}>\n      <Tooltip\n        title={user.lastOnline ? `Последняя активность: ${getFullTime(user.lastOnline)}` : undefined}\n        placement=\"left\"\n      >\n        <div className={`chat-message__title ${isOnline(user.lastOnline) ? 'online' : ''}`}>\n          <Avatar\n            avatar={user.avatar}\n            nickname={user.nickname}\n          />\n          <div className=\"chat-message__nickname\">\n            {user.nickname || user.uid}\n          </div>\n        </div>\n      </Tooltip>\n    </Link>\n  );\n\n  return (\n    <Card\n      className={`chat-message ${grouped ? 'grouped' : ''} ${mentioned && user && (body.indexOf(`@${user.nickname} `) > -1) ? 'mentioned' : ''}`}\n      title={title}\n      key={time}\n      extra={(\n        <Tooltip title={getDate(time)}>\n          <div className=\"chat-time\">{getTime(time)}</div>\n        </Tooltip>\n      )}\n    >\n      <MessageBody message={props.message}/>\n    </Card>\n  );\n};\n\nexport default Message;\n","import React, {\n  ChangeEvent,\n  Component,\n  KeyboardEvent,\n  ClipboardEvent,\n  DragEvent,\n} from 'react';\nimport { connect } from 'react-redux';\nimport { SendOutlined } from '@ant-design/icons';\nimport {\n  Input,\n  message as notify,\n  Spin,\n} from 'antd';\n\nimport './chat.scss';\nimport actions from '../../actions';\nimport { IMessage, IState, IUser, IUsers } from '../../reducers';\nimport Message from './Message';\nimport { validateMessage } from \"../../helpers/utils\";\n\ninterface IChatProps {\n  messages: IMessage[],\n  uid: string,\n  loading: boolean,\n  users: IUsers;\n  user: IUser;\n}\n\ninterface IChatState {\n  message: string;\n  sending: boolean;\n}\n\nclass Chat extends Component<IChatProps, IChatState> {\n  state = {\n    message: '',\n    sending: false,\n  };\n\n  componentDidMount = () => {\n    actions.getMessages({});\n    actions.subscribe({});\n    this.setState({ message: localStorage.getItem('message') || '' });\n  };\n\n  componentWillUnmount = () => {\n    actions.unsubscribe({});\n  };\n\n  componentDidUpdate = (prevProps: IChatProps) => {\n    const { messages, users } = this.props;\n\n    if (this.state.sending && prevProps.messages !== messages) {\n      localStorage.setItem('message', '');\n      this.setState({\n        message: '',\n        sending: false,\n      });\n    }\n\n    messages.forEach((m: IMessage) => {\n      if (!users[m.author]) {\n        actions.getUser({ uid: m.author });\n      }\n    });\n  };\n\n  onChangeMessage = (event: ChangeEvent<HTMLTextAreaElement>) => {\n    const message = event.target.value;\n    localStorage.setItem('message', message);\n    this.setState({ message });\n  };\n\n  onKeyDown = (event: KeyboardEvent<HTMLTextAreaElement>) => {\n    if (event.key === 'Enter' && !event.shiftKey) {\n      event.preventDefault();\n\n      this.onSendMessage();\n    }\n\n    const { uid } = this.props;\n    if (event.key === 'Up' || event.key === 'ArrowUp') {\n      const message = this.props.messages.find((m: IMessage) => m.author === uid);\n      if (message) {\n        const { currentTarget: { value, selectionStart } } = event;\n        if (value.substr(0, selectionStart).split('\\n').length === 1) {\n          const { body } = message;\n          localStorage.setItem('message', body);\n          this.setState({ message: body });\n        }\n      }\n    }\n  };\n\n  onSendMessage = () => {\n    const { message } = this.state;\n    const { user, loading, uid } = this.props;\n\n    if (loading) {\n      return;\n    }\n\n    if (!user) {\n      notify.error('Данные о пользователе отсутствуют');\n      return;\n    }\n\n    if (!user.nickname) {\n      notify.error('Никнейм не установлен. Пройдите в настройки и назовите себя');\n      return;\n    }\n\n    if (!validateMessage(message)) {\n      return;\n    }\n\n    this.setState({ sending: true });\n    actions.sendMessage({\n      uid,\n      message,\n    });\n  };\n\n  getMoreMessages = () => {\n    actions.getMoreMessages({ firstMessage: this.props.messages[this.props.messages.length - 1] })\n  };\n\n  onScroll = (event: React.UIEvent<HTMLDivElement, UIEvent>) => {\n    if (event.currentTarget.scrollTop <= 50) {\n      event.preventDefault();\n      this.getMoreMessages();\n    }\n  };\n\n  uploadFile = (file: File, event: ClipboardEvent<HTMLTextAreaElement> | DragEvent<HTMLTextAreaElement>) => {\n    const { uid } = this.props;\n    if (file) {\n      if (file.type.indexOf('image') > -1) {\n        actions.uploadFile({ uid: uid, file });\n      } else {\n        notify.error('Только картинки могут быть загружены');\n      }\n      event.preventDefault();\n    }\n  };\n\n  onPaste = (e: ClipboardEvent<HTMLTextAreaElement>) => {\n    this.uploadFile(e.clipboardData.files[0], e)\n  };\n\n  onDrop = (e: DragEvent<HTMLTextAreaElement>) => {\n    const file = e.dataTransfer.items[0].getAsFile();\n    if (file)\n      this.uploadFile(file, e)\n  };\n\n  render = () => {\n    const { messages, loading, users } = this.props;\n\n    return (\n      <Spin spinning={loading}>\n        <div className={`chat-wrapper`}>\n          <div\n            className=\"chat-body\"\n            onScroll={this.onScroll}\n          >\n            {messages.map((m: IMessage) => (\n              <Message\n                key={m.time}\n                message={m}\n                user={users[m.author]}\n              />\n            ))}\n          </div>\n          <div className=\"chat-controls\">\n            <Input.TextArea\n              placeholder=\"Введите сообщение\"\n              autoSize={{ minRows: 1, maxRows: 10 }}\n              onChange={this.onChangeMessage}\n              onKeyDown={this.onKeyDown}\n              value={this.state.message}\n              onPaste={this.onPaste}\n              onDrop={this.onDrop}\n            />\n            <SendOutlined\n              onClick={this.onSendMessage}\n            />\n          </div>\n        </div>\n      </Spin>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState) => {\n  const { messages, uid, loading, users } = state;\n\n  return {\n    messages,\n    uid,\n    loading,\n    users,\n    user: users[uid]\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);\n","import React from 'react';\nimport { SyncOutlined, CheckCircleTwoTone } from '@ant-design/icons';\n\nconst Loader = (props: { loading: boolean }) => {\n  const { loading } = props;\n\n  return (\n    <div className=\"loader\">\n      {loading\n        ? (\n          <SyncOutlined spin style={{color: \"#ff4d4f\"}} />\n        ) : (\n          <CheckCircleTwoTone twoToneColor=\"#52c41a\"/>\n        )\n      }\n    </div>\n  )\n};\n\nexport default Loader;\n","import React, { ChangeEvent } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Card,\n  Input,\n  Button,\n  Popconfirm,\n} from 'antd';\nimport { RouteComponentProps } from 'react-router';\n\nimport { ClearOutlined } from '@ant-design/icons';\n\nimport actions from '../../actions';\nimport { IState, IUser, defaultUser } from '../../reducers';\nimport Avatar from '../Avatar';\nimport Loader from '../Loader';\nimport { getFullTime } from \"../../helpers/utils\";\n\ninterface ISettingsProps extends RouteComponentProps {\n  loading: boolean;\n  user?: IUser | null;\n  uid: string;\n}\n\nexport class Settings extends React.Component<ISettingsProps> {\n  componentDidMount = () => {\n    const { user } = this.props;\n    if (user) {\n      actions.getUser({ uid: user.uid });\n    }\n  };\n\n  onChange = (field: string) => (event: ChangeEvent<HTMLInputElement>) => {\n    const { user } = this.props;\n    if (!user) return;\n\n    const newSettings = {\n      ...user,\n      [field]: event.target.value,\n    };\n\n    this.setSettings(newSettings);\n  };\n\n  setSettings = (newSettings: {}) => {\n    const { user } = this.props;\n    if (user) {\n      actions.setUser({\n        uid: user.uid,\n        user: newSettings,\n      });\n    }\n  };\n\n  clearAvatar = () => this.setSettings({\n    ...this.props.user,\n    avatar: '',\n  });\n\n  getField = (key: string, value: string, user: IUser) => {\n    const { nickname = '' } = user;\n\n    switch (key) {\n      case 'avatar':\n        return (\n          <div>\n            <div style={{ display: 'flex' }}>\n              <Input\n                value={value}\n                onChange={this.onChange(key)}\n              />\n              <Popconfirm\n                title=\"Очистить аватар?\"\n                onConfirm={this.clearAvatar}\n                okText=\"Да\"\n                cancelText=\"Нет\"\n                icon={<ClearOutlined style={{ color: '#ff4d4f'}}/>}\n                disabled={!value}\n              >\n                <Button\n                  disabled={!value}\n                  danger\n                >\n                  <ClearOutlined/>\n                </Button>\n              </Popconfirm>\n            </div>\n            <Avatar\n              avatar={value}\n              nickname={nickname}\n              size={128}\n              style={{ margin: '8px auto', display: 'block' }}\n            />\n          </div>\n        );\n\n      case 'uid':\n        return (\n          <Input value={value} readOnly/>\n        );\n\n      case 'lastOnline':\n        return (\n          <Input value={getFullTime(parseInt(value))} readOnly/>\n        );\n\n      default:\n        return (\n          <Input\n            defaultValue={value}\n            onChange={this.onChange(key)}\n          />\n        )\n    }\n  };\n\n  labels: {[key: string]: string} = {\n    'avatar': 'Аватар',\n    'nickname': 'Никнейм',\n    'lastOnline': 'Последняя активность',\n    'uid': 'UID',\n  };\n\n  render = () => {\n    const { user, loading } = this.props;\n\n    console.log('user', user);\n    return (\n      <Card\n        className=\"settings\"\n        bordered={false}\n        loading={user === undefined}\n      >\n        <Loader loading={loading}/>\n        {user && Object\n          .keys(defaultUser)\n          .map((key: string) => {\n            // @ts-ignore\n            const field = this.getField(key, `${user[key] || ''}`, user);\n            return field && (\n              <Card\n                className={key}\n                key={key}\n                title={this.labels[key]}\n              >\n                {field}\n              </Card>\n            )\n          })\n\n        }\n      </Card>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState, props: ISettingsProps) => {\n  const { loading, users } = state;\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n  const user = users[uid];\n  if (user && !user.uid && uid) {\n    user.uid = uid;\n  }\n\n  return {\n    loading,\n    user\n  };\n};\n\nexport default connect(mapStateToProps)(Settings);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { Button, Avatar, Card } from 'antd';\n\nimport actions from '../../actions';\n\nconst byeLink = 'https://cdn.lowgif.com/full/fc3d7d9abd06a92e-hi-bear-gifs-get-the-best-gif-on-giphy.gif';\n\nconst Logout = () => {\n  return (\n    <Card>\n      <Avatar\n        src={byeLink}\n        size={256}\n        style={{ margin: '0 auto', display: 'block' }}\n      />\n      <br/>\n      <br/>\n      <Button\n        type=\"primary\"\n        size=\"large\"\n        onClick={() => actions.logout({ })}\n        style={{ width: '100%' }}\n      >\n        Выйти\n      </Button>\n    </Card>\n  )\n};\n\nexport default connect()(Logout);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Card,\n} from 'antd';\nimport { RouteComponentProps } from 'react-router';\n\nimport './inventory.scss';\nimport actions from '../../actions';\nimport { IState, IUser, defaultUser } from '../../reducers';\nimport Loader from \"../Loader\";\n\ninterface IInventoryProps extends RouteComponentProps {\n  loading: boolean;\n  user: IUser | null;\n  uid: string;\n}\n\nexport class Inventory extends React.Component<IInventoryProps> {\n  componentDidMount = () => {\n    const { user } = this.props;\n    if (user) {\n      actions.getUser({ uid: user.uid });\n    }\n  };\n\n  render = () => {\n    const { loading } = this.props;\n\n    return (\n      <Card className=\"inventory\">\n        <Loader loading={loading}/>\n        <div className=\"inventory-body\">\n\n        </div>\n      </Card>\n    )\n  }\n}\n\nconst mapStateToProps = (state: IState, props: IInventoryProps) => {\n  const { loading, users } = state;\n  const uid = new URLSearchParams(props.match.params).get('uid') || state.uid || '0';\n\n  return {\n    loading,\n    user: users[uid] || {\n      ...defaultUser,\n      uid,\n    }\n  };\n};\n\nexport default connect(mapStateToProps)(Inventory);\n","import { ConnectedComponent } from 'react-redux';\n\nimport Chat from '../components/Chat/index';\nimport Settings from '../components/Settings';\nimport Logout from '../components/Logout';\nimport Inventory from \"../components/Inventory\";\n\nexport interface IRoute {\n  path: string;\n  component: ConnectedComponent<any, any>;\n  exact?: boolean;\n}\n\nconst routes: IRoute[] = [\n  {\n    path: '/text-roleplay/chat',\n    component: Chat,\n  },\n  {\n    path: '/text-roleplay/:uid/settings',\n    component: Settings,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/settings',\n    component: Settings,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/:uid/inventory',\n    component: Inventory,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/inventory',\n    component: Inventory,\n    exact: true,\n  },\n  {\n    path: '/text-roleplay/logout',\n    component: Logout,\n  },\n];\n\nexport default routes;\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  Form,\n  Input,\n  Button,\n} from 'antd';\n\nimport actions from '../../actions';\n\nconst Login = () => {\n  return (\n    <Form\n      onFinish={(values) => actions.login(values)}\n    >\n      <Form.Item\n        label=\"Email\"\n        name=\"email\"\n        rules={[{ required: true, message: 'Введите e-mail!' }]}\n      >\n        <Input/>\n      </Form.Item>\n      <Form.Item\n        label=\"Password\"\n        name=\"password\"\n        rules={[{ required: true, message: 'Введите пароль!' }]}\n      >\n        <Input.Password/>\n      </Form.Item>\n      <Form.Item>\n        <Button type=\"primary\" htmlType=\"submit\">\n          Войти\n        </Button>\n      </Form.Item>\n    </Form>\n  );\n};\n\nexport default connect()(Login);\n","import React from 'react';\nimport {\n  Switch,\n  Route,\n  Redirect,\n} from 'react-router-dom';\nimport { connect } from 'react-redux';\n\nimport routes, { IRoute } from '../../configs/routes';\nimport Login from '../Login';\nimport { IState } from \"../../reducers\";\n\ninterface IRouterProps {\n  isLoggedIn: boolean;\n}\n\nfunction Router(props: IRouterProps) {\n  if (!props.isLoggedIn) {\n    return (\n      <Switch>\n        <Route\n          path=\"*\"\n          component={Login}\n        />\n      </Switch>\n    )\n  }\n\n  return (\n    <Switch>\n      {\n        routes.map((value: IRoute) =>\n          <Route\n            key={value.path}\n            path={value.path}\n            component={value.component}\n            exact={value.exact || false}\n          />\n        )\n      }\n      <Redirect to=\"/text-roleplay/chat\"/>\n    </Switch>\n  );\n}\n\nexport default connect((state: IState) => ({ isLoggedIn: state.isLoggedIn }))(Router);\n","import React from 'react';\nimport { BrowserRouter } from 'react-router-dom';\nimport 'antd/dist/antd.css';\n\nimport Menu from './components/Menu';\nimport Router from './components/Router';\n\nimport './components.scss';\nimport './App.css';\nimport { listenForActivity } from './helpers/utils';\n\nfunction App() {\n  listenForActivity();\n\n  return (\n    <BrowserRouter>\n      <Menu/>\n      <div className=\"app\">\n        <Router/>\n      </div>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n","import {\n  initializeApp,\n  auth as fbAuth,\n  database as fbDatabase\n} from 'firebase';\n\nimport firebaseConfig from '../configs/firebase.json';\nimport actions from '../actions';\n\nconst firebase = initializeApp(firebaseConfig);\nconst auth = fbAuth();\nconst database = fbDatabase();\n\nauth.onAuthStateChanged((user) => {\n  if (user) {\n    actions.loginSuccess({ user });\n    actions.getUser({ uid: user.uid });\n  } else {\n    actions.logout({});\n  }\n});\n\nexport {\n  auth,\n  database,\n  firebase,\n}\n","import { takeLatest } from 'redux-saga/effects';\nimport { AnyAction } from 'redux';\n\nimport { auth, database } from '../helpers/firebase';\nimport actions, { IPayload } from '../actions/index';\nimport { formatMessage } from \"../helpers/utils\";\n\nfunction* login(action: AnyAction) {\n  const { email, password } = action;\n\n  try {\n    const user = yield auth.signInWithEmailAndPassword(email, password);\n    actions.loginSuccess({ user });\n    localStorage.setItem('user', JSON.stringify(user.user));\n    localStorage.setItem('uid', user.user.uid);\n  } catch (error) {\n    console.error(error);\n    if (error.code === 'auth/user-not-found') {\n      const user = yield auth.createUserWithEmailAndPassword(email, password);\n      actions.loginSuccess({ user });\n      localStorage.setItem('user', JSON.stringify(user.user));\n      localStorage.setItem('uid', user.uid);\n    } else {\n      actions.loginFail({ error });\n    }\n  }\n}\n\nfunction* logout() {\n  localStorage.removeItem('user');\n  localStorage.removeItem('uid');\n  localStorage.removeItem('loggedIn');\n  yield auth.signOut();\n}\n\nfunction* setUser(payload: IPayload) {\n  const { uid, user } = payload;\n\n  try {\n    yield database\n      .ref('users')\n      .child(uid)\n      .set({\n        ...user,\n        lastOnline: new Date().getTime(),\n        uid,\n      });\n\n    actions.setUserSuccess({});\n    actions.getUser({ uid });\n  } catch (error) {\n    console.error(error);\n    actions.setUserSuccess({ error });\n  }\n}\n\nfunction* sendMessage(payload: IPayload) {\n  const { uid, message } = payload;\n  const time = new Date().getTime();\n\n  try {\n    yield database\n      .ref('messages')\n      .child(`${time}`)\n      .set(formatMessage({\n        time,\n        author: uid,\n        body: `${message} `,\n      }));\n    localStorage.setItem('message', '');\n    actions.sendMessageSuccess({});\n  } catch (error) {\n    console.error(error);\n    actions.sendMessageFail({ error });\n  }\n}\n\nfunction subscribe() {\n  database\n    .ref('messages')\n    .orderByKey()\n    .limitToLast(1)\n    .on('value', (rawMessages) => {\n      const messages = Object.values(rawMessages.val() || {});\n      actions.getMessagesSuccess({\n        messages,\n        concat: true\n      });\n    });\n}\n\nfunction unsubscribe() {\n  database.ref('messages').off();\n}\n\nfunction* getMessages() {\n  const rawMessages = yield database\n    .ref('messages')\n    .orderByKey()\n    .limitToLast(30)\n    .once('value');\n\n  const messages = Object.values(rawMessages.val() || {});\n  actions.getMessagesSuccess({ messages });\n}\n\nfunction* getMoreMessages(payload: IPayload) {\n  const { firstMessage } = payload;\n\n  const rawMessages = yield database\n    .ref('messages')\n    .orderByKey()\n    .endAt(`${firstMessage.time}`)\n    .limitToLast(30)\n    .once('value');\n\n  const messages = Object.values(rawMessages.val() || {});\n  actions.getMessagesSuccess({ messages, concat: true });\n}\n\nconst requestedUsers: { [key: string]: true } = {};\n\nfunction getUser(payload: IPayload) {\n  const { uid } = payload;\n\n  if (requestedUsers[uid]) return;\n  requestedUsers[uid] = true;\n  database\n    .ref('users')\n    .child(uid)\n    .on('value', (rawUser) => {\n      const user = rawUser.val() || {};\n      actions.getUserSuccess({ user, uid });\n    });\n}\n\nfunction* updateLastOnline() {\n  const uid = localStorage.getItem('uid');\n  if (!uid || uid === 'undefined') return;\n  const time = new Date().getTime();\n\n  localStorage.setItem('lastActivity', `${time}`);\n  yield database\n    .ref('users')\n    .child(`${uid}`)\n    .child('lastOnline')\n    .set(time);\n}\n\nfunction uploadFile(payload: IPayload) {\n  const { file, uid } = payload;\n\n  const request = new XMLHttpRequest();\n  const formData = new FormData();\n\n  formData.append('image', file);\n\n  request.open('POST', 'https://api.imgur.com/3/image/');\n  request.setRequestHeader('Authorization', `Client-ID ea2c833b74d4583`);\n  request.onreadystatechange = () => {\n    if (request.status === 200 && request.readyState === 4) {\n      let res = JSON.parse(request.responseText);\n\n      actions.sendMessage({\n        uid,\n        message: res.data.link,\n      });\n    }\n  };\n\n  request.send(formData);\n}\n\nexport default function* watchForActions() {\n  yield takeLatest('LOGIN', login);\n  yield takeLatest('LOGOUT', logout);\n  yield takeLatest('GET_USER', getUser);\n  yield takeLatest('SET_USER', setUser);\n  yield takeLatest('SEND_MESSAGE', sendMessage);\n  yield takeLatest('GET_MESSAGES', getMessages);\n  yield takeLatest('GET_MORE_MESSAGES', getMoreMessages);\n  yield takeLatest('SUBSCRIBE', subscribe);\n  yield takeLatest('UPDATE_LAST_ONLINE', updateLastOnline);\n  yield takeLatest('UNSUBSCRIBE', unsubscribe);\n  yield takeLatest('UPLOAD_FILE', uploadFile);\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport './index.css';\nimport App from './App';\nimport saga from './sagas';\nimport store, { sagaMiddleware } from './helpers/store';\nimport * as serviceWorker from './serviceWorker';\n\nsagaMiddleware.run(saga);\nReactDOM.render(\n  <Provider store={store}>\n    <App/>\n  </Provider>,\n  document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}