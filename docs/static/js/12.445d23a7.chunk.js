(this["webpackJsonptext-roleplay"]=this["webpackJsonptext-roleplay"]||[]).push([[12,43],{156:function(a,e,t){"use strict";t.r(e);var s=t(3),l=t(71),c=t(73),r=t(72),n=t(0),i=t.n(n),m=t(27),h=t(37),u=t(446),d=t(150),o=t(69),p=t(493),E=t(102),v=t(444),b=t(68),g=t(481),N=t(35),f=t(458),C=(t(467),t(33)),O=t(4),k=t(23),y=function(a){Object(c.a)(t,a);var e=Object(r.a)(t);function t(){var a;Object(l.a)(this,t);for(var c=arguments.length,r=new Array(c),n=0;n<c;n++)r[n]=arguments[n];return(a=e.call.apply(e,[this].concat(r))).state={character:C.initialCharacter,update:!1},a.componentDidMount=function(){var e=a.props,t=e.character,s=e.uid,l=e.user;t?a.setState({character:t}):O.default.getCharacter({uid:s}),l||O.default.getUser({uid:s})},a.componentDidUpdate=function(e){e.character!==a.props.character&&a.setState({character:Object(s.a)({},a.props.character)})},a.getSpecial=function(e){var t=a.props.hasRight,s=e.special;return i.a.createElement(u.a,{className:"char-special"},i.a.createElement("div",{className:"char-special-item"},i.a.createElement("span",{className:"char-special-label"}),i.a.createElement("div",{className:"char-special-input total"},"Total"),i.a.createElement("div",{className:"char-special-input"},"+/-"),i.a.createElement("div",{className:"char-special-input"},"Base")),C.special.map((function(e){var l=e.label,c=e.full,r=e.field;return i.a.createElement("div",{key:l,className:"char-special-item"},i.a.createElement(d.a,{title:c},i.a.createElement("span",{className:"char-special-label"},l)),i.a.createElement(o.a,{className:"char-special-input total",readOnly:!0,min:0,max:9,disabled:!t,value:s[r].total}),i.a.createElement(p.a,{className:"char-special-input",min:0,max:9,disabled:!t,value:s[r].change,onChange:a.onChange(["special",r,"change"])}),i.a.createElement(p.a,{className:"char-special-input",min:0,max:9,disabled:!t,value:s[r].base,onChange:a.onChange(["special",r,"base"])}))})))},a.getSkills=function(e){var t=a.props.hasRight,s=e.skills;return i.a.createElement(u.a,{className:"char-skills"},i.a.createElement("div",{className:"char-skills-item"},i.a.createElement("span",{className:"char-skills-label"}),i.a.createElement("div",{className:"char-skills-input total"},"Total"),i.a.createElement("div",{className:"char-skills-input"},"+/-"),i.a.createElement("div",{className:"char-skills-input"},"Base")),C.skills.map((function(e){var l=e.label,c=e.full,r=e.formula,n=e.field;return i.a.createElement("div",{key:n,className:"char-skills-item"},i.a.createElement(d.a,{title:c},i.a.createElement("span",{className:"char-skills-label"},l)),i.a.createElement(o.a,{className:"char-skills-input",readOnly:!0,disabled:!t,value:s[n].total}),i.a.createElement(p.a,{className:"char-skills-input",disabled:!t,min:1,max:95,value:s[n].change,onChange:a.onChange(["skills",n,"change"])}),i.a.createElement(d.a,{title:r},i.a.createElement(o.a,{className:"char-skills-input",readOnly:!0,disabled:!t,value:s[n].base,onChange:a.onChange(["skills",n,"base"])})))})))},a.getStats=function(e){var t=a.props.hasRight,s=e.stats;return i.a.createElement(u.a,{className:"char-stats"},C.stats.map((function(e){var l=e.label,c=e.full,r=e.field,n=e.getBase;return i.a.createElement("div",{key:r,className:"char-stats-item"},i.a.createElement(d.a,{title:c},i.a.createElement("span",{className:"char-stats-label"},l)),"wounds"===r?i.a.createElement(o.a.TextArea,{className:"char-stats-input",disabled:!t,value:s[r],onChange:a.onChange(["stats",r])}):n?i.a.createElement(o.a,{className:"char-stats-input",readOnly:!0,disabled:!t,value:s[r]}):i.a.createElement(p.a,{className:"char-stats-input",min:1,max:Number.MAX_SAFE_INTEGER,disabled:!t,value:s[r],onChange:a.onChange(["stats",r])}))})))},a.getMainStats=function(e){var t=a.props.hasRight,s=e.stats;return i.a.createElement(u.a,{className:"char-main-stats"},i.a.createElement("div",{className:"char-main-stats-health"},i.a.createElement("div",{className:"char-main-stats-hp"},i.a.createElement("span",{className:"char-main-stats-hp-label"},"\u041e\u0447\u043a\u0438 \u0417\u0434\u043e\u0440\u043e\u0432\u044c\u044f (\u041e\u0417)"),i.a.createElement("div",{className:"char-main-stats-hp-body"},i.a.createElement(o.a,{max:s.maxHealthPoints||void 0,min:-Math.floor(s.maxHealthPoints/2),readOnly:!0,disabled:!t,value:s.healthPoints}),"/",i.a.createElement(o.a,{value:s.maxHealthPoints,readOnly:!0,disabled:!t}))),i.a.createElement("div",{className:"char-main-stats-ap-wrapper"},i.a.createElement("div",{className:"char-main-stats-ap"},i.a.createElement(d.a,{title:"\u041a\u043b\u0430\u0441\u0441 \u0411\u0440\u043e\u043d\u0438 (\u041a\u0411)"},i.a.createElement("div",{className:"char-main-stats-ap-total"},"\u041a\u0411")),i.a.createElement("div",{className:"char-main-stats-ap-change"},"+/-"),i.a.createElement("div",{className:"char-main-stats-ap-base"},"Base")),i.a.createElement("div",{className:"char-main-stats-ap"},i.a.createElement(o.a,{className:"char-main-stats-ap-total",readOnly:!0,disabled:!t,value:s.armorClass.total}),i.a.createElement(o.a,{className:"char-main-stats-ap-change",readOnly:!0,disabled:!t,min:1,max:95,value:s.armorClass.change}),i.a.createElement(o.a,{className:"char-main-stats-ap-base",readOnly:!0,disabled:!t,value:s.armorClass.base})))),i.a.createElement("div",{className:"char-main-stats-info"},C.subStats.slice(3).map((function(a){var e=a.label,l=a.full,c=a.field;return i.a.createElement("div",{key:c,className:"char-main-stats-item"},i.a.createElement(d.a,{title:l},i.a.createElement("span",{className:"char-main-stats-item-label"},e)),i.a.createElement(o.a,{className:"char-main-stats-item-input",readOnly:!0,disabled:!t,value:s[c]}))}))))},a.onChange=function(e){return function(t){if(t){var l="number"===typeof t?t:t.currentTarget.value,c=Object(k.set)(a.state.character,e,l),r=Object(k.processCharacterChanges)({},c);a.setState({character:Object(s.a)(Object(s.a)({},a.state.character),r)})}}},a.onSave=function(){var e=a.props,t=e.uid,s=e.character,l=a.state.character;if(s){var c=Object(k.getCharacterChanges)(C.initialCharacter,l);0!==c.length&&0!==(c=Object(k.getCharacterChanges)(s,l)).length?l.stats.skillPoints<0?E.a.error("\u041e\u0447\u043a\u0438 \u041d\u0430\u0432\u044b\u043a\u043e\u0432 (\u041e\u041d) \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c\u0438!"):(E.a.success("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u0441\u043e\u0445\u0440\u0430\u043d\u0451\u043d"),O.default.setCharacter({uid:t,character:l}),O.default.sendMessage({uid:t,message:"\u0425\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u0438\u0441\u0442\u0438\u043a\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u044b",data:{characterChanges:c}})):E.a.error("\u0412 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u043b\u043e\u0441\u044c")}else E.a.error("\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d!")},a.changeBio=function(e){return a.setState({character:Object(s.a)(Object(s.a)({},a.state.character),{},{bio:e.currentTarget.value})})},a.render=function(){var e=a.props,t=e.user,s=e.hasRight,l=e.currentUser,c=e.history,r=e.character,n=a.state.character;return t&&r&&n!==C.initialCharacter?t&&t.uid&&l&&l.uid===t.uid&&"/stats"===c.location.pathname?i.a.createElement(m.a,{from:"/stats",to:"/".concat(l.uid,"/stats"),exact:!0}):i.a.createElement(u.a,{className:"char",title:i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null)," ","\u041f\u0435\u0440\u0441\u043e\u043d\u0430\u0436 \u0438\u0433\u0440\u043e\u043a\u0430 ",t.nickname||t.uid),extra:i.a.createElement(g.a,{title:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f?",okText:"\u0414\u0430",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",onConfirm:a.onSave},i.a.createElement(N.a,null,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))},i.a.createElement("div",{className:"char-bio"},i.a.createElement(o.a.TextArea,{disabled:!s,minLength:3,value:n.bio,onChange:a.changeBio})),i.a.createElement("div",null,a.getMainStats(n)),i.a.createElement("div",null,i.a.createElement("div",null,a.getSpecial(n),a.getStats(n)),i.a.createElement("div",null,a.getSkills(n)))):i.a.createElement(v.a,{spinning:!0},i.a.createElement(b.a,{description:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d"}))},a}return t}(n.Component);e.default=Object(m.g)(Object(h.b)((function(a,e){var t=Object(k.getStateUser)(a,e),l=t.user,c=t.currentUser,r=t.character,n=!!l&&!!c&&(c.uid===l.uid&&r&&!r.static||!!c.isSuperAdmin);return Object(s.a)(Object(s.a)({},t),{},{hasRight:n})}))(y))},467:function(a,e,t){}}]);
//# sourceMappingURL=12.445d23a7.chunk.js.map